2025-05-04 14:10:45.284 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-05-04 14:10:45.374 +07:00 [DBG] Hosting starting
2025-05-04 14:10:45.390 +07:00 [INF] User profile is available. Using 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-04 14:10:45.401 +07:00 [DBG] Reading data from file 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys\key-1a51a872-ea43-4350-815f-0422835a65dd.xml'.
2025-05-04 14:10:45.412 +07:00 [DBG] Found key {1a51a872-ea43-4350-815f-0422835a65dd}.
2025-05-04 14:10:45.421 +07:00 [DBG] Considering key {1a51a872-ea43-4350-815f-0422835a65dd} with expiration date 2025-07-05 19:31:04Z as default key.
2025-05-04 14:10:45.427 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 14:10:45.433 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-05-04 14:10:45.437 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 14:10:45.444 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-05-04 14:10:45.448 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-05-04 14:10:45.450 +07:00 [DBG] Using key {1a51a872-ea43-4350-815f-0422835a65dd} as the default key.
2025-05-04 14:10:45.451 +07:00 [DBG] Key ring with default key {1a51a872-ea43-4350-815f-0422835a65dd} was loaded during application startup.
2025-05-04 14:10:45.502 +07:00 [ERR] Hosting failed to start
System.IO.IOException: Failed to bind to address http://127.0.0.1:5120: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Only one usage of each socket address (protocol/network address/port) is normally permitted.
 ---> System.Net.Sockets.SocketException (10048): Only one usage of each socket address (protocol/network address/port) is normally permitted.
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(ListenOptions[] listenOptions, AddressBindContext context, Func`2 useHttps, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-05-04 14:11:00.618 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-05-04 14:11:00.719 +07:00 [DBG] Hosting starting
2025-05-04 14:11:00.731 +07:00 [INF] User profile is available. Using 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-04 14:11:00.747 +07:00 [DBG] Reading data from file 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys\key-1a51a872-ea43-4350-815f-0422835a65dd.xml'.
2025-05-04 14:11:00.759 +07:00 [DBG] Found key {1a51a872-ea43-4350-815f-0422835a65dd}.
2025-05-04 14:11:00.767 +07:00 [DBG] Considering key {1a51a872-ea43-4350-815f-0422835a65dd} with expiration date 2025-07-05 19:31:04Z as default key.
2025-05-04 14:11:00.774 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 14:11:00.781 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-05-04 14:11:00.786 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 14:11:00.794 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-05-04 14:11:00.799 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-05-04 14:11:00.802 +07:00 [DBG] Using key {1a51a872-ea43-4350-815f-0422835a65dd} as the default key.
2025-05-04 14:11:00.803 +07:00 [DBG] Key ring with default key {1a51a872-ea43-4350-815f-0422835a65dd} was loaded during application startup.
2025-05-04 14:11:00.843 +07:00 [ERR] Hosting failed to start
System.IO.IOException: Failed to bind to address http://127.0.0.1:5120: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Only one usage of each socket address (protocol/network address/port) is normally permitted.
 ---> System.Net.Sockets.SocketException (10048): Only one usage of each socket address (protocol/network address/port) is normally permitted.
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(ListenOptions[] listenOptions, AddressBindContext context, Func`2 useHttps, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-05-04 14:12:34.601 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-05-04 14:12:34.698 +07:00 [DBG] Hosting starting
2025-05-04 14:12:34.711 +07:00 [INF] User profile is available. Using 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-04 14:12:34.723 +07:00 [DBG] Reading data from file 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys\key-1a51a872-ea43-4350-815f-0422835a65dd.xml'.
2025-05-04 14:12:34.733 +07:00 [DBG] Found key {1a51a872-ea43-4350-815f-0422835a65dd}.
2025-05-04 14:12:34.748 +07:00 [DBG] Considering key {1a51a872-ea43-4350-815f-0422835a65dd} with expiration date 2025-07-05 19:31:04Z as default key.
2025-05-04 14:12:34.753 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 14:12:34.756 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-05-04 14:12:34.759 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 14:12:34.766 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-05-04 14:12:34.770 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-05-04 14:12:34.772 +07:00 [DBG] Using key {1a51a872-ea43-4350-815f-0422835a65dd} as the default key.
2025-05-04 14:12:34.773 +07:00 [DBG] Key ring with default key {1a51a872-ea43-4350-815f-0422835a65dd} was loaded during application startup.
2025-05-04 14:12:34.817 +07:00 [ERR] Hosting failed to start
System.IO.IOException: Failed to bind to address http://127.0.0.1:5120: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Only one usage of each socket address (protocol/network address/port) is normally permitted.
 ---> System.Net.Sockets.SocketException (10048): Only one usage of each socket address (protocol/network address/port) is normally permitted.
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(ListenOptions[] listenOptions, AddressBindContext context, Func`2 useHttps, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-05-04 14:14:18.371 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-05-04 14:14:18.460 +07:00 [DBG] Hosting starting
2025-05-04 14:14:18.472 +07:00 [INF] User profile is available. Using 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-04 14:14:18.486 +07:00 [DBG] Reading data from file 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys\key-1a51a872-ea43-4350-815f-0422835a65dd.xml'.
2025-05-04 14:14:18.497 +07:00 [DBG] Found key {1a51a872-ea43-4350-815f-0422835a65dd}.
2025-05-04 14:14:18.506 +07:00 [DBG] Considering key {1a51a872-ea43-4350-815f-0422835a65dd} with expiration date 2025-07-05 19:31:04Z as default key.
2025-05-04 14:14:18.514 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 14:14:18.520 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-05-04 14:14:18.526 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 14:14:18.536 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-05-04 14:14:18.542 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-05-04 14:14:18.544 +07:00 [DBG] Using key {1a51a872-ea43-4350-815f-0422835a65dd} as the default key.
2025-05-04 14:14:18.546 +07:00 [DBG] Key ring with default key {1a51a872-ea43-4350-815f-0422835a65dd} was loaded during application startup.
2025-05-04 14:14:18.594 +07:00 [ERR] Hosting failed to start
System.IO.IOException: Failed to bind to address http://127.0.0.1:5120: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Only one usage of each socket address (protocol/network address/port) is normally permitted.
 ---> System.Net.Sockets.SocketException (10048): Only one usage of each socket address (protocol/network address/port) is normally permitted.
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(ListenOptions[] listenOptions, AddressBindContext context, Func`2 useHttps, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-05-04 14:18:20.271 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-05-04 14:18:20.376 +07:00 [DBG] Hosting starting
2025-05-04 14:18:20.391 +07:00 [INF] User profile is available. Using 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-04 14:18:20.403 +07:00 [DBG] Reading data from file 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys\key-1a51a872-ea43-4350-815f-0422835a65dd.xml'.
2025-05-04 14:18:20.414 +07:00 [DBG] Found key {1a51a872-ea43-4350-815f-0422835a65dd}.
2025-05-04 14:18:20.426 +07:00 [DBG] Considering key {1a51a872-ea43-4350-815f-0422835a65dd} with expiration date 2025-07-05 19:31:04Z as default key.
2025-05-04 14:18:20.434 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 14:18:20.439 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-05-04 14:18:20.445 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 14:18:20.454 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-05-04 14:18:20.461 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-05-04 14:18:20.463 +07:00 [DBG] Using key {1a51a872-ea43-4350-815f-0422835a65dd} as the default key.
2025-05-04 14:18:20.465 +07:00 [DBG] Key ring with default key {1a51a872-ea43-4350-815f-0422835a65dd} was loaded during application startup.
2025-05-04 14:18:20.510 +07:00 [INF] Now listening on: http://localhost:5120
2025-05-04 14:18:20.512 +07:00 [DBG] Loaded hosting startup assembly ExchangeDocument
2025-05-04 14:18:20.515 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-04 14:18:20.518 +07:00 [INF] Hosting environment: Development
2025-05-04 14:18:20.519 +07:00 [INF] Content root path: D:\Gộp module Auth\ExchangeDocument(Tự làm Auth_User) - Đã làm logout(2)\ExchangeDocument
2025-05-04 14:18:20.524 +07:00 [DBG] Hosting started
2025-05-04 14:18:23.445 +07:00 [DBG] Connection id "0HNCARFDH79SK" accepted.
2025-05-04 14:18:23.448 +07:00 [DBG] Connection id "0HNCARFDH79SK" started.
2025-05-04 14:18:23.448 +07:00 [DBG] Connection id "0HNCARFDH79SL" accepted.
2025-05-04 14:18:23.458 +07:00 [DBG] Connection id "0HNCARFDH79SL" started.
2025-05-04 14:18:23.483 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/index.html - null null
2025-05-04 14:18:23.495 +07:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-05-04 14:18:23.508 +07:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-05-04 14:18:23.513 +07:00 [DBG] Request did not match any endpoints
2025-05-04 14:18:23.589 +07:00 [INF] HTTP GET /swagger/index.html responded 200 in 72.8226 ms
2025-05-04 14:18:23.597 +07:00 [DBG] Connection id "0HNCARFDH79SK" completed keep alive response.
2025-05-04 14:18:23.601 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/index.html - 200 null text/html;charset=utf-8 119.566ms
2025-05-04 14:18:23.807 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - null null
2025-05-04 14:18:23.814 +07:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-05-04 14:18:23.816 +07:00 [DBG] Request did not match any endpoints
2025-05-04 14:18:23.992 +07:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 174.7768 ms
2025-05-04 14:18:23.997 +07:00 [DBG] Connection id "0HNCARFDH79SK" completed keep alive response.
2025-05-04 14:18:24.000 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 192.0634ms
2025-05-04 14:18:45.721 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 57
2025-05-04 14:18:45.730 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 14:18:45.738 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 14:18:45.742 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 14:18:45.747 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 14:18:45.749 +07:00 [WRN] Failed to determine the https port for redirect.
2025-05-04 14:18:45.778 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 14:18:45.783 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 14:18:45.807 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 14:18:45.811 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 14:18:45.815 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 14:18:45.818 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 14:18:45.820 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 14:18:45.821 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 14:18:45.823 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 14:18:45.884 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-05-04 14:18:45.902 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 14:18:45.906 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 14:18:45.910 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 14:18:45.916 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 14:18:45.941 +07:00 [DBG] Connection id "0HNCARFDH79SK", Request id "0HNCARFDH79SK:00000003": started reading request body.
2025-05-04 14:18:45.944 +07:00 [DBG] Connection id "0HNCARFDH79SK", Request id "0HNCARFDH79SK:00000003": done reading request body.
2025-05-04 14:18:45.957 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 14:18:45.961 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 14:18:45.966 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 14:18:45.967 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 14:18:45.973 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 14:18:46.305 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'OrderDetail'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 14:18:46.308 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'Review'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 14:18:46.421 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 14:18:46.466 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .FirstOrDefault(u => u.Email == __email_0)'
2025-05-04 14:18:46.513 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-04 14:18:46.687 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE u.email == @__email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE u.email == @__email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            Role entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<Email>k__BackingField = dataReader.GetString(2);
                                    instance.<FullName>k__BackingField = dataReader.GetString(3);
                                    instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(4);
                                    instance.<Password>k__BackingField = dataReader.GetString(5);
                                    instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                    instance.<Phone>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(8) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(8);
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(9);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                Role instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(Role);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(11) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (Role)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                            {
                                return 
                                {
                                    Role instance;
                                    instance = new Role();
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                    instance.<RoleName>k__BackingField = dataReader.GetString(12);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Role)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
                fixup: (namelessParameter{8}, namelessParameter{9}) => 
                {
                    namelessParameter{8}.<Role>k__BackingField = namelessParameter{9};
                    return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                        entity: namelessParameter{9}, 
                        value: namelessParameter{8}, 
                        forMaterialization: True);
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-04 14:18:46.749 +07:00 [DBG] Creating DbConnection.
2025-05-04 14:18:46.764 +07:00 [DBG] Created DbConnection. (11ms).
2025-05-04 14:18:46.767 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:18:46.867 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:18:46.871 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 14:18:46.877 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-05-04 14:18:46.884 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (12ms).
2025-05-04 14:18:46.890 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 14:18:46.923 +07:00 [INF] Executed DbCommand (35ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 14:18:46.935 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:18:46.942 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 11ms reading results.
2025-05-04 14:18:46.949 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:18:46.955 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (6ms).
2025-05-04 14:18:46.959 +07:00 [WRN] Login failed: user user@example.com not found
2025-05-04 14:18:46.965 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 14:18:46.970 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 14:18:46.971 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 14:18:46.972 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 14:18:46.975 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 14:18:46.979 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType4`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 14:18:46.996 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 1170.1612ms
2025-05-04 14:18:46.998 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 14:18:47.002 +07:00 [INF] HTTP POST /api/Auth/login responded 400 in 1256.3560 ms
2025-05-04 14:18:47.004 +07:00 [DBG] Connection id "0HNCARFDH79SK" completed keep alive response.
2025-05-04 14:18:47.007 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 14:18:47.012 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:18:47.015 +07:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-05-04 14:18:47.017 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 400 null application/json; charset=utf-8 1296.6872ms
2025-05-04 14:19:01.958 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 64
2025-05-04 14:19:01.967 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 14:19:01.969 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 14:19:01.975 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 14:19:01.978 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 14:19:01.981 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 14:19:01.983 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 14:19:01.986 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 14:19:01.990 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 14:19:01.992 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 14:19:01.994 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 14:19:01.998 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 14:19:02.001 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 14:19:02.003 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 14:19:02.006 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 14:19:02.010 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 14:19:02.012 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 14:19:02.016 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 14:19:02.018 +07:00 [DBG] Connection id "0HNCARFDH79SK", Request id "0HNCARFDH79SK:00000004": started reading request body.
2025-05-04 14:19:02.019 +07:00 [DBG] Connection id "0HNCARFDH79SK", Request id "0HNCARFDH79SK:00000004": done reading request body.
2025-05-04 14:19:02.021 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 14:19:02.022 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 14:19:02.024 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 14:19:02.026 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 14:19:02.027 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 14:19:02.037 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 14:19:02.045 +07:00 [DBG] Creating DbConnection.
2025-05-04 14:19:02.048 +07:00 [DBG] Created DbConnection. (3ms).
2025-05-04 14:19:02.050 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:19:02.052 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:19:02.054 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 14:19:02.055 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 14:19:02.057 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-05-04 14:19:02.059 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 14:19:02.064 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 14:19:02.085 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:19:02.119 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:19:02.123 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:19:02.129 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:19:02.132 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 65ms reading results.
2025-05-04 14:19:02.134 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:19:02.136 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 14:19:02.381 +07:00 [INF] User nguyetnkhuyen@gmail.com logged in successfully
2025-05-04 14:19:02.382 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 14:19:02.385 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 14:19:02.386 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 14:19:02.387 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 14:19:02.388 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 14:19:02.389 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType6`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 14:19:02.393 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 389.5611ms
2025-05-04 14:19:02.396 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 14:19:02.397 +07:00 [INF] HTTP POST /api/Auth/login responded 200 in 419.7329 ms
2025-05-04 14:19:02.399 +07:00 [DBG] Connection id "0HNCARFDH79SK" completed keep alive response.
2025-05-04 14:19:02.400 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 14:19:02.400 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:19:02.402 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 14:19:02.403 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 200 null application/json; charset=utf-8 445.276ms
2025-05-04 14:19:50.332 +07:00 [DBG] Connection id "0HNCARFDH79SL" received FIN.
2025-05-04 14:19:50.336 +07:00 [DBG] Connection id "0HNCARFDH79SL" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 14:19:50.339 +07:00 [DBG] Connection id "0HNCARFDH79SL" disconnecting.
2025-05-04 14:19:50.342 +07:00 [DBG] Connection id "0HNCARFDH79SL" stopped.
2025-05-04 14:20:04.629 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 64
2025-05-04 14:20:04.634 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 14:20:04.636 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 14:20:04.639 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 14:20:04.640 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 14:20:04.644 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 14:20:04.645 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 14:20:04.648 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 14:20:04.653 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 14:20:04.655 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 14:20:04.656 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 14:20:04.660 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 14:20:04.663 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 14:20:04.665 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 14:20:04.672 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 14:20:04.676 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 14:20:04.678 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 14:20:04.682 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 14:20:04.683 +07:00 [DBG] Connection id "0HNCARFDH79SK", Request id "0HNCARFDH79SK:00000005": started reading request body.
2025-05-04 14:20:04.685 +07:00 [DBG] Connection id "0HNCARFDH79SK", Request id "0HNCARFDH79SK:00000005": done reading request body.
2025-05-04 14:20:04.686 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 14:20:04.687 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 14:20:04.688 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 14:20:04.690 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 14:20:04.691 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 14:20:04.735 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 14:20:04.743 +07:00 [DBG] Creating DbConnection.
2025-05-04 14:20:04.744 +07:00 [DBG] Created DbConnection. (1ms).
2025-05-04 14:20:04.745 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:20:04.746 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:20:04.747 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 14:20:04.748 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 14:20:04.749 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 14:20:04.750 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 14:20:04.756 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 14:20:04.758 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:20:04.760 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:20:04.761 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:20:04.762 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:20:04.763 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 4ms reading results.
2025-05-04 14:20:04.764 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:20:04.765 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 14:20:04.976 +07:00 [INF] User nguyetnkhuyen@gmail.com logged in successfully
2025-05-04 14:20:04.977 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 14:20:04.980 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 14:20:04.981 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 14:20:04.981 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 14:20:04.983 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 14:20:04.984 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType6`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 14:20:04.986 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 320.9746ms
2025-05-04 14:20:04.987 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 14:20:04.991 +07:00 [INF] HTTP POST /api/Auth/login responded 200 in 350.5901 ms
2025-05-04 14:20:04.992 +07:00 [DBG] Connection id "0HNCARFDH79SK" completed keep alive response.
2025-05-04 14:20:04.994 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 14:20:04.995 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:20:04.996 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 14:20:04.997 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 200 null application/json; charset=utf-8 368.37ms
2025-05-04 14:20:28.230 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/me - null null
2025-05-04 14:20:28.234 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me'
2025-05-04 14:20:28.237 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 14:20:28.244 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:20:28.247 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 14:20:28.277 +07:00 [DBG] Successfully validated the token.
2025-05-04 14:20:28.283 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 14:20:28.287 +07:00 [DBG] Authorization was successful.
2025-05-04 14:20:28.288 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:20:28.294 +07:00 [INF] Route matched with {action = "GetMe", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMe() on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 14:20:28.297 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 14:20:28.300 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 14:20:28.301 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 14:20:28.305 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 14:20:28.306 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 14:20:28.308 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 14:20:28.310 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 14:20:28.312 +07:00 [WRN] GetMe called without valid sub claim
2025-05-04 14:20:28.316 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 14:20:28.320 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 14:20:28.321 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-05-04 14:20:28.324 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-05-04 14:20:28.326 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-05-04 14:20:28.351 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument) in 43.3613ms
2025-05-04 14:20:28.354 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:20:28.357 +07:00 [INF] HTTP GET /api/Users/me responded 401 in 109.8982 ms
2025-05-04 14:20:28.361 +07:00 [DBG] Connection id "0HNCARFDH79SK" completed keep alive response.
2025-05-04 14:20:28.362 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/me - 401 null application/problem+json; charset=utf-8 131.934ms
2025-05-04 14:21:06.903 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/me - null null
2025-05-04 14:21:06.907 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me'
2025-05-04 14:21:06.909 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 14:21:06.912 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:21:06.913 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 14:21:06.916 +07:00 [DBG] Successfully validated the token.
2025-05-04 14:21:06.918 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 14:21:06.923 +07:00 [DBG] Authorization was successful.
2025-05-04 14:21:06.925 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:21:06.927 +07:00 [INF] Route matched with {action = "GetMe", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMe() on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 14:21:06.930 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 14:21:06.934 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 14:21:06.937 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 14:21:06.940 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 14:21:06.942 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 14:21:06.945 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 14:21:06.949 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 14:21:06.952 +07:00 [WRN] GetMe called without valid sub claim
2025-05-04 14:21:06.953 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 14:21:06.956 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 14:21:06.958 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-05-04 14:21:06.964 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-05-04 14:21:06.966 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-05-04 14:21:06.970 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument) in 24.9211ms
2025-05-04 14:21:06.972 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:21:06.973 +07:00 [INF] HTTP GET /api/Users/me responded 401 in 60.0189 ms
2025-05-04 14:21:06.976 +07:00 [DBG] Connection id "0HNCARFDH79SK" completed keep alive response.
2025-05-04 14:21:06.978 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/me - 401 null application/problem+json; charset=utf-8 74.4978ms
2025-05-04 14:21:30.537 +07:00 [DBG] Connection id "0HNCARFDH79SM" accepted.
2025-05-04 14:21:30.537 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/index.html - null null
2025-05-04 14:21:30.541 +07:00 [DBG] Connection id "0HNCARFDH79SM" started.
2025-05-04 14:21:30.548 +07:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-05-04 14:21:30.550 +07:00 [DBG] Request did not match any endpoints
2025-05-04 14:21:30.552 +07:00 [INF] HTTP GET /swagger/index.html responded 200 in 0.5083 ms
2025-05-04 14:21:30.553 +07:00 [DBG] Connection id "0HNCARFDH79SK" completed keep alive response.
2025-05-04 14:21:30.556 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/index.html - 200 null text/html;charset=utf-8 18.079ms
2025-05-04 14:21:30.949 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - null null
2025-05-04 14:21:30.953 +07:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-05-04 14:21:30.955 +07:00 [DBG] Request did not match any endpoints
2025-05-04 14:21:30.978 +07:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 19.1782 ms
2025-05-04 14:21:30.985 +07:00 [DBG] Connection id "0HNCARFDH79SK" completed keep alive response.
2025-05-04 14:21:30.987 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 38.1382ms
2025-05-04 14:21:38.137 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/me - null null
2025-05-04 14:21:38.140 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me'
2025-05-04 14:21:38.141 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 14:21:38.145 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:21:38.148 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 14:21:38.150 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 14:21:38.154 +07:00 [DBG] Policy authentication schemes  did not succeed
2025-05-04 14:21:38.159 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-04 14:21:38.164 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-04 14:21:38.165 +07:00 [INF] HTTP GET /api/Users/me responded 401 in 17.1058 ms
2025-05-04 14:21:38.167 +07:00 [DBG] Connection id "0HNCARFDH79SK" completed keep alive response.
2025-05-04 14:21:38.169 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/me - 401 0 null 31.9306ms
2025-05-04 14:22:07.890 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 64
2025-05-04 14:22:07.895 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 14:22:07.899 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 14:22:07.902 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 14:22:07.904 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 14:22:07.907 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 14:22:07.909 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 14:22:07.913 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 14:22:07.917 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 14:22:07.920 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 14:22:07.924 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 14:22:07.927 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 14:22:07.929 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 14:22:07.931 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 14:22:07.933 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 14:22:07.935 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 14:22:07.940 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 14:22:07.943 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 14:22:07.944 +07:00 [DBG] Connection id "0HNCARFDH79SK", Request id "0HNCARFDH79SK:0000000B": started reading request body.
2025-05-04 14:22:07.945 +07:00 [DBG] Connection id "0HNCARFDH79SK", Request id "0HNCARFDH79SK:0000000B": done reading request body.
2025-05-04 14:22:07.946 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 14:22:07.947 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 14:22:07.948 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 14:22:07.950 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 14:22:07.951 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 14:22:07.953 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 14:22:07.956 +07:00 [DBG] Creating DbConnection.
2025-05-04 14:22:07.957 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 14:22:07.958 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:22:07.959 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:22:07.960 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 14:22:07.961 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 14:22:07.962 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 14:22:07.963 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 14:22:07.971 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 14:22:07.974 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:22:07.975 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:22:07.976 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:22:07.978 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:22:07.979 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 5ms reading results.
2025-05-04 14:22:07.981 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:22:07.982 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 14:22:08.125 +07:00 [INF] User nguyetnkhuyen@gmail.com logged in successfully
2025-05-04 14:22:08.127 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 14:22:08.130 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 14:22:08.131 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 14:22:08.132 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 14:22:08.133 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 14:22:08.136 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType6`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 14:22:08.139 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 208.0841ms
2025-05-04 14:22:08.141 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 14:22:08.142 +07:00 [INF] HTTP POST /api/Auth/login responded 200 in 237.3362 ms
2025-05-04 14:22:08.143 +07:00 [DBG] Connection id "0HNCARFDH79SK" completed keep alive response.
2025-05-04 14:22:08.144 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 14:22:08.145 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:22:08.146 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 14:22:08.147 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 200 null application/json; charset=utf-8 256.9901ms
2025-05-04 14:22:39.241 +07:00 [DBG] Connection id "0HNCARFDH79SM" received FIN.
2025-05-04 14:22:39.241 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/me - null null
2025-05-04 14:22:39.243 +07:00 [DBG] Connection id "0HNCARFDH79SM" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 14:22:39.247 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me'
2025-05-04 14:22:39.249 +07:00 [DBG] Connection id "0HNCARFDH79SM" disconnecting.
2025-05-04 14:22:39.250 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 14:22:39.253 +07:00 [DBG] Connection id "0HNCARFDH79SM" stopped.
2025-05-04 14:22:39.255 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:22:39.259 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 14:22:39.264 +07:00 [DBG] Successfully validated the token.
2025-05-04 14:22:39.266 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 14:22:39.267 +07:00 [DBG] Authorization was successful.
2025-05-04 14:22:39.268 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:22:39.271 +07:00 [INF] Route matched with {action = "GetMe", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMe() on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 14:22:39.274 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 14:22:39.276 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 14:22:39.277 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 14:22:39.279 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 14:22:39.281 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 14:22:39.283 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 14:22:39.286 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 14:22:39.288 +07:00 [WRN] GetMe called without valid sub claim
2025-05-04 14:22:39.288 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 14:22:39.291 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 14:22:39.292 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-05-04 14:22:39.294 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-05-04 14:22:39.296 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-05-04 14:22:39.298 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument) in 14.9885ms
2025-05-04 14:22:39.301 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:22:39.302 +07:00 [INF] HTTP GET /api/Users/me responded 401 in 43.0269 ms
2025-05-04 14:22:39.303 +07:00 [DBG] Connection id "0HNCARFDH79SK" completed keep alive response.
2025-05-04 14:22:39.305 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/me - 401 null application/problem+json; charset=utf-8 63.4608ms
2025-05-04 14:24:02.848 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/me - null null
2025-05-04 14:24:02.855 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me'
2025-05-04 14:24:02.857 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 14:24:02.874 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:24:02.878 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 14:24:02.886 +07:00 [DBG] Successfully validated the token.
2025-05-04 14:24:02.887 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 14:24:02.891 +07:00 [DBG] Authorization was successful.
2025-05-04 14:24:02.892 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:24:02.894 +07:00 [INF] Route matched with {action = "GetMe", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMe() on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 14:24:02.895 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 14:24:02.896 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 14:24:02.897 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 14:24:02.899 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 14:24:02.900 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 14:24:02.901 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 14:24:02.903 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 14:24:02.904 +07:00 [WRN] GetMe called without valid sub claim
2025-05-04 14:24:02.905 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 14:24:02.907 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 14:24:02.907 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-05-04 14:24:02.909 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-05-04 14:24:02.910 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-05-04 14:24:02.911 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument) in 9.9008ms
2025-05-04 14:24:02.912 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:24:02.913 +07:00 [INF] HTTP GET /api/Users/me responded 401 in 34.5181 ms
2025-05-04 14:24:02.914 +07:00 [DBG] Connection id "0HNCARFDH79SK" completed keep alive response.
2025-05-04 14:24:02.915 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/me - 401 null application/problem+json; charset=utf-8 66.4859ms
2025-05-04 14:26:14.752 +07:00 [DBG] Connection id "0HNCARFDH79SK" disconnecting.
2025-05-04 14:26:14.756 +07:00 [DBG] Connection id "0HNCARFDH79SK" stopped.
2025-05-04 14:26:14.760 +07:00 [DBG] Connection id "0HNCARFDH79SK" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 14:26:57.534 +07:00 [DBG] Connection id "0HNCARFDH79SN" accepted.
2025-05-04 14:26:57.536 +07:00 [DBG] Connection id "0HNCARFDH79SN" started.
2025-05-04 14:26:57.538 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/me - null null
2025-05-04 14:26:57.542 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me'
2025-05-04 14:26:57.544 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 14:26:57.545 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:26:57.547 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 14:26:57.548 +07:00 [DBG] Successfully validated the token.
2025-05-04 14:26:57.549 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 14:26:57.550 +07:00 [DBG] Authorization was successful.
2025-05-04 14:26:57.551 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:26:57.552 +07:00 [INF] Route matched with {action = "GetMe", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMe() on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 14:26:57.553 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 14:26:57.555 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 14:26:57.556 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 14:26:57.557 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 14:26:57.558 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 14:26:57.559 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 14:26:57.560 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 14:26:57.561 +07:00 [WRN] GetMe called without valid sub claim
2025-05-04 14:26:57.562 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 14:26:57.564 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 14:26:57.565 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-05-04 14:26:57.567 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-05-04 14:26:57.568 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-05-04 14:26:57.569 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument) in 9.4369ms
2025-05-04 14:26:57.570 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:26:57.571 +07:00 [INF] HTTP GET /api/Users/me responded 401 in 24.4729 ms
2025-05-04 14:26:57.572 +07:00 [DBG] Connection id "0HNCARFDH79SN" completed keep alive response.
2025-05-04 14:26:57.573 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/me - 401 null application/problem+json; charset=utf-8 35.525ms
2025-05-04 14:29:08.981 +07:00 [DBG] Connection id "0HNCARFDH79SN" disconnecting.
2025-05-04 14:29:08.988 +07:00 [DBG] Connection id "0HNCARFDH79SN" stopped.
2025-05-04 14:29:08.990 +07:00 [DBG] Connection id "0HNCARFDH79SN" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 14:30:57.889 +07:00 [DBG] Connection id "0HNCARFDH79SO" accepted.
2025-05-04 14:30:57.892 +07:00 [DBG] Connection id "0HNCARFDH79SO" started.
2025-05-04 14:30:57.897 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/admin/categories - application/json 29
2025-05-04 14:30:57.903 +07:00 [DBG] 1 candidate(s) found for the request path '/api/admin/categories'
2025-05-04 14:30:57.908 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument)' with route pattern 'api/admin/categories' is valid for the request path '/api/admin/categories'
2025-05-04 14:30:57.910 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument)'
2025-05-04 14:30:57.911 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 14:30:57.912 +07:00 [DBG] Successfully validated the token.
2025-05-04 14:30:57.913 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 14:30:57.914 +07:00 [DBG] Authorization was successful.
2025-05-04 14:30:57.914 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument)'
2025-05-04 14:30:57.919 +07:00 [INF] Route matched with {action = "Create", controller = "AdminCategories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ExchangeDocument.BusinessLayer.DTOs.CategoryDto]] Create(ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto) on controller ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController (ExchangeDocument).
2025-05-04 14:30:57.921 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 14:30:57.922 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 14:30:57.923 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 14:30:57.924 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 14:30:57.925 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 14:30:57.926 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController (ExchangeDocument)
2025-05-04 14:30:57.927 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController (ExchangeDocument)
2025-05-04 14:30:57.928 +07:00 [DBG] Attempting to bind parameter 'createDto' of type 'ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto' ...
2025-05-04 14:30:57.929 +07:00 [DBG] Attempting to bind parameter 'createDto' of type 'ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto' using the name '' in request data ...
2025-05-04 14:30:57.930 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 14:30:57.933 +07:00 [DBG] Connection id "0HNCARFDH79SO", Request id "0HNCARFDH79SO:00000001": started reading request body.
2025-05-04 14:30:57.935 +07:00 [DBG] Connection id "0HNCARFDH79SO", Request id "0HNCARFDH79SO:00000001": done reading request body.
2025-05-04 14:30:57.936 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto'
2025-05-04 14:30:57.937 +07:00 [DBG] Done attempting to bind parameter 'createDto' of type 'ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto'.
2025-05-04 14:30:57.938 +07:00 [DBG] Done attempting to bind parameter 'createDto' of type 'ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto'.
2025-05-04 14:30:57.939 +07:00 [DBG] Attempting to validate the bound parameter 'createDto' of type 'ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto' ...
2025-05-04 14:30:57.941 +07:00 [DBG] Done attempting to validate the bound parameter 'createDto' of type 'ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto'.
2025-05-04 14:30:57.946 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 14:30:57.948 +07:00 [DBG] Compiling query expression: 
'DbSet<Category>()'
2025-05-04 14:30:57.954 +07:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Category>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.CategoryId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.CategoryName (string) Required Index MaxLength(255), 1] }
        SELECT c.categoryId, c.categoryName
        FROM categories AS c) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.CategoryId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.CategoryName (string) Required Index MaxLength(255), 1] }
        SELECT c.categoryId, c.categoryName
        FROM categories AS c, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Category entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Category instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Category);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Category.CategoryId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Category").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Category)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Category")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Category")]: 
                        {
                            return 
                            {
                                Category instance;
                                instance = new Category();
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(0);
                                instance.<CategoryName>k__BackingField = dataReader.GetString(1);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Category")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Category)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-05-04 14:30:57.961 +07:00 [DBG] Creating DbConnection.
2025-05-04 14:30:57.962 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 14:30:57.963 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:30:57.968 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:30:57.969 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 14:30:57.970 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 14:30:57.970 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 14:30:57.971 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[categoryId], [c].[categoryName]
FROM [categories] AS [c]
2025-05-04 14:30:57.976 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[categoryId], [c].[categoryName]
FROM [categories] AS [c]
2025-05-04 14:30:57.980 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:30:57.984 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:30:57.985 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:30:57.986 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:30:57.987 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:30:57.988 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:30:57.989 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:30:57.990 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:30:57.991 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:30:57.992 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:30:57.993 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:30:57.995 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:30:57.996 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 18ms reading results.
2025-05-04 14:30:57.997 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:30:57.998 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 14:30:58.014 +07:00 [DBG] 'ExchangeDocumentContext' generated a temporary value for the property 'Category.CategoryId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:30:58.021 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:30:58.024 +07:00 [DBG] SaveChanges starting for 'ExchangeDocumentContext'.
2025-05-04 14:30:58.026 +07:00 [DBG] DetectChanges starting for 'ExchangeDocumentContext'.
2025-05-04 14:30:58.032 +07:00 [DBG] DetectChanges completed for 'ExchangeDocumentContext'.
2025-05-04 14:30:58.072 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:30:58.073 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:30:58.076 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 14:30:58.077 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 14:30:58.078 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 14:30:58.080 +07:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [categories] ([categoryName])
OUTPUT INSERTED.[categoryId]
VALUES (@p0);
2025-05-04 14:30:58.086 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [categories] ([categoryName])
OUTPUT INSERTED.[categoryId]
VALUES (@p0);
2025-05-04 14:30:58.095 +07:00 [DBG] The foreign key property 'Category.CategoryId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-04 14:30:58.102 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:30:58.103 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 14ms reading results.
2025-05-04 14:30:58.106 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:30:58.107 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 14:30:58.115 +07:00 [DBG] An entity of type 'Category' tracked by 'ExchangeDocumentContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:30:58.119 +07:00 [DBG] SaveChanges completed for 'ExchangeDocumentContext' with 1 entities written to the database.
2025-05-04 14:30:58.121 +07:00 [INF] Danh mục tạo: 1 day (ID=16) bởi CategoryService
2025-05-04 14:30:58.124 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 14:30:58.126 +07:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-05-04 14:30:58.128 +07:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-05-04 14:30:58.129 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 14:30:58.130 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 14:30:58.131 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 14:30:58.133 +07:00 [INF] Executing CreatedAtActionResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.CategoryDto'.
2025-05-04 14:30:58.144 +07:00 [DBG] Found the endpoints ["ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument)"] for address (id=[16],action=[Create],controller=[AdminCategories])
2025-05-04 14:30:58.148 +07:00 [DBG] Successfully processed template api/admin/categories for ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument) resulting in /api/admin/categories and ?id=16
2025-05-04 14:30:58.153 +07:00 [DBG] Link generation succeeded for endpoints ["ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument)"] with result /api/admin/categories?id=16
2025-05-04 14:30:58.157 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument) in 231.2204ms
2025-05-04 14:30:58.160 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument)'
2025-05-04 14:30:58.161 +07:00 [INF] HTTP POST /api/admin/categories responded 201 in 250.2291 ms
2025-05-04 14:30:58.162 +07:00 [DBG] Connection id "0HNCARFDH79SO" completed keep alive response.
2025-05-04 14:30:58.164 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 14:30:58.165 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:30:58.168 +07:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-05-04 14:30:58.170 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/admin/categories - 201 null application/json; charset=utf-8 273.0467ms
2025-05-04 14:31:44.933 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/admin/categories - application/json 45
2025-05-04 14:31:44.939 +07:00 [DBG] 1 candidate(s) found for the request path '/api/admin/categories'
2025-05-04 14:31:44.940 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument)' with route pattern 'api/admin/categories' is valid for the request path '/api/admin/categories'
2025-05-04 14:31:44.943 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument)'
2025-05-04 14:31:44.945 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 14:31:44.949 +07:00 [DBG] Successfully validated the token.
2025-05-04 14:31:44.950 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 14:31:44.968 +07:00 [DBG] Authorization was successful.
2025-05-04 14:31:44.969 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument)'
2025-05-04 14:31:44.971 +07:00 [INF] Route matched with {action = "Create", controller = "AdminCategories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ExchangeDocument.BusinessLayer.DTOs.CategoryDto]] Create(ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto) on controller ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController (ExchangeDocument).
2025-05-04 14:31:44.975 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 14:31:44.979 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 14:31:44.980 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 14:31:44.983 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 14:31:44.984 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 14:31:44.987 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController (ExchangeDocument)
2025-05-04 14:31:44.989 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController (ExchangeDocument)
2025-05-04 14:31:44.992 +07:00 [DBG] Attempting to bind parameter 'createDto' of type 'ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto' ...
2025-05-04 14:31:44.994 +07:00 [DBG] Attempting to bind parameter 'createDto' of type 'ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto' using the name '' in request data ...
2025-05-04 14:31:44.996 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 14:31:44.997 +07:00 [DBG] Connection id "0HNCARFDH79SO", Request id "0HNCARFDH79SO:00000002": started reading request body.
2025-05-04 14:31:44.999 +07:00 [DBG] Connection id "0HNCARFDH79SO", Request id "0HNCARFDH79SO:00000002": done reading request body.
2025-05-04 14:31:45.001 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto'
2025-05-04 14:31:45.004 +07:00 [DBG] Done attempting to bind parameter 'createDto' of type 'ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto'.
2025-05-04 14:31:45.007 +07:00 [DBG] Done attempting to bind parameter 'createDto' of type 'ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto'.
2025-05-04 14:31:45.008 +07:00 [DBG] Attempting to validate the bound parameter 'createDto' of type 'ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto' ...
2025-05-04 14:31:45.010 +07:00 [DBG] Done attempting to validate the bound parameter 'createDto' of type 'ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto'.
2025-05-04 14:31:45.012 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 14:31:45.015 +07:00 [DBG] Creating DbConnection.
2025-05-04 14:31:45.015 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 14:31:45.016 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:31:45.017 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:31:45.018 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 14:31:45.019 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 14:31:45.021 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 14:31:45.022 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[categoryId], [c].[categoryName]
FROM [categories] AS [c]
2025-05-04 14:31:45.026 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[categoryId], [c].[categoryName]
FROM [categories] AS [c]
2025-05-04 14:31:45.032 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:31:45.035 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:31:45.037 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:31:45.038 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:31:45.039 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:31:45.041 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:31:45.042 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:31:45.044 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:31:45.045 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:31:45.046 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:31:45.048 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:31:45.049 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:31:45.050 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:31:45.051 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 18ms reading results.
2025-05-04 14:31:45.052 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:31:45.053 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (0ms).
2025-05-04 14:31:45.055 +07:00 [DBG] 'ExchangeDocumentContext' generated a temporary value for the property 'Category.CategoryId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:31:45.056 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:31:45.057 +07:00 [DBG] SaveChanges starting for 'ExchangeDocumentContext'.
2025-05-04 14:31:45.058 +07:00 [DBG] DetectChanges starting for 'ExchangeDocumentContext'.
2025-05-04 14:31:45.060 +07:00 [DBG] DetectChanges completed for 'ExchangeDocumentContext'.
2025-05-04 14:31:45.062 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:31:45.063 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:31:45.065 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 14:31:45.066 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 14:31:45.067 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 14:31:45.068 +07:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [categories] ([categoryName])
OUTPUT INSERTED.[categoryId]
VALUES (@p0);
2025-05-04 14:31:45.071 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [categories] ([categoryName])
OUTPUT INSERTED.[categoryId]
VALUES (@p0);
2025-05-04 14:31:45.074 +07:00 [DBG] The foreign key property 'Category.CategoryId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-04 14:31:45.076 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:31:45.077 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 3ms reading results.
2025-05-04 14:31:45.079 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:31:45.080 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 14:31:45.082 +07:00 [DBG] An entity of type 'Category' tracked by 'ExchangeDocumentContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:31:45.084 +07:00 [DBG] SaveChanges completed for 'ExchangeDocumentContext' with 1 entities written to the database.
2025-05-04 14:31:45.085 +07:00 [INF] Danh mục tạo: Thanh cong with 1 day (ID=17) bởi CategoryService
2025-05-04 14:31:45.087 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 14:31:45.089 +07:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-05-04 14:31:45.090 +07:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-05-04 14:31:45.091 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 14:31:45.092 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 14:31:45.093 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 14:31:45.095 +07:00 [INF] Executing CreatedAtActionResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.CategoryDto'.
2025-05-04 14:31:45.097 +07:00 [DBG] Found the endpoints ["ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument)"] for address (id=[17],action=[Create],controller=[AdminCategories])
2025-05-04 14:31:45.099 +07:00 [DBG] Successfully processed template api/admin/categories for ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument) resulting in /api/admin/categories and ?id=17
2025-05-04 14:31:45.101 +07:00 [DBG] Link generation succeeded for endpoints ["ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument)"] with result /api/admin/categories?id=17
2025-05-04 14:31:45.102 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument) in 115.3104ms
2025-05-04 14:31:45.104 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument)'
2025-05-04 14:31:45.105 +07:00 [INF] HTTP POST /api/admin/categories responded 201 in 160.0388 ms
2025-05-04 14:31:45.107 +07:00 [DBG] Connection id "0HNCARFDH79SO" completed keep alive response.
2025-05-04 14:31:45.108 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 14:31:45.110 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:31:45.111 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 14:31:45.113 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/admin/categories - 201 null application/json; charset=utf-8 179.8769ms
2025-05-04 14:32:13.778 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/logout - null 0
2025-05-04 14:32:13.783 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/logout'
2025-05-04 14:32:13.787 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Logout (ExchangeDocument)' with route pattern 'api/Auth/logout' is valid for the request path '/api/Auth/logout'
2025-05-04 14:32:13.806 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Logout (ExchangeDocument)'
2025-05-04 14:32:13.810 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 14:32:13.815 +07:00 [DBG] Successfully validated the token.
2025-05-04 14:32:13.817 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 14:32:13.819 +07:00 [DBG] Authorization was successful.
2025-05-04 14:32:13.819 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Logout (ExchangeDocument)'
2025-05-04 14:32:13.824 +07:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 14:32:13.827 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 14:32:13.828 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 14:32:13.829 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 14:32:13.832 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 14:32:13.833 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 14:32:13.834 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 14:32:13.836 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 14:32:13.838 +07:00 [INF] Adding JTI c3661da0-71f3-4847-ba82-538217db383e to memory cache blacklist, expires in "00:46:48.1617868"
2025-05-04 14:32:13.841 +07:00 [INF] Blacklisted token with JTI c3661da0-71f3-4847-ba82-538217db383e until "2025-05-04T08:19:02.0000000Z"
2025-05-04 14:32:13.843 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 14:32:13.845 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 14:32:13.845 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 14:32:13.846 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 14:32:13.846 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 14:32:13.847 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 14:32:13.849 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Logout (ExchangeDocument) in 14.8348ms
2025-05-04 14:32:13.850 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Logout (ExchangeDocument)'
2025-05-04 14:32:13.851 +07:00 [INF] HTTP POST /api/Auth/logout responded 200 in 40.5681 ms
2025-05-04 14:32:13.852 +07:00 [DBG] Connection id "0HNCARFDH79SO" completed keep alive response.
2025-05-04 14:32:13.853 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/logout - 200 null application/json; charset=utf-8 74.9592ms
2025-05-04 14:32:27.359 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/admin/categories - application/json 42
2025-05-04 14:32:27.365 +07:00 [DBG] 1 candidate(s) found for the request path '/api/admin/categories'
2025-05-04 14:32:27.366 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument)' with route pattern 'api/admin/categories' is valid for the request path '/api/admin/categories'
2025-05-04 14:32:27.368 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument)'
2025-05-04 14:32:27.369 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 14:32:27.371 +07:00 [DBG] Successfully validated the token.
2025-05-04 14:32:27.373 +07:00 [WRN] JTI c3661da0-71f3-4847-ba82-538217db383e found in memory cache blacklist.
2025-05-04 14:32:27.376 +07:00 [INF] Bearer was not authenticated. Failure message: Token has been revoked.
2025-05-04 14:32:27.379 +07:00 [DBG] Policy authentication schemes  did not succeed
2025-05-04 14:32:27.380 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-04 14:32:27.384 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-04 14:32:27.385 +07:00 [INF] HTTP POST /api/admin/categories responded 401 in 15.9722 ms
2025-05-04 14:32:27.387 +07:00 [DBG] Connection id "0HNCARFDH79SO" completed keep alive response.
2025-05-04 14:32:27.388 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/admin/categories - 401 0 null 28.8357ms
2025-05-04 14:32:27.391 +07:00 [DBG] Connection id "0HNCARFDH79SO", Request id "0HNCARFDH79SO:00000004": started reading request body.
2025-05-04 14:32:27.393 +07:00 [DBG] Connection id "0HNCARFDH79SO", Request id "0HNCARFDH79SO:00000004": done reading request body.
2025-05-04 14:34:39.301 +07:00 [DBG] Connection id "0HNCARFDH79SO" disconnecting.
2025-05-04 14:34:39.307 +07:00 [DBG] Connection id "0HNCARFDH79SO" stopped.
2025-05-04 14:34:39.313 +07:00 [DBG] Connection id "0HNCARFDH79SO" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 14:36:18.550 +07:00 [DBG] Connection id "0HNCARFDH79SP" accepted.
2025-05-04 14:36:18.555 +07:00 [DBG] Connection id "0HNCARFDH79SP" started.
2025-05-04 14:36:18.555 +07:00 [DBG] Connection id "0HNCARFDH79SQ" accepted.
2025-05-04 14:36:18.559 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/index.html - null null
2025-05-04 14:36:18.562 +07:00 [DBG] Connection id "0HNCARFDH79SQ" started.
2025-05-04 14:36:18.566 +07:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-05-04 14:36:18.568 +07:00 [DBG] Request did not match any endpoints
2025-05-04 14:36:18.570 +07:00 [INF] HTTP GET /swagger/index.html responded 200 in 0.4994 ms
2025-05-04 14:36:18.575 +07:00 [DBG] Connection id "0HNCARFDH79SP" completed keep alive response.
2025-05-04 14:36:18.577 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/index.html - 200 null text/html;charset=utf-8 18.3466ms
2025-05-04 14:36:19.014 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - null null
2025-05-04 14:36:19.020 +07:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-05-04 14:36:19.022 +07:00 [DBG] Request did not match any endpoints
2025-05-04 14:36:19.037 +07:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 13.1112 ms
2025-05-04 14:36:19.044 +07:00 [DBG] Connection id "0HNCARFDH79SP" completed keep alive response.
2025-05-04 14:36:19.046 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 31.773ms
2025-05-04 14:36:45.204 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 64
2025-05-04 14:36:45.210 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 14:36:45.211 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 14:36:45.213 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 14:36:45.221 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 14:36:45.224 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 14:36:45.241 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 14:36:45.245 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 14:36:45.253 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 14:36:45.255 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 14:36:45.258 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 14:36:45.260 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 14:36:45.261 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 14:36:45.263 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 14:36:45.265 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 14:36:45.267 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 14:36:45.268 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 14:36:45.270 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 14:36:45.271 +07:00 [DBG] Connection id "0HNCARFDH79SP", Request id "0HNCARFDH79SP:00000003": started reading request body.
2025-05-04 14:36:45.273 +07:00 [DBG] Connection id "0HNCARFDH79SP", Request id "0HNCARFDH79SP:00000003": done reading request body.
2025-05-04 14:36:45.274 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 14:36:45.275 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 14:36:45.276 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 14:36:45.277 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 14:36:45.278 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 14:36:45.280 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 14:36:45.282 +07:00 [DBG] Creating DbConnection.
2025-05-04 14:36:45.283 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 14:36:45.283 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:36:45.285 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:36:45.285 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 14:36:45.286 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 14:36:45.288 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 14:36:45.289 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 14:36:45.294 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 14:36:45.296 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:36:45.297 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:36:45.298 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:36:45.299 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:36:45.300 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 4ms reading results.
2025-05-04 14:36:45.302 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:36:45.303 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 14:36:45.445 +07:00 [INF] User nguyetnkhuyen@gmail.com logged in successfully
2025-05-04 14:36:45.447 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 14:36:45.450 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 14:36:45.451 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 14:36:45.452 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 14:36:45.453 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 14:36:45.455 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType6`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 14:36:45.457 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 193.7938ms
2025-05-04 14:36:45.460 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 14:36:45.461 +07:00 [INF] HTTP POST /api/Auth/login responded 200 in 240.8806 ms
2025-05-04 14:36:45.463 +07:00 [DBG] Connection id "0HNCARFDH79SP" completed keep alive response.
2025-05-04 14:36:45.465 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 14:36:45.466 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:36:45.468 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 14:36:45.470 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 200 null application/json; charset=utf-8 265.9796ms
2025-05-04 14:37:08.547 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/me - null null
2025-05-04 14:37:08.552 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me'
2025-05-04 14:37:08.553 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 14:37:08.556 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:37:08.560 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 14:37:08.562 +07:00 [DBG] Successfully validated the token.
2025-05-04 14:37:08.563 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 14:37:08.564 +07:00 [DBG] Authorization was successful.
2025-05-04 14:37:08.565 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:37:08.566 +07:00 [INF] Route matched with {action = "GetMe", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMe() on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 14:37:08.569 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 14:37:08.571 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 14:37:08.575 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 14:37:08.577 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 14:37:08.579 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 14:37:08.580 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 14:37:08.582 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 14:37:08.583 +07:00 [WRN] GetMe called without valid sub claim
2025-05-04 14:37:08.584 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 14:37:08.587 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 14:37:08.587 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-05-04 14:37:08.590 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-05-04 14:37:08.591 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-05-04 14:37:08.592 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument) in 12.0016ms
2025-05-04 14:37:08.594 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:37:08.595 +07:00 [INF] HTTP GET /api/Users/me responded 401 in 35.4629 ms
2025-05-04 14:37:08.597 +07:00 [DBG] Connection id "0HNCARFDH79SP" completed keep alive response.
2025-05-04 14:37:08.598 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/me - 401 null application/problem+json; charset=utf-8 50.8319ms
2025-05-04 14:37:22.942 +07:00 [DBG] Connection id "0HNCARFDH79SQ" received FIN.
2025-05-04 14:37:22.945 +07:00 [DBG] Connection id "0HNCARFDH79SQ" disconnecting.
2025-05-04 14:37:22.949 +07:00 [DBG] Connection id "0HNCARFDH79SQ" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 14:37:22.952 +07:00 [DBG] Connection id "0HNCARFDH79SQ" stopped.
2025-05-04 14:39:20.299 +07:00 [DBG] Connection id "0HNCARFDH79SP" disconnecting.
2025-05-04 14:39:20.304 +07:00 [DBG] Connection id "0HNCARFDH79SP" stopped.
2025-05-04 14:39:20.307 +07:00 [DBG] Connection id "0HNCARFDH79SP" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 14:42:52.859 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-05-04 14:42:52.959 +07:00 [DBG] Hosting starting
2025-05-04 14:42:52.970 +07:00 [INF] User profile is available. Using 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-04 14:42:52.982 +07:00 [DBG] Reading data from file 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys\key-1a51a872-ea43-4350-815f-0422835a65dd.xml'.
2025-05-04 14:42:52.989 +07:00 [DBG] Found key {1a51a872-ea43-4350-815f-0422835a65dd}.
2025-05-04 14:42:53.000 +07:00 [DBG] Considering key {1a51a872-ea43-4350-815f-0422835a65dd} with expiration date 2025-07-05 19:31:04Z as default key.
2025-05-04 14:42:53.004 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 14:42:53.008 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-05-04 14:42:53.010 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 14:42:53.018 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-05-04 14:42:53.021 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-05-04 14:42:53.023 +07:00 [DBG] Using key {1a51a872-ea43-4350-815f-0422835a65dd} as the default key.
2025-05-04 14:42:53.025 +07:00 [DBG] Key ring with default key {1a51a872-ea43-4350-815f-0422835a65dd} was loaded during application startup.
2025-05-04 14:42:53.071 +07:00 [INF] Now listening on: http://localhost:5120
2025-05-04 14:42:53.072 +07:00 [DBG] Loaded hosting startup assembly ExchangeDocument
2025-05-04 14:42:53.073 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-04 14:42:53.075 +07:00 [INF] Hosting environment: Development
2025-05-04 14:42:53.076 +07:00 [INF] Content root path: D:\Gộp module Auth\ExchangeDocument(Tự làm Auth_User) - Đã làm logout(2)\ExchangeDocument
2025-05-04 14:42:53.077 +07:00 [DBG] Hosting started
2025-05-04 14:42:55.905 +07:00 [DBG] Connection id "0HNCART4BMEVL" accepted.
2025-05-04 14:42:55.910 +07:00 [DBG] Connection id "0HNCART4BMEVL" started.
2025-05-04 14:42:55.910 +07:00 [DBG] Connection id "0HNCART4BMEVM" accepted.
2025-05-04 14:42:55.915 +07:00 [DBG] Connection id "0HNCART4BMEVM" started.
2025-05-04 14:42:55.939 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/index.html - null null
2025-05-04 14:42:55.946 +07:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-05-04 14:42:55.961 +07:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-05-04 14:42:55.964 +07:00 [DBG] Request did not match any endpoints
2025-05-04 14:42:56.051 +07:00 [INF] HTTP GET /swagger/index.html responded 200 in 82.6142 ms
2025-05-04 14:42:56.058 +07:00 [DBG] Connection id "0HNCART4BMEVL" completed keep alive response.
2025-05-04 14:42:56.062 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/index.html - 200 null text/html;charset=utf-8 123.7832ms
2025-05-04 14:42:56.544 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - null null
2025-05-04 14:42:56.549 +07:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-05-04 14:42:56.551 +07:00 [DBG] Request did not match any endpoints
2025-05-04 14:42:56.720 +07:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 167.4441 ms
2025-05-04 14:42:56.722 +07:00 [DBG] Connection id "0HNCART4BMEVL" completed keep alive response.
2025-05-04 14:42:56.725 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 180.7279ms
2025-05-04 14:43:16.836 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 60
2025-05-04 14:43:16.842 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 14:43:16.848 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 14:43:16.854 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 14:43:16.859 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 14:43:16.864 +07:00 [WRN] Failed to determine the https port for redirect.
2025-05-04 14:43:16.885 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 14:43:16.890 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 14:43:16.914 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 14:43:16.921 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 14:43:16.925 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 14:43:16.931 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 14:43:16.933 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 14:43:16.934 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 14:43:16.938 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 14:43:16.996 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-05-04 14:43:17.016 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 14:43:17.024 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 14:43:17.028 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 14:43:17.030 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 14:43:17.051 +07:00 [DBG] Connection id "0HNCART4BMEVL", Request id "0HNCART4BMEVL:00000003": started reading request body.
2025-05-04 14:43:17.055 +07:00 [DBG] Connection id "0HNCART4BMEVL", Request id "0HNCART4BMEVL:00000003": done reading request body.
2025-05-04 14:43:17.068 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 14:43:17.071 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 14:43:17.078 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 14:43:17.081 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 14:43:17.087 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 14:43:17.445 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'OrderDetail'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 14:43:17.448 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'Review'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 14:43:17.579 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 14:43:17.633 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .FirstOrDefault(u => u.Email == __email_0)'
2025-05-04 14:43:17.692 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-04 14:43:17.877 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE u.email == @__email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE u.email == @__email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            Role entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<Email>k__BackingField = dataReader.GetString(2);
                                    instance.<FullName>k__BackingField = dataReader.GetString(3);
                                    instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(4);
                                    instance.<Password>k__BackingField = dataReader.GetString(5);
                                    instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                    instance.<Phone>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(8) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(8);
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(9);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                Role instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(Role);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(11) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (Role)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                            {
                                return 
                                {
                                    Role instance;
                                    instance = new Role();
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                    instance.<RoleName>k__BackingField = dataReader.GetString(12);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Role)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
                fixup: (namelessParameter{8}, namelessParameter{9}) => 
                {
                    namelessParameter{8}.<Role>k__BackingField = namelessParameter{9};
                    return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                        entity: namelessParameter{9}, 
                        value: namelessParameter{8}, 
                        forMaterialization: True);
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-04 14:43:17.937 +07:00 [DBG] Creating DbConnection.
2025-05-04 14:43:17.952 +07:00 [DBG] Created DbConnection. (14ms).
2025-05-04 14:43:17.958 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:43:18.063 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:43:18.066 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 14:43:18.072 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-05-04 14:43:18.078 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (12ms).
2025-05-04 14:43:18.084 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 14:43:18.118 +07:00 [INF] Executed DbCommand (35ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 14:43:18.130 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:43:18.138 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 12ms reading results.
2025-05-04 14:43:18.145 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:43:18.150 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (4ms).
2025-05-04 14:43:18.152 +07:00 [WRN] Login failed: user nguyetnkhuyen@gmail not found
2025-05-04 14:43:18.158 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 14:43:18.162 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 14:43:18.163 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 14:43:18.165 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 14:43:18.167 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 14:43:18.169 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType4`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 14:43:18.184 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 1246.4858ms
2025-05-04 14:43:18.187 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 14:43:18.192 +07:00 [INF] HTTP POST /api/Auth/login responded 400 in 1334.0042 ms
2025-05-04 14:43:18.194 +07:00 [DBG] Connection id "0HNCART4BMEVL" completed keep alive response.
2025-05-04 14:43:18.198 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 14:43:18.206 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:43:18.210 +07:00 [DBG] Disposed connection to database '' on server '' (4ms).
2025-05-04 14:43:18.212 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 400 null application/json; charset=utf-8 1376.5599ms
2025-05-04 14:43:25.821 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 64
2025-05-04 14:43:25.826 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 14:43:25.831 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 14:43:25.834 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 14:43:25.836 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 14:43:25.839 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 14:43:25.841 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 14:43:25.844 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 14:43:25.848 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 14:43:25.849 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 14:43:25.851 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 14:43:25.853 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 14:43:25.857 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 14:43:25.859 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 14:43:25.862 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 14:43:25.864 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 14:43:25.866 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 14:43:25.868 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 14:43:25.872 +07:00 [DBG] Connection id "0HNCART4BMEVL", Request id "0HNCART4BMEVL:00000004": started reading request body.
2025-05-04 14:43:25.876 +07:00 [DBG] Connection id "0HNCART4BMEVL", Request id "0HNCART4BMEVL:00000004": done reading request body.
2025-05-04 14:43:25.878 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 14:43:25.879 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 14:43:25.881 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 14:43:25.882 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 14:43:25.883 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 14:43:25.894 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 14:43:25.899 +07:00 [DBG] Creating DbConnection.
2025-05-04 14:43:25.900 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 14:43:25.901 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:43:25.904 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:43:25.906 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 14:43:25.907 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-04 14:43:25.908 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 14:43:25.910 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 14:43:25.914 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 14:43:25.935 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:43:25.967 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:43:25.974 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:43:25.978 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:43:25.980 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 62ms reading results.
2025-05-04 14:43:25.982 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:43:25.984 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 14:43:26.246 +07:00 [INF] User nguyetnkhuyen@gmail.com logged in successfully
2025-05-04 14:43:26.248 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 14:43:26.252 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 14:43:26.253 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 14:43:26.254 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 14:43:26.255 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 14:43:26.259 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType6`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 14:43:26.263 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 403.9985ms
2025-05-04 14:43:26.265 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 14:43:26.268 +07:00 [INF] HTTP POST /api/Auth/login responded 200 in 431.9190 ms
2025-05-04 14:43:26.271 +07:00 [DBG] Connection id "0HNCART4BMEVL" completed keep alive response.
2025-05-04 14:43:26.272 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 14:43:26.274 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:43:26.277 +07:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-05-04 14:43:26.279 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 200 null application/json; charset=utf-8 458.4464ms
2025-05-04 14:43:59.253 +07:00 [DBG] Connection id "0HNCART4BMEVM" received FIN.
2025-05-04 14:43:59.253 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/me - null null
2025-05-04 14:43:59.257 +07:00 [DBG] Connection id "0HNCART4BMEVM" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 14:43:59.259 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me'
2025-05-04 14:43:59.260 +07:00 [DBG] Connection id "0HNCART4BMEVM" disconnecting.
2025-05-04 14:43:59.261 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 14:43:59.266 +07:00 [DBG] Connection id "0HNCART4BMEVM" stopped.
2025-05-04 14:43:59.267 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:43:59.271 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 14:43:59.305 +07:00 [DBG] Successfully validated the token.
2025-05-04 14:43:59.311 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 14:43:59.320 +07:00 [DBG] Authorization was successful.
2025-05-04 14:43:59.321 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:43:59.326 +07:00 [INF] Route matched with {action = "GetMe", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMe() on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 14:43:59.329 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 14:43:59.330 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 14:43:59.333 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 14:43:59.336 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 14:43:59.339 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 14:43:59.341 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 14:43:59.344 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 14:43:59.391 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 14:43:59.396 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .Include(u => u.Userprofile)
    .FirstOrDefault(u => u.UserId == __userId_0)'
2025-05-04 14:43:59.400 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-04 14:43:59.403 +07:00 [DBG] Including navigation: 'User.Userprofile'.
2025-05-04 14:43:59.415 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
                2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName, u0.userprofileId, u0.address, u0.birth, u0.userId
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            LEFT JOIN userprofiles AS u0 ON u.userId == u0.userId
            WHERE u.userId == @__userId_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
                2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName, u0.userprofileId, u0.address, u0.birth, u0.userId
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            LEFT JOIN userprofiles AS u0 ON u.userId == u0.userId
            WHERE u.userId == @__userId_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            Role entity;
            Userprofile entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<Email>k__BackingField = dataReader.GetString(2);
                                    instance.<FullName>k__BackingField = dataReader.GetString(3);
                                    instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(4);
                                    instance.<Password>k__BackingField = dataReader.GetString(5);
                                    instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                    instance.<Phone>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(8) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(8);
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(9);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                Role instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(Role);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(11) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (Role)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                            {
                                return 
                                {
                                    Role instance;
                                    instance = new Role();
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                    instance.<RoleName>k__BackingField = dataReader.GetString(12);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Role)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            entity = 
            {
                MaterializationContext materializationContext3;
                IEntityType entityType3;
                Userprofile instance3;
                InternalEntityEntry entry3;
                bool hasNullKey3;
                materializationContext3 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance3 = default(Userprofile);
                entry3 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Userprofile.UserprofileId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(13) ? default(object) : (object)dataReader.GetInt32(13) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey3);
                !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
                {
                    entityType3 = entry3.EntityType;
                    return instance3 = (Userprofile)entry3.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot3;
                    shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType3 = [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")];
                    instance3 = switch (entityType3)
                    {
                        case [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]: 
                            {
                                return 
                                {
                                    Userprofile instance;
                                    instance = new Userprofile();
                                    instance.<UserprofileId>k__BackingField = dataReader.IsDBNull(13) ? default(int) : dataReader.GetInt32(13);
                                    instance.<Address>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                    instance.<Birth>k__BackingField = dataReader.IsDBNull(15) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(15);
                                    instance.<UserId>k__BackingField = dataReader.IsDBNull(16) ? default(int) : dataReader.GetInt32(16);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext3.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Userprofile)
                    }
                    ;
                    entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType3, 
                        entity: instance3, 
                        snapshot: shadowSnapshot3);
                    return instance3;
                } : default(void);
                return instance3;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
                fixup: (namelessParameter{11}, namelessParameter{12}) => 
                {
                    namelessParameter{11}.<Role>k__BackingField = namelessParameter{12};
                    return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                        entity: namelessParameter{12}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                }, 
                trackingQuery: True);
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Userprofile>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Userprofile (Userprofile) ToDependent Userprofile Inverse: User | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Userprofile")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Userprofile.User (User) ToPrincipal User Inverse: Userprofile | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindNavigation("User")], 
                fixup: (namelessParameter{16}, namelessParameter{17}) => 
                {
                    namelessParameter{16}.<Userprofile>k__BackingField = namelessParameter{17};
                    return namelessParameter{17}.<User>k__BackingField = namelessParameter{16};
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-04 14:43:59.467 +07:00 [DBG] Creating DbConnection.
2025-05-04 14:43:59.470 +07:00 [DBG] Created DbConnection. (2ms).
2025-05-04 14:43:59.471 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:43:59.473 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:43:59.475 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 14:43:59.476 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 14:43:59.477 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 14:43:59.479 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 14:43:59.487 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 14:43:59.490 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:43:59.491 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:43:59.493 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:43:59.495 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:43:59.497 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 6ms reading results.
2025-05-04 14:43:59.499 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:43:59.501 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (2ms).
2025-05-04 14:43:59.504 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 14:43:59.507 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 14:43:59.508 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 14:43:59.508 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 14:43:59.509 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 14:43:59.511 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO'.
2025-05-04 14:43:59.524 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument) in 183.4782ms
2025-05-04 14:43:59.526 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:43:59.528 +07:00 [INF] HTTP GET /api/Users/me responded 200 in 257.2367 ms
2025-05-04 14:43:59.530 +07:00 [DBG] Connection id "0HNCART4BMEVL" completed keep alive response.
2025-05-04 14:43:59.532 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 14:43:59.533 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:43:59.535 +07:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-05-04 14:43:59.537 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/me - 200 null application/json; charset=utf-8 283.7348ms
2025-05-04 14:46:11.285 +07:00 [DBG] Connection id "0HNCART4BMEVL" disconnecting.
2025-05-04 14:46:11.291 +07:00 [DBG] Connection id "0HNCART4BMEVL" stopped.
2025-05-04 14:46:11.294 +07:00 [DBG] Connection id "0HNCART4BMEVL" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 14:51:15.140 +07:00 [DBG] Connection id "0HNCART4BMEVN" accepted.
2025-05-04 14:51:15.142 +07:00 [DBG] Connection id "0HNCART4BMEVN" started.
2025-05-04 14:51:15.144 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/me - null null
2025-05-04 14:51:15.149 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me'
2025-05-04 14:51:15.152 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 14:51:15.155 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:51:15.157 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 14:51:15.166 +07:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> System.ArgumentException: IDX14102: Unable to decode the header '[PII of type 'Microsoft.IdentityModel.Logging.SecurityArtifact' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]' as Base64Url encoded string.
 ---> System.Text.Json.JsonReaderException: '0xC8' is an invalid start of a value. LineNumber: 0 | BytePositionInLine: 0.
   at System.Text.Json.ThrowHelper.ThrowJsonReaderException(Utf8JsonReader& json, ExceptionResource resource, Byte nextByte, ReadOnlySpan`1 bytes)
   at System.Text.Json.Utf8JsonReader.ConsumeValue(Byte marker)
   at System.Text.Json.Utf8JsonReader.ReadFirstToken(Byte first)
   at System.Text.Json.Utf8JsonReader.ReadSingleSegment()
   at System.Text.Json.Utf8JsonReader.Read()
   at Microsoft.IdentityModel.Tokens.Json.JsonSerializerPrimitives.IsReaderAtTokenType(Utf8JsonReader& reader, JsonTokenType tokenType, Boolean advanceReader)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.CreateHeaderClaimSet(Byte[] bytes, Int32 length)
   at Microsoft.IdentityModel.Tokens.Base64UrlEncoding.Decode[T](String input, Int32 offset, Int32 length, Func`3 action)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.CreateClaimSet(String rawString, Int32 startIndex, Int32 length, Func`3 action)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   --- End of inner exception stack trace ---
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-05-04 14:51:15.182 +07:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-05-04 14:51:15.185 +07:00 [DBG] Policy authentication schemes  did not succeed
2025-05-04 14:51:15.187 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-04 14:51:15.193 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-04 14:51:15.195 +07:00 [INF] HTTP GET /api/Users/me responded 401 in 37.7396 ms
2025-05-04 14:51:15.199 +07:00 [DBG] Connection id "0HNCART4BMEVN" completed keep alive response.
2025-05-04 14:51:15.200 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/me - 401 0 null 55.7807ms
2025-05-04 14:51:43.308 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/me - null null
2025-05-04 14:51:43.315 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me'
2025-05-04 14:51:43.318 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 14:51:43.321 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:51:43.323 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 14:51:43.325 +07:00 [DBG] Successfully validated the token.
2025-05-04 14:51:43.327 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 14:51:43.331 +07:00 [DBG] Authorization was successful.
2025-05-04 14:51:43.334 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:51:43.335 +07:00 [INF] Route matched with {action = "GetMe", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMe() on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 14:51:43.337 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 14:51:43.340 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 14:51:43.342 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 14:51:43.348 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 14:51:43.351 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 14:51:43.352 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 14:51:43.354 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 14:51:43.358 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 14:51:43.360 +07:00 [DBG] Creating DbConnection.
2025-05-04 14:51:43.362 +07:00 [DBG] Created DbConnection. (1ms).
2025-05-04 14:51:43.363 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:51:43.367 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:51:43.369 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 14:51:43.370 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 14:51:43.371 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 14:51:43.373 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 14:51:43.385 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 14:51:43.391 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:51:43.394 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:51:43.396 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 14:51:43.398 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:51:43.400 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 9ms reading results.
2025-05-04 14:51:43.402 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:51:43.403 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 14:51:43.405 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 14:51:43.410 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 14:51:43.411 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 14:51:43.412 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 14:51:43.413 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 14:51:43.413 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO'.
2025-05-04 14:51:43.414 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument) in 62.4203ms
2025-05-04 14:51:43.416 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 14:51:43.416 +07:00 [INF] HTTP GET /api/Users/me responded 200 in 93.8189 ms
2025-05-04 14:51:43.418 +07:00 [DBG] Connection id "0HNCART4BMEVN" completed keep alive response.
2025-05-04 14:51:43.419 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 14:51:43.420 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 14:51:43.422 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 14:51:43.423 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/me - 200 null application/json; charset=utf-8 115.1888ms
2025-05-04 14:52:16.922 +07:00 [INF] Application is shutting down...
2025-05-04 14:52:16.924 +07:00 [DBG] Hosting stopping
2025-05-04 14:52:16.934 +07:00 [DBG] Connection id "0HNCART4BMEVN" disconnecting.
2025-05-04 14:52:16.936 +07:00 [DBG] Connection id "0HNCART4BMEVN" stopped.
2025-05-04 14:52:16.940 +07:00 [DBG] Connection id "0HNCART4BMEVN" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 14:52:16.948 +07:00 [DBG] Hosting stopped
2025-05-04 15:55:58.492 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-05-04 15:55:58.627 +07:00 [DBG] Hosting starting
2025-05-04 15:55:58.642 +07:00 [INF] User profile is available. Using 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-04 15:55:58.666 +07:00 [DBG] Reading data from file 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys\key-1a51a872-ea43-4350-815f-0422835a65dd.xml'.
2025-05-04 15:55:58.679 +07:00 [DBG] Found key {1a51a872-ea43-4350-815f-0422835a65dd}.
2025-05-04 15:55:58.690 +07:00 [DBG] Considering key {1a51a872-ea43-4350-815f-0422835a65dd} with expiration date 2025-07-05 19:31:04Z as default key.
2025-05-04 15:55:58.697 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 15:55:58.702 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-05-04 15:55:58.705 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 15:55:58.714 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-05-04 15:55:58.717 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-05-04 15:55:58.722 +07:00 [DBG] Using key {1a51a872-ea43-4350-815f-0422835a65dd} as the default key.
2025-05-04 15:55:58.725 +07:00 [DBG] Key ring with default key {1a51a872-ea43-4350-815f-0422835a65dd} was loaded during application startup.
2025-05-04 15:55:58.777 +07:00 [INF] Now listening on: http://localhost:5120
2025-05-04 15:55:58.780 +07:00 [DBG] Loaded hosting startup assembly ExchangeDocument
2025-05-04 15:55:58.783 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-04 15:55:58.784 +07:00 [INF] Hosting environment: Development
2025-05-04 15:55:58.786 +07:00 [INF] Content root path: D:\Gộp module Auth\ExchangeDocument(Tự làm Auth_User) - Đã làm logout(2)\ExchangeDocument
2025-05-04 15:55:58.787 +07:00 [DBG] Hosting started
2025-05-04 15:56:07.864 +07:00 [DBG] Connection id "0HNCAT618LRQ5" accepted.
2025-05-04 15:56:07.871 +07:00 [DBG] Connection id "0HNCAT618LRQ5" started.
2025-05-04 15:56:07.872 +07:00 [DBG] Connection id "0HNCAT618LRQ6" accepted.
2025-05-04 15:56:07.879 +07:00 [DBG] Connection id "0HNCAT618LRQ6" started.
2025-05-04 15:56:07.956 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/index.html - null null
2025-05-04 15:56:07.970 +07:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-05-04 15:56:08.016 +07:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-05-04 15:56:08.023 +07:00 [DBG] Request did not match any endpoints
2025-05-04 15:56:08.255 +07:00 [INF] HTTP GET /swagger/index.html responded 200 in 220.8495 ms
2025-05-04 15:56:08.265 +07:00 [DBG] Connection id "0HNCAT618LRQ5" completed keep alive response.
2025-05-04 15:56:08.270 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/index.html - 200 null text/html;charset=utf-8 317.3742ms
2025-05-04 15:56:08.963 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - null null
2025-05-04 15:56:08.973 +07:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-05-04 15:56:08.979 +07:00 [DBG] Request did not match any endpoints
2025-05-04 15:56:09.333 +07:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 352.5735 ms
2025-05-04 15:56:09.338 +07:00 [DBG] Connection id "0HNCAT618LRQ5" completed keep alive response.
2025-05-04 15:56:09.342 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 378.7191ms
2025-05-04 15:56:20.550 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/me - application/json 95
2025-05-04 15:56:20.568 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me'
2025-05-04 15:56:20.583 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 15:56:20.591 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 15:56:20.600 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 15:56:20.604 +07:00 [WRN] Failed to determine the https port for redirect.
2025-05-04 15:56:20.678 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 15:56:20.687 +07:00 [DBG] Policy authentication schemes  did not succeed
2025-05-04 15:56:20.697 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-04 15:56:20.711 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-04 15:56:20.717 +07:00 [INF] HTTP PUT /api/Users/me responded 401 in 120.1063 ms
2025-05-04 15:56:20.722 +07:00 [DBG] Connection id "0HNCAT618LRQ5" completed keep alive response.
2025-05-04 15:56:20.727 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/me - 401 0 null 176.1671ms
2025-05-04 15:56:20.740 +07:00 [DBG] Connection id "0HNCAT618LRQ5", Request id "0HNCAT618LRQ5:00000003": started reading request body.
2025-05-04 15:56:20.745 +07:00 [DBG] Connection id "0HNCAT618LRQ5", Request id "0HNCAT618LRQ5:00000003": done reading request body.
2025-05-04 15:57:12.895 +07:00 [DBG] Connection id "0HNCAT618LRQ6" received FIN.
2025-05-04 15:57:12.895 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 64
2025-05-04 15:57:12.902 +07:00 [DBG] Connection id "0HNCAT618LRQ6" disconnecting.
2025-05-04 15:57:12.903 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 15:57:12.905 +07:00 [DBG] Connection id "0HNCAT618LRQ6" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 15:57:12.909 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 15:57:12.920 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 15:57:12.925 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 15:57:12.934 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 15:57:12.937 +07:00 [DBG] Connection id "0HNCAT618LRQ6" stopped.
2025-05-04 15:57:12.940 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 15:57:13.005 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 15:57:13.013 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 15:57:13.017 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 15:57:13.022 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 15:57:13.030 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 15:57:13.034 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 15:57:13.042 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 15:57:13.268 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-05-04 15:57:13.323 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 15:57:13.334 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 15:57:13.342 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 15:57:13.350 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 15:57:13.419 +07:00 [DBG] Connection id "0HNCAT618LRQ5", Request id "0HNCAT618LRQ5:00000004": started reading request body.
2025-05-04 15:57:13.424 +07:00 [DBG] Connection id "0HNCAT618LRQ5", Request id "0HNCAT618LRQ5:00000004": done reading request body.
2025-05-04 15:57:13.454 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 15:57:13.461 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 15:57:13.464 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 15:57:13.470 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 15:57:13.492 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 15:57:14.707 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'OrderDetail'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 15:57:14.714 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'Review'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 15:57:15.084 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 15:57:15.228 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .FirstOrDefault(u => u.Email == __email_0)'
2025-05-04 15:57:15.400 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-04 15:57:16.005 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE u.email == @__email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE u.email == @__email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            Role entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<Email>k__BackingField = dataReader.GetString(2);
                                    instance.<FullName>k__BackingField = dataReader.GetString(3);
                                    instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(4);
                                    instance.<Password>k__BackingField = dataReader.GetString(5);
                                    instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                    instance.<Phone>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(8) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(8);
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(9);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                Role instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(Role);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(11) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (Role)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                            {
                                return 
                                {
                                    Role instance;
                                    instance = new Role();
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                    instance.<RoleName>k__BackingField = dataReader.GetString(12);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Role)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
                fixup: (namelessParameter{8}, namelessParameter{9}) => 
                {
                    namelessParameter{8}.<Role>k__BackingField = namelessParameter{9};
                    return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                        entity: namelessParameter{9}, 
                        value: namelessParameter{8}, 
                        forMaterialization: True);
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-04 15:57:16.169 +07:00 [DBG] Creating DbConnection.
2025-05-04 15:57:16.211 +07:00 [DBG] Created DbConnection. (37ms).
2025-05-04 15:57:16.225 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 15:57:16.553 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 15:57:16.563 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 15:57:16.588 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (15ms).
2025-05-04 15:57:16.609 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (46ms).
2025-05-04 15:57:16.631 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 15:57:16.745 +07:00 [INF] Executed DbCommand (117ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 15:57:16.837 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 15:57:16.948 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 15:57:16.963 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 15:57:16.988 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 15:57:17.012 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 246ms reading results.
2025-05-04 15:57:17.025 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 15:57:17.042 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (17ms).
2025-05-04 15:57:18.051 +07:00 [INF] User nguyetnkhuyen@gmail.com logged in successfully
2025-05-04 15:57:18.063 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 15:57:18.079 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 15:57:18.082 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 15:57:18.085 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 15:57:18.090 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 15:57:18.095 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType6`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 15:57:18.161 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 5115.0693ms
2025-05-04 15:57:18.165 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 15:57:18.173 +07:00 [INF] HTTP POST /api/Auth/login responded 200 in 5248.6456 ms
2025-05-04 15:57:18.177 +07:00 [DBG] Connection id "0HNCAT618LRQ5" completed keep alive response.
2025-05-04 15:57:18.187 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 15:57:18.194 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 15:57:18.201 +07:00 [DBG] Disposed connection to database '' on server '' (4ms).
2025-05-04 15:57:18.207 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 200 null application/json; charset=utf-8 5311.8461ms
2025-05-04 15:57:46.783 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/me - application/json 95
2025-05-04 15:57:46.788 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me'
2025-05-04 15:57:46.790 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 15:57:46.793 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 15:57:46.796 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 15:57:46.872 +07:00 [DBG] Successfully validated the token.
2025-05-04 15:57:46.883 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 15:57:46.890 +07:00 [DBG] Authorization was successful.
2025-05-04 15:57:46.894 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 15:57:46.908 +07:00 [INF] Route matched with {action = "UpdateMe", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateMe(ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 15:57:46.916 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 15:57:46.924 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 15:57:46.928 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 15:57:46.936 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 15:57:46.941 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 15:57:46.946 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 15:57:46.953 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 15:57:46.959 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' ...
2025-05-04 15:57:46.964 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' using the name '' in request data ...
2025-05-04 15:57:46.970 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 15:57:46.987 +07:00 [DBG] Connection id "0HNCAT618LRQ5", Request id "0HNCAT618LRQ5:00000005": started reading request body.
2025-05-04 15:57:46.993 +07:00 [DBG] Connection id "0HNCAT618LRQ5", Request id "0HNCAT618LRQ5:00000005": done reading request body.
2025-05-04 15:57:47.008 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'
2025-05-04 15:57:47.011 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 15:57:47.018 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 15:57:47.023 +07:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' ...
2025-05-04 15:57:47.037 +07:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 15:57:47.043 +07:00 [DBG] The request has model state errors, returning an error response.
2025-05-04 15:57:47.050 +07:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2025-05-04 15:57:47.055 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 15:57:47.061 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 15:57:47.066 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-05-04 15:57:47.076 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-05-04 15:57:47.083 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-04 15:57:47.146 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument) in 200.3103ms
2025-05-04 15:57:47.150 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 15:57:47.152 +07:00 [INF] HTTP PUT /api/Users/me responded 400 in 356.1172 ms
2025-05-04 15:57:47.156 +07:00 [DBG] Connection id "0HNCAT618LRQ5" completed keep alive response.
2025-05-04 15:57:47.162 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/me - 400 null application/problem+json; charset=utf-8 379.4641ms
2025-05-04 15:58:05.779 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/me - application/json 99
2025-05-04 15:58:05.783 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me'
2025-05-04 15:58:05.787 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 15:58:05.794 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 15:58:05.797 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 15:58:05.802 +07:00 [DBG] Successfully validated the token.
2025-05-04 15:58:05.810 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 15:58:05.817 +07:00 [DBG] Authorization was successful.
2025-05-04 15:58:05.819 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 15:58:05.823 +07:00 [INF] Route matched with {action = "UpdateMe", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateMe(ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 15:58:05.829 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 15:58:05.834 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 15:58:05.838 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 15:58:05.842 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 15:58:05.848 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 15:58:05.854 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 15:58:05.864 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 15:58:05.868 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' ...
2025-05-04 15:58:05.872 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' using the name '' in request data ...
2025-05-04 15:58:05.877 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 15:58:05.882 +07:00 [DBG] Connection id "0HNCAT618LRQ5", Request id "0HNCAT618LRQ5:00000006": started reading request body.
2025-05-04 15:58:05.885 +07:00 [DBG] Connection id "0HNCAT618LRQ5", Request id "0HNCAT618LRQ5:00000006": done reading request body.
2025-05-04 15:58:05.890 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'
2025-05-04 15:58:05.893 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 15:58:05.898 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 15:58:05.901 +07:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' ...
2025-05-04 15:58:05.907 +07:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 15:58:05.951 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 15:58:05.965 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .Include(u => u.Userprofile)
    .FirstOrDefault(u => u.UserId == __userId_0)'
2025-05-04 15:58:05.971 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-04 15:58:05.978 +07:00 [DBG] Including navigation: 'User.Userprofile'.
2025-05-04 15:58:06.018 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
                2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName, u0.userprofileId, u0.address, u0.birth, u0.userId
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            LEFT JOIN userprofiles AS u0 ON u.userId == u0.userId
            WHERE u.userId == @__userId_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
                2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName, u0.userprofileId, u0.address, u0.birth, u0.userId
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            LEFT JOIN userprofiles AS u0 ON u.userId == u0.userId
            WHERE u.userId == @__userId_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            Role entity;
            Userprofile entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<Email>k__BackingField = dataReader.GetString(2);
                                    instance.<FullName>k__BackingField = dataReader.GetString(3);
                                    instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(4);
                                    instance.<Password>k__BackingField = dataReader.GetString(5);
                                    instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                    instance.<Phone>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(8) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(8);
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(9);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                Role instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(Role);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(11) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (Role)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                            {
                                return 
                                {
                                    Role instance;
                                    instance = new Role();
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                    instance.<RoleName>k__BackingField = dataReader.GetString(12);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Role)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            entity = 
            {
                MaterializationContext materializationContext3;
                IEntityType entityType3;
                Userprofile instance3;
                InternalEntityEntry entry3;
                bool hasNullKey3;
                materializationContext3 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance3 = default(Userprofile);
                entry3 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Userprofile.UserprofileId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(13) ? default(object) : (object)dataReader.GetInt32(13) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey3);
                !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
                {
                    entityType3 = entry3.EntityType;
                    return instance3 = (Userprofile)entry3.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot3;
                    shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType3 = [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")];
                    instance3 = switch (entityType3)
                    {
                        case [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]: 
                            {
                                return 
                                {
                                    Userprofile instance;
                                    instance = new Userprofile();
                                    instance.<UserprofileId>k__BackingField = dataReader.IsDBNull(13) ? default(int) : dataReader.GetInt32(13);
                                    instance.<Address>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                    instance.<Birth>k__BackingField = dataReader.IsDBNull(15) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(15);
                                    instance.<UserId>k__BackingField = dataReader.IsDBNull(16) ? default(int) : dataReader.GetInt32(16);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext3.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Userprofile)
                    }
                    ;
                    entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType3, 
                        entity: instance3, 
                        snapshot: shadowSnapshot3);
                    return instance3;
                } : default(void);
                return instance3;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
                fixup: (namelessParameter{11}, namelessParameter{12}) => 
                {
                    namelessParameter{11}.<Role>k__BackingField = namelessParameter{12};
                    return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                        entity: namelessParameter{12}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                }, 
                trackingQuery: True);
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Userprofile>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Userprofile (Userprofile) ToDependent Userprofile Inverse: User | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Userprofile")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Userprofile.User (User) ToPrincipal User Inverse: Userprofile | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindNavigation("User")], 
                fixup: (namelessParameter{16}, namelessParameter{17}) => 
                {
                    namelessParameter{16}.<Userprofile>k__BackingField = namelessParameter{17};
                    return namelessParameter{17}.<User>k__BackingField = namelessParameter{16};
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-04 15:58:06.114 +07:00 [DBG] Creating DbConnection.
2025-05-04 15:58:06.117 +07:00 [DBG] Created DbConnection. (2ms).
2025-05-04 15:58:06.119 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 15:58:06.123 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 15:58:06.128 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 15:58:06.132 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2025-05-04 15:58:06.136 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (9ms).
2025-05-04 15:58:06.141 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 15:58:06.166 +07:00 [INF] Executed DbCommand (25ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 15:58:06.174 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 15:58:06.178 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 15:58:06.185 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 15:58:06.194 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 15:58:06.199 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 25ms reading results.
2025-05-04 15:58:06.203 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 15:58:06.207 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (4ms).
2025-05-04 15:58:06.219 +07:00 [DBG] SaveChanges starting for 'ExchangeDocumentContext'.
2025-05-04 15:58:06.229 +07:00 [DBG] DetectChanges starting for 'ExchangeDocumentContext'.
2025-05-04 15:58:06.259 +07:00 [DBG] The unchanged property 'User.FullName' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-04 15:58:06.280 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 15:58:06.292 +07:00 [DBG] The unchanged property 'User.Phone' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-04 15:58:06.306 +07:00 [DBG] The unchanged property 'User.UpdatedAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-04 15:58:06.320 +07:00 [DBG] The navigation 'User.Userprofile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 15:58:06.359 +07:00 [DBG] 'ExchangeDocumentContext' generated a temporary value for the property 'Userprofile.UserprofileId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 15:58:06.389 +07:00 [DBG] The navigation 'Userprofile.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 15:58:06.399 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Userprofile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 15:58:06.411 +07:00 [DBG] DetectChanges completed for 'ExchangeDocumentContext'.
2025-05-04 15:58:06.559 +07:00 [DBG] Executing 2 update commands as a batch.
2025-05-04 15:58:06.571 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 15:58:06.579 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 15:58:06.587 +07:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-05-04 15:58:06.607 +07:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-05-04 15:58:06.617 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 15:58:06.619 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-05-04 15:58:06.626 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (9ms).
2025-05-04 15:58:06.631 +07:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 500), @p1='?' (DbType = DateTime), @p2='?' (DbType = Int32), @p6='?' (DbType = Int32), @p3='?' (Size = 255), @p4='?' (Size = 20), @p5='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [userprofiles] ([address], [birth], [userId])
OUTPUT INSERTED.[userprofileId]
VALUES (@p0, @p1, @p2);
UPDATE [users] SET [fullName] = @p3, [phone] = @p4, [UpdatedAt] = @p5
OUTPUT 1
WHERE [userId] = @p6;
2025-05-04 15:58:06.659 +07:00 [INF] Executed DbCommand (27ms) [Parameters=[@p0='?' (Size = 500), @p1='?' (DbType = DateTime), @p2='?' (DbType = Int32), @p6='?' (DbType = Int32), @p3='?' (Size = 255), @p4='?' (Size = 20), @p5='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [userprofiles] ([address], [birth], [userId])
OUTPUT INSERTED.[userprofileId]
VALUES (@p0, @p1, @p2);
UPDATE [users] SET [fullName] = @p3, [phone] = @p4, [UpdatedAt] = @p5
OUTPUT 1
WHERE [userId] = @p6;
2025-05-04 15:58:06.697 +07:00 [DBG] The foreign key property 'Userprofile.UserprofileId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-04 15:58:06.716 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 15:58:06.720 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 51ms reading results.
2025-05-04 15:58:06.735 +07:00 [DBG] Committing transaction.
2025-05-04 15:58:06.747 +07:00 [DBG] Committed transaction.
2025-05-04 15:58:06.754 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 15:58:06.759 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (4ms).
2025-05-04 15:58:06.768 +07:00 [DBG] Disposing transaction.
2025-05-04 15:58:06.779 +07:00 [DBG] An entity of type 'Userprofile' tracked by 'ExchangeDocumentContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 15:58:06.787 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 15:58:06.798 +07:00 [DBG] SaveChanges completed for 'ExchangeDocumentContext' with 2 entities written to the database.
2025-05-04 15:58:06.803 +07:00 [INF] User 3 updated profile at "2025-05-04T08:58:06.2132606Z"
2025-05-04 15:58:06.809 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 15:58:06.818 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 15:58:06.820 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 15:58:06.823 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 15:58:06.826 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 15:58:06.831 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO'.
2025-05-04 15:58:06.859 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument) in 1005.2348ms
2025-05-04 15:58:06.864 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 15:58:06.867 +07:00 [INF] HTTP PUT /api/Users/me responded 200 in 1071.0453 ms
2025-05-04 15:58:06.872 +07:00 [DBG] Connection id "0HNCAT618LRQ5" completed keep alive response.
2025-05-04 15:58:06.874 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 15:58:06.876 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 15:58:06.881 +07:00 [DBG] Disposed connection to database '' on server '' (4ms).
2025-05-04 15:58:06.883 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/me - 200 null application/json; charset=utf-8 1103.9666ms
2025-05-04 16:00:18.699 +07:00 [DBG] Connection id "0HNCAT618LRQ5" disconnecting.
2025-05-04 16:00:18.702 +07:00 [DBG] Connection id "0HNCAT618LRQ5" stopped.
2025-05-04 16:00:18.706 +07:00 [DBG] Connection id "0HNCAT618LRQ5" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 16:10:13.477 +07:00 [DBG] Connection id "0HNCAT618LRQ7" accepted.
2025-05-04 16:10:13.480 +07:00 [DBG] Connection id "0HNCAT618LRQ7" started.
2025-05-04 16:10:13.484 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/me - application/json 99
2025-05-04 16:10:13.518 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me'
2025-05-04 16:10:13.523 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 16:10:13.533 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 16:10:13.537 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 16:10:13.540 +07:00 [DBG] Successfully validated the token.
2025-05-04 16:10:13.543 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 16:10:13.546 +07:00 [DBG] Authorization was successful.
2025-05-04 16:10:13.549 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 16:10:13.552 +07:00 [INF] Route matched with {action = "UpdateMe", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateMe(ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 16:10:13.558 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 16:10:13.561 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 16:10:13.566 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 16:10:13.571 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 16:10:13.575 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 16:10:13.580 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 16:10:13.593 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 16:10:13.598 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' ...
2025-05-04 16:10:13.601 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' using the name '' in request data ...
2025-05-04 16:10:13.606 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 16:10:13.610 +07:00 [DBG] Connection id "0HNCAT618LRQ7", Request id "0HNCAT618LRQ7:00000001": started reading request body.
2025-05-04 16:10:13.614 +07:00 [DBG] Connection id "0HNCAT618LRQ7", Request id "0HNCAT618LRQ7:00000001": done reading request body.
2025-05-04 16:10:13.617 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'
2025-05-04 16:10:13.620 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 16:10:13.624 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 16:10:13.628 +07:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' ...
2025-05-04 16:10:13.633 +07:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 16:10:13.637 +07:00 [DBG] The request has model state errors, returning an error response.
2025-05-04 16:10:13.639 +07:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2025-05-04 16:10:13.642 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 16:10:13.648 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 16:10:13.650 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-05-04 16:10:13.657 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-05-04 16:10:13.661 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-04 16:10:13.664 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument) in 84.8507ms
2025-05-04 16:10:13.669 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 16:10:13.673 +07:00 [INF] HTTP PUT /api/Users/me responded 400 in 135.6183 ms
2025-05-04 16:10:13.677 +07:00 [DBG] Connection id "0HNCAT618LRQ7" completed keep alive response.
2025-05-04 16:10:13.680 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/me - 400 null application/problem+json; charset=utf-8 196.1297ms
2025-05-04 16:10:21.795 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/me - application/json 98
2025-05-04 16:10:21.801 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me'
2025-05-04 16:10:21.803 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 16:10:21.806 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 16:10:21.834 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 16:10:21.838 +07:00 [DBG] Successfully validated the token.
2025-05-04 16:10:21.842 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 16:10:21.849 +07:00 [DBG] Authorization was successful.
2025-05-04 16:10:21.852 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 16:10:21.855 +07:00 [INF] Route matched with {action = "UpdateMe", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateMe(ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 16:10:21.861 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 16:10:21.866 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 16:10:21.872 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 16:10:21.877 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 16:10:21.883 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 16:10:21.889 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 16:10:21.893 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 16:10:21.897 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' ...
2025-05-04 16:10:21.901 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' using the name '' in request data ...
2025-05-04 16:10:21.906 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 16:10:21.910 +07:00 [DBG] Connection id "0HNCAT618LRQ7", Request id "0HNCAT618LRQ7:00000002": started reading request body.
2025-05-04 16:10:21.914 +07:00 [DBG] Connection id "0HNCAT618LRQ7", Request id "0HNCAT618LRQ7:00000002": done reading request body.
2025-05-04 16:10:21.931 +07:00 [DBG] JSON input formatter threw an exception: The JSON value could not be converted to System.Nullable`1[System.DateTime]. Path: $.birth | LineNumber: 4 | BytePositionInLine: 22.
2025-05-04 16:10:21.935 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 16:10:21.939 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 16:10:21.942 +07:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' ...
2025-05-04 16:10:21.945 +07:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 16:10:21.948 +07:00 [DBG] The request has model state errors, returning an error response.
2025-05-04 16:10:21.951 +07:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2025-05-04 16:10:21.955 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 16:10:21.961 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 16:10:21.963 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-05-04 16:10:21.972 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-05-04 16:10:21.975 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-04 16:10:21.979 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument) in 90.061ms
2025-05-04 16:10:21.982 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 16:10:21.985 +07:00 [INF] HTTP PUT /api/Users/me responded 400 in 151.5244 ms
2025-05-04 16:10:21.991 +07:00 [DBG] Connection id "0HNCAT618LRQ7" completed keep alive response.
2025-05-04 16:10:21.995 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/me - 400 null application/problem+json; charset=utf-8 199.3712ms
2025-05-04 16:10:30.978 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/me - application/json 99
2025-05-04 16:10:30.985 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me'
2025-05-04 16:10:30.987 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 16:10:30.990 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 16:10:30.993 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 16:10:31.003 +07:00 [DBG] Successfully validated the token.
2025-05-04 16:10:31.032 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 16:10:31.036 +07:00 [DBG] Authorization was successful.
2025-05-04 16:10:31.042 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 16:10:31.047 +07:00 [INF] Route matched with {action = "UpdateMe", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateMe(ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 16:10:31.053 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 16:10:31.057 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 16:10:31.062 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 16:10:31.068 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 16:10:31.072 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 16:10:31.076 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 16:10:31.081 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 16:10:31.085 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' ...
2025-05-04 16:10:31.088 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' using the name '' in request data ...
2025-05-04 16:10:31.092 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 16:10:31.098 +07:00 [DBG] Connection id "0HNCAT618LRQ7", Request id "0HNCAT618LRQ7:00000003": started reading request body.
2025-05-04 16:10:31.103 +07:00 [DBG] Connection id "0HNCAT618LRQ7", Request id "0HNCAT618LRQ7:00000003": done reading request body.
2025-05-04 16:10:31.108 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'
2025-05-04 16:10:31.111 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 16:10:31.114 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 16:10:31.119 +07:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' ...
2025-05-04 16:10:31.123 +07:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 16:10:31.285 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 16:10:31.301 +07:00 [DBG] Creating DbConnection.
2025-05-04 16:10:31.304 +07:00 [DBG] Created DbConnection. (3ms).
2025-05-04 16:10:31.307 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:10:31.320 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:10:31.324 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 16:10:31.327 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-05-04 16:10:31.331 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (7ms).
2025-05-04 16:10:31.336 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 16:10:31.366 +07:00 [INF] Executed DbCommand (30ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 16:10:31.375 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 16:10:31.381 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 16:10:31.386 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 16:10:31.394 +07:00 [DBG] The navigation 'User.Userprofile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 16:10:31.399 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Userprofile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 16:10:31.404 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:10:31.409 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 34ms reading results.
2025-05-04 16:10:31.413 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:10:31.417 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (4ms).
2025-05-04 16:10:31.421 +07:00 [DBG] SaveChanges starting for 'ExchangeDocumentContext'.
2025-05-04 16:10:31.424 +07:00 [DBG] DetectChanges starting for 'ExchangeDocumentContext'.
2025-05-04 16:10:31.430 +07:00 [DBG] The unchanged property 'User.UpdatedAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-04 16:10:31.437 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 16:10:31.450 +07:00 [DBG] DetectChanges completed for 'ExchangeDocumentContext'.
2025-05-04 16:10:31.456 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:10:31.460 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:10:31.466 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 16:10:31.469 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-05-04 16:10:31.473 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (7ms).
2025-05-04 16:10:31.477 +07:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [users] SET [UpdatedAt] = @p0
OUTPUT 1
WHERE [userId] = @p1;
2025-05-04 16:10:31.492 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [users] SET [UpdatedAt] = @p0
OUTPUT 1
WHERE [userId] = @p1;
2025-05-04 16:10:31.501 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:10:31.505 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 4ms reading results.
2025-05-04 16:10:31.510 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:10:31.514 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (4ms).
2025-05-04 16:10:31.519 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 16:10:31.525 +07:00 [DBG] SaveChanges completed for 'ExchangeDocumentContext' with 1 entities written to the database.
2025-05-04 16:10:31.528 +07:00 [INF] User 3 updated profile at "2025-05-04T09:10:31.4216977Z"
2025-05-04 16:10:31.531 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 16:10:31.537 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 16:10:31.539 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 16:10:31.542 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 16:10:31.544 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 16:10:31.549 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO'.
2025-05-04 16:10:31.553 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument) in 476.6976ms
2025-05-04 16:10:31.557 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 16:10:31.560 +07:00 [INF] HTTP PUT /api/Users/me responded 200 in 567.5040 ms
2025-05-04 16:10:31.565 +07:00 [DBG] Connection id "0HNCAT618LRQ7" completed keep alive response.
2025-05-04 16:10:31.568 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 16:10:31.572 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:10:31.576 +07:00 [DBG] Disposed connection to database '' on server '' (3ms).
2025-05-04 16:10:31.582 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/me - 200 null application/json; charset=utf-8 603.8105ms
2025-05-04 16:10:49.482 +07:00 [DBG] Connection id "0HNCAT618LRQ7" received FIN.
2025-05-04 16:10:49.485 +07:00 [DBG] Connection id "0HNCAT618LRQ7" disconnecting.
2025-05-04 16:10:49.490 +07:00 [DBG] Connection id "0HNCAT618LRQ7" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 16:10:49.506 +07:00 [DBG] Connection id "0HNCAT618LRQ7" stopped.
2025-05-04 16:13:40.458 +07:00 [INF] Application is shutting down...
2025-05-04 16:13:40.459 +07:00 [DBG] Hosting stopping
2025-05-04 16:13:40.470 +07:00 [DBG] Hosting stopped
2025-05-04 16:44:27.128 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-05-04 16:44:27.214 +07:00 [DBG] Hosting starting
2025-05-04 16:44:27.226 +07:00 [INF] User profile is available. Using 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-04 16:44:27.235 +07:00 [DBG] Reading data from file 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys\key-1a51a872-ea43-4350-815f-0422835a65dd.xml'.
2025-05-04 16:44:27.244 +07:00 [DBG] Found key {1a51a872-ea43-4350-815f-0422835a65dd}.
2025-05-04 16:44:27.252 +07:00 [DBG] Considering key {1a51a872-ea43-4350-815f-0422835a65dd} with expiration date 2025-07-05 19:31:04Z as default key.
2025-05-04 16:44:27.257 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 16:44:27.261 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-05-04 16:44:27.264 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 16:44:27.270 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-05-04 16:44:27.272 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-05-04 16:44:27.274 +07:00 [DBG] Using key {1a51a872-ea43-4350-815f-0422835a65dd} as the default key.
2025-05-04 16:44:27.277 +07:00 [DBG] Key ring with default key {1a51a872-ea43-4350-815f-0422835a65dd} was loaded during application startup.
2025-05-04 16:44:27.316 +07:00 [INF] Now listening on: http://localhost:5120
2025-05-04 16:44:27.319 +07:00 [DBG] Loaded hosting startup assembly ExchangeDocument
2025-05-04 16:44:27.321 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-04 16:44:27.322 +07:00 [INF] Hosting environment: Development
2025-05-04 16:44:27.323 +07:00 [INF] Content root path: D:\Gộp module Auth\ExchangeDocument(Tự làm Auth_User) - Đã làm logout(2)\ExchangeDocument
2025-05-04 16:44:27.324 +07:00 [DBG] Hosting started
2025-05-04 16:44:33.264 +07:00 [DBG] Connection id "0HNCAU134NTPE" accepted.
2025-05-04 16:44:33.267 +07:00 [DBG] Connection id "0HNCAU134NTPE" started.
2025-05-04 16:44:33.268 +07:00 [DBG] Connection id "0HNCAU134NTPF" accepted.
2025-05-04 16:44:33.271 +07:00 [DBG] Connection id "0HNCAU134NTPF" started.
2025-05-04 16:44:33.292 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/index.html - null null
2025-05-04 16:44:33.298 +07:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-05-04 16:44:33.315 +07:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-05-04 16:44:33.319 +07:00 [DBG] Request did not match any endpoints
2025-05-04 16:44:33.396 +07:00 [INF] HTTP GET /swagger/index.html responded 200 in 73.4485 ms
2025-05-04 16:44:33.402 +07:00 [DBG] Connection id "0HNCAU134NTPE" completed keep alive response.
2025-05-04 16:44:33.406 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/index.html - 200 null text/html;charset=utf-8 114.969ms
2025-05-04 16:44:33.834 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - null null
2025-05-04 16:44:33.841 +07:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-05-04 16:44:33.843 +07:00 [DBG] Request did not match any endpoints
2025-05-04 16:44:33.984 +07:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 139.2631 ms
2025-05-04 16:44:33.986 +07:00 [DBG] Connection id "0HNCAU134NTPE" completed keep alive response.
2025-05-04 16:44:33.988 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 153.8239ms
2025-05-04 16:44:44.925 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/me/change-password - application/json 119
2025-05-04 16:44:44.934 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me/change-password'
2025-05-04 16:44:44.940 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)' with route pattern 'api/Users/me/change-password' is valid for the request path '/api/Users/me/change-password'
2025-05-04 16:44:44.945 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)'
2025-05-04 16:44:44.948 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 16:44:44.949 +07:00 [WRN] Failed to determine the https port for redirect.
2025-05-04 16:44:44.976 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 16:44:44.981 +07:00 [DBG] Policy authentication schemes  did not succeed
2025-05-04 16:44:44.984 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-04 16:44:44.990 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-04 16:44:44.991 +07:00 [INF] HTTP PUT /api/Users/me/change-password responded 401 in 44.0904 ms
2025-05-04 16:44:44.992 +07:00 [DBG] Connection id "0HNCAU134NTPE" completed keep alive response.
2025-05-04 16:44:44.993 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/me/change-password - 401 0 null 68.5119ms
2025-05-04 16:44:44.996 +07:00 [DBG] Connection id "0HNCAU134NTPE", Request id "0HNCAU134NTPE:00000003": started reading request body.
2025-05-04 16:44:44.998 +07:00 [DBG] Connection id "0HNCAU134NTPE", Request id "0HNCAU134NTPE:00000003": done reading request body.
2025-05-04 16:45:25.701 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 63
2025-05-04 16:45:25.706 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 16:45:25.708 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 16:45:25.710 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 16:45:25.712 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 16:45:25.717 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 16:45:25.720 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 16:45:25.748 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 16:45:25.754 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 16:45:25.756 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 16:45:25.758 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 16:45:25.760 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 16:45:25.762 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 16:45:25.764 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 16:45:25.825 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-05-04 16:45:25.841 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 16:45:25.846 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 16:45:25.851 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 16:45:25.855 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 16:45:25.875 +07:00 [DBG] Connection id "0HNCAU134NTPE", Request id "0HNCAU134NTPE:00000004": started reading request body.
2025-05-04 16:45:25.877 +07:00 [DBG] Connection id "0HNCAU134NTPE", Request id "0HNCAU134NTPE:00000004": done reading request body.
2025-05-04 16:45:25.887 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 16:45:25.889 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 16:45:25.890 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 16:45:25.892 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 16:45:25.899 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 16:45:26.219 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'OrderDetail'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 16:45:26.221 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'Review'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 16:45:26.337 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 16:45:26.377 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .FirstOrDefault(u => u.Email == __email_0)'
2025-05-04 16:45:26.423 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-04 16:45:26.578 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE u.email == @__email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE u.email == @__email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            Role entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<Email>k__BackingField = dataReader.GetString(2);
                                    instance.<FullName>k__BackingField = dataReader.GetString(3);
                                    instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(4);
                                    instance.<Password>k__BackingField = dataReader.GetString(5);
                                    instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                    instance.<Phone>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(8) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(8);
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(9);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                Role instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(Role);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(11) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (Role)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                            {
                                return 
                                {
                                    Role instance;
                                    instance = new Role();
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                    instance.<RoleName>k__BackingField = dataReader.GetString(12);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Role)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
                fixup: (namelessParameter{8}, namelessParameter{9}) => 
                {
                    namelessParameter{8}.<Role>k__BackingField = namelessParameter{9};
                    return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                        entity: namelessParameter{9}, 
                        value: namelessParameter{8}, 
                        forMaterialization: True);
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-04 16:45:26.631 +07:00 [DBG] Creating DbConnection.
2025-05-04 16:45:26.644 +07:00 [DBG] Created DbConnection. (12ms).
2025-05-04 16:45:26.650 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:45:26.751 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:45:26.754 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 16:45:26.759 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-05-04 16:45:26.766 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (12ms).
2025-05-04 16:45:26.772 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 16:45:26.807 +07:00 [INF] Executed DbCommand (36ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 16:45:26.821 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:45:26.827 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 13ms reading results.
2025-05-04 16:45:26.832 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:45:26.839 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (7ms).
2025-05-04 16:45:26.842 +07:00 [WRN] Login failed: user nguyetkhuyen@gmail.com not found
2025-05-04 16:45:26.845 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 16:45:26.850 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 16:45:26.851 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 16:45:26.853 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 16:45:26.854 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 16:45:26.856 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType4`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 16:45:26.873 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 1108.0457ms
2025-05-04 16:45:26.875 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 16:45:26.878 +07:00 [INF] HTTP POST /api/Auth/login responded 400 in 1165.6029 ms
2025-05-04 16:45:26.880 +07:00 [DBG] Connection id "0HNCAU134NTPE" completed keep alive response.
2025-05-04 16:45:26.883 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 16:45:26.889 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:45:26.892 +07:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-05-04 16:45:26.893 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 400 null application/json; charset=utf-8 1192.2758ms
2025-05-04 16:45:37.587 +07:00 [DBG] Connection id "0HNCAU134NTPF" received FIN.
2025-05-04 16:45:37.587 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 64
2025-05-04 16:45:37.590 +07:00 [DBG] Connection id "0HNCAU134NTPF" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 16:45:37.593 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 16:45:37.594 +07:00 [DBG] Connection id "0HNCAU134NTPF" disconnecting.
2025-05-04 16:45:37.595 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 16:45:37.597 +07:00 [DBG] Connection id "0HNCAU134NTPF" stopped.
2025-05-04 16:45:37.617 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 16:45:37.620 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 16:45:37.621 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 16:45:37.625 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 16:45:37.631 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 16:45:37.636 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 16:45:37.638 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 16:45:37.639 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 16:45:37.640 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 16:45:37.641 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 16:45:37.642 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 16:45:37.645 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 16:45:37.646 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 16:45:37.647 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 16:45:37.649 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 16:45:37.651 +07:00 [DBG] Connection id "0HNCAU134NTPE", Request id "0HNCAU134NTPE:00000005": started reading request body.
2025-05-04 16:45:37.652 +07:00 [DBG] Connection id "0HNCAU134NTPE", Request id "0HNCAU134NTPE:00000005": done reading request body.
2025-05-04 16:45:37.653 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 16:45:37.654 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 16:45:37.655 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 16:45:37.656 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 16:45:37.657 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 16:45:37.667 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 16:45:37.671 +07:00 [DBG] Creating DbConnection.
2025-05-04 16:45:37.672 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 16:45:37.672 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:45:37.673 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:45:37.674 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 16:45:37.675 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 16:45:37.676 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 16:45:37.677 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 16:45:37.685 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 16:45:37.708 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 16:45:37.741 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 16:45:37.749 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 16:45:37.753 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:45:37.754 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 67ms reading results.
2025-05-04 16:45:37.756 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:45:37.757 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 16:45:37.985 +07:00 [INF] User nguyetnkhuyen@gmail.com logged in successfully
2025-05-04 16:45:37.987 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 16:45:37.989 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 16:45:37.990 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 16:45:37.991 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 16:45:37.991 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 16:45:37.993 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType6`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 16:45:37.996 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 354.2401ms
2025-05-04 16:45:37.998 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 16:45:37.999 +07:00 [INF] HTTP POST /api/Auth/login responded 200 in 379.7165 ms
2025-05-04 16:45:38.002 +07:00 [DBG] Connection id "0HNCAU134NTPE" completed keep alive response.
2025-05-04 16:45:38.003 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 16:45:38.004 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:45:38.005 +07:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-05-04 16:45:38.006 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 200 null application/json; charset=utf-8 418.7414ms
2025-05-04 16:46:04.923 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/me/change-password - application/json 119
2025-05-04 16:46:04.926 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me/change-password'
2025-05-04 16:46:04.927 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)' with route pattern 'api/Users/me/change-password' is valid for the request path '/api/Users/me/change-password'
2025-05-04 16:46:04.930 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)'
2025-05-04 16:46:04.931 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 16:46:04.965 +07:00 [DBG] Successfully validated the token.
2025-05-04 16:46:04.970 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 16:46:04.972 +07:00 [DBG] Authorization was successful.
2025-05-04 16:46:04.972 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)'
2025-05-04 16:46:04.980 +07:00 [INF] Route matched with {action = "ChangePassword", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ChangePassword(ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 16:46:04.982 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 16:46:04.983 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 16:46:04.984 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 16:46:04.986 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 16:46:04.987 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 16:46:04.988 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 16:46:04.993 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 16:46:04.994 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO' ...
2025-05-04 16:46:04.995 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO' using the name '' in request data ...
2025-05-04 16:46:04.997 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 16:46:04.999 +07:00 [DBG] Connection id "0HNCAU134NTPE", Request id "0HNCAU134NTPE:00000006": started reading request body.
2025-05-04 16:46:05.000 +07:00 [DBG] Connection id "0HNCAU134NTPE", Request id "0HNCAU134NTPE:00000006": done reading request body.
2025-05-04 16:46:05.002 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'
2025-05-04 16:46:05.003 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'.
2025-05-04 16:46:05.004 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'.
2025-05-04 16:46:05.005 +07:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO' ...
2025-05-04 16:46:05.013 +07:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'.
2025-05-04 16:46:05.014 +07:00 [DBG] The request has model state errors, returning an error response.
2025-05-04 16:46:05.016 +07:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2025-05-04 16:46:05.017 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 16:46:05.020 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 16:46:05.021 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-05-04 16:46:05.025 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-05-04 16:46:05.028 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-04 16:46:05.047 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument) in 58.8584ms
2025-05-04 16:46:05.049 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)'
2025-05-04 16:46:05.050 +07:00 [INF] HTTP PUT /api/Users/me/change-password responded 400 in 118.4809 ms
2025-05-04 16:46:05.051 +07:00 [DBG] Connection id "0HNCAU134NTPE" completed keep alive response.
2025-05-04 16:46:05.053 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/me/change-password - 400 null application/problem+json; charset=utf-8 129.6568ms
2025-05-04 16:46:31.641 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/me/change-password - application/json 91
2025-05-04 16:46:31.645 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me/change-password'
2025-05-04 16:46:31.646 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)' with route pattern 'api/Users/me/change-password' is valid for the request path '/api/Users/me/change-password'
2025-05-04 16:46:31.648 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)'
2025-05-04 16:46:31.650 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 16:46:31.651 +07:00 [DBG] Successfully validated the token.
2025-05-04 16:46:31.655 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 16:46:31.660 +07:00 [DBG] Authorization was successful.
2025-05-04 16:46:31.662 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)'
2025-05-04 16:46:31.664 +07:00 [INF] Route matched with {action = "ChangePassword", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ChangePassword(ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 16:46:31.667 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 16:46:31.668 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 16:46:31.670 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 16:46:31.673 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 16:46:31.675 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 16:46:31.677 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 16:46:31.679 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 16:46:31.680 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO' ...
2025-05-04 16:46:31.682 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO' using the name '' in request data ...
2025-05-04 16:46:31.683 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 16:46:31.684 +07:00 [DBG] Connection id "0HNCAU134NTPE", Request id "0HNCAU134NTPE:00000007": started reading request body.
2025-05-04 16:46:31.685 +07:00 [DBG] Connection id "0HNCAU134NTPE", Request id "0HNCAU134NTPE:00000007": done reading request body.
2025-05-04 16:46:31.688 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'
2025-05-04 16:46:31.689 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'.
2025-05-04 16:46:31.691 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'.
2025-05-04 16:46:31.693 +07:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO' ...
2025-05-04 16:46:31.694 +07:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'.
2025-05-04 16:46:31.695 +07:00 [DBG] The request has model state errors, returning an error response.
2025-05-04 16:46:31.696 +07:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2025-05-04 16:46:31.697 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 16:46:31.699 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 16:46:31.700 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-05-04 16:46:31.702 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-05-04 16:46:31.703 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-04 16:46:31.705 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument) in 28.1097ms
2025-05-04 16:46:31.707 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)'
2025-05-04 16:46:31.708 +07:00 [INF] HTTP PUT /api/Users/me/change-password responded 400 in 58.6888 ms
2025-05-04 16:46:31.710 +07:00 [DBG] Connection id "0HNCAU134NTPE" completed keep alive response.
2025-05-04 16:46:31.711 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/me/change-password - 400 null application/problem+json; charset=utf-8 70.8673ms
2025-05-04 16:46:59.458 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/me/change-password - application/json 99
2025-05-04 16:46:59.463 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me/change-password'
2025-05-04 16:46:59.465 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)' with route pattern 'api/Users/me/change-password' is valid for the request path '/api/Users/me/change-password'
2025-05-04 16:46:59.467 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)'
2025-05-04 16:46:59.468 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 16:46:59.470 +07:00 [DBG] Successfully validated the token.
2025-05-04 16:46:59.471 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 16:46:59.472 +07:00 [DBG] Authorization was successful.
2025-05-04 16:46:59.472 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)'
2025-05-04 16:46:59.474 +07:00 [INF] Route matched with {action = "ChangePassword", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ChangePassword(ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 16:46:59.478 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 16:46:59.480 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 16:46:59.482 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 16:46:59.486 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 16:46:59.489 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 16:46:59.490 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 16:46:59.495 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 16:46:59.497 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO' ...
2025-05-04 16:46:59.498 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO' using the name '' in request data ...
2025-05-04 16:46:59.501 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 16:46:59.503 +07:00 [DBG] Connection id "0HNCAU134NTPE", Request id "0HNCAU134NTPE:00000008": started reading request body.
2025-05-04 16:46:59.505 +07:00 [DBG] Connection id "0HNCAU134NTPE", Request id "0HNCAU134NTPE:00000008": done reading request body.
2025-05-04 16:46:59.507 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'
2025-05-04 16:46:59.509 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'.
2025-05-04 16:46:59.510 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'.
2025-05-04 16:46:59.511 +07:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO' ...
2025-05-04 16:46:59.512 +07:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'.
2025-05-04 16:46:59.513 +07:00 [DBG] The request has model state errors, returning an error response.
2025-05-04 16:46:59.514 +07:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2025-05-04 16:46:59.516 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 16:46:59.518 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 16:46:59.519 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-05-04 16:46:59.520 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-05-04 16:46:59.521 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-04 16:46:59.524 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument) in 33.4058ms
2025-05-04 16:46:59.525 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)'
2025-05-04 16:46:59.526 +07:00 [INF] HTTP PUT /api/Users/me/change-password responded 400 in 57.4596 ms
2025-05-04 16:46:59.527 +07:00 [DBG] Connection id "0HNCAU134NTPE" completed keep alive response.
2025-05-04 16:46:59.528 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/me/change-password - 400 null application/problem+json; charset=utf-8 69.4957ms
2025-05-04 16:47:07.816 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/me/change-password - application/json 101
2025-05-04 16:47:07.819 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me/change-password'
2025-05-04 16:47:07.821 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)' with route pattern 'api/Users/me/change-password' is valid for the request path '/api/Users/me/change-password'
2025-05-04 16:47:07.823 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)'
2025-05-04 16:47:07.825 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 16:47:07.832 +07:00 [DBG] Successfully validated the token.
2025-05-04 16:47:07.834 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 16:47:07.858 +07:00 [DBG] Authorization was successful.
2025-05-04 16:47:07.859 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)'
2025-05-04 16:47:07.861 +07:00 [INF] Route matched with {action = "ChangePassword", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ChangePassword(ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 16:47:07.865 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 16:47:07.870 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 16:47:07.873 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 16:47:07.875 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 16:47:07.878 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 16:47:07.880 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 16:47:07.882 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 16:47:07.884 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO' ...
2025-05-04 16:47:07.886 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO' using the name '' in request data ...
2025-05-04 16:47:07.888 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 16:47:07.890 +07:00 [DBG] Connection id "0HNCAU134NTPE", Request id "0HNCAU134NTPE:00000009": started reading request body.
2025-05-04 16:47:07.892 +07:00 [DBG] Connection id "0HNCAU134NTPE", Request id "0HNCAU134NTPE:00000009": done reading request body.
2025-05-04 16:47:07.893 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'
2025-05-04 16:47:07.894 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'.
2025-05-04 16:47:07.895 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'.
2025-05-04 16:47:07.897 +07:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO' ...
2025-05-04 16:47:07.899 +07:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'.
2025-05-04 16:47:07.946 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 16:47:07.951 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .Include(u => u.Userprofile)
    .FirstOrDefault(u => u.UserId == __userId_0)'
2025-05-04 16:47:07.954 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-04 16:47:07.956 +07:00 [DBG] Including navigation: 'User.Userprofile'.
2025-05-04 16:47:07.969 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
                2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName, u0.userprofileId, u0.address, u0.birth, u0.userId
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            LEFT JOIN userprofiles AS u0 ON u.userId == u0.userId
            WHERE u.userId == @__userId_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
                2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName, u0.userprofileId, u0.address, u0.birth, u0.userId
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            LEFT JOIN userprofiles AS u0 ON u.userId == u0.userId
            WHERE u.userId == @__userId_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            Role entity;
            Userprofile entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<Email>k__BackingField = dataReader.GetString(2);
                                    instance.<FullName>k__BackingField = dataReader.GetString(3);
                                    instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(4);
                                    instance.<Password>k__BackingField = dataReader.GetString(5);
                                    instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                    instance.<Phone>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(8) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(8);
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(9);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                Role instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(Role);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(11) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (Role)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                            {
                                return 
                                {
                                    Role instance;
                                    instance = new Role();
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                    instance.<RoleName>k__BackingField = dataReader.GetString(12);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Role)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            entity = 
            {
                MaterializationContext materializationContext3;
                IEntityType entityType3;
                Userprofile instance3;
                InternalEntityEntry entry3;
                bool hasNullKey3;
                materializationContext3 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance3 = default(Userprofile);
                entry3 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Userprofile.UserprofileId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(13) ? default(object) : (object)dataReader.GetInt32(13) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey3);
                !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
                {
                    entityType3 = entry3.EntityType;
                    return instance3 = (Userprofile)entry3.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot3;
                    shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType3 = [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")];
                    instance3 = switch (entityType3)
                    {
                        case [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]: 
                            {
                                return 
                                {
                                    Userprofile instance;
                                    instance = new Userprofile();
                                    instance.<UserprofileId>k__BackingField = dataReader.IsDBNull(13) ? default(int) : dataReader.GetInt32(13);
                                    instance.<Address>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                    instance.<Birth>k__BackingField = dataReader.IsDBNull(15) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(15);
                                    instance.<UserId>k__BackingField = dataReader.IsDBNull(16) ? default(int) : dataReader.GetInt32(16);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext3.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Userprofile)
                    }
                    ;
                    entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType3, 
                        entity: instance3, 
                        snapshot: shadowSnapshot3);
                    return instance3;
                } : default(void);
                return instance3;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
                fixup: (namelessParameter{11}, namelessParameter{12}) => 
                {
                    namelessParameter{11}.<Role>k__BackingField = namelessParameter{12};
                    return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                        entity: namelessParameter{12}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                }, 
                trackingQuery: True);
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Userprofile>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Userprofile (Userprofile) ToDependent Userprofile Inverse: User | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Userprofile")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Userprofile.User (User) ToPrincipal User Inverse: Userprofile | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindNavigation("User")], 
                fixup: (namelessParameter{16}, namelessParameter{17}) => 
                {
                    namelessParameter{16}.<Userprofile>k__BackingField = namelessParameter{17};
                    return namelessParameter{17}.<User>k__BackingField = namelessParameter{16};
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-04 16:47:07.998 +07:00 [DBG] Creating DbConnection.
2025-05-04 16:47:08.000 +07:00 [DBG] Created DbConnection. (1ms).
2025-05-04 16:47:08.002 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:47:08.003 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:47:08.005 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 16:47:08.005 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 16:47:08.006 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 16:47:08.008 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 16:47:08.013 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 16:47:08.017 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 16:47:08.018 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 16:47:08.020 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 16:47:08.028 +07:00 [DBG] The navigation 'User.Userprofile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 16:47:08.029 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Userprofile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 16:47:08.034 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:47:08.037 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 20ms reading results.
2025-05-04 16:47:08.040 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:47:08.042 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 16:47:08.478 +07:00 [DBG] SaveChanges starting for 'ExchangeDocumentContext'.
2025-05-04 16:47:08.481 +07:00 [DBG] DetectChanges starting for 'ExchangeDocumentContext'.
2025-05-04 16:47:08.490 +07:00 [DBG] The unchanged property 'User.Password' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-04 16:47:08.495 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 16:47:08.503 +07:00 [DBG] The unchanged property 'User.UpdatedAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-04 16:47:08.510 +07:00 [DBG] DetectChanges completed for 'ExchangeDocumentContext'.
2025-05-04 16:47:08.552 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:47:08.554 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:47:08.556 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 16:47:08.557 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 16:47:08.559 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 16:47:08.560 +07:00 [DBG] Executing DbCommand [Parameters=[@p2='?' (DbType = Int32), @p0='?' (Size = 255), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [users] SET [password] = @p0, [UpdatedAt] = @p1
OUTPUT 1
WHERE [userId] = @p2;
2025-05-04 16:47:08.569 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (Size = 255), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [users] SET [password] = @p0, [UpdatedAt] = @p1
OUTPUT 1
WHERE [userId] = @p2;
2025-05-04 16:47:08.576 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:47:08.577 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 4ms reading results.
2025-05-04 16:47:08.580 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:47:08.581 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 16:47:08.587 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 16:47:08.591 +07:00 [DBG] SaveChanges completed for 'ExchangeDocumentContext' with 1 entities written to the database.
2025-05-04 16:47:08.593 +07:00 [INF] User 3 changed password at "2025-05-04T09:47:08.4765206Z"
2025-05-04 16:47:08.594 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 16:47:08.597 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 16:47:08.598 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 16:47:08.600 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 16:47:08.603 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 16:47:08.604 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 16:47:08.607 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument) in 726.5155ms
2025-05-04 16:47:08.609 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)'
2025-05-04 16:47:08.610 +07:00 [INF] HTTP PUT /api/Users/me/change-password responded 200 in 785.3863 ms
2025-05-04 16:47:08.611 +07:00 [DBG] Connection id "0HNCAU134NTPE" completed keep alive response.
2025-05-04 16:47:08.612 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 16:47:08.613 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:47:08.615 +07:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-05-04 16:47:08.618 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/me/change-password - 200 null application/json; charset=utf-8 802.2658ms
2025-05-04 16:49:19.463 +07:00 [DBG] Connection id "0HNCAU134NTPE" disconnecting.
2025-05-04 16:49:19.470 +07:00 [DBG] Connection id "0HNCAU134NTPE" stopped.
2025-05-04 16:49:19.472 +07:00 [DBG] Connection id "0HNCAU134NTPE" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 16:52:52.712 +07:00 [DBG] Connection id "0HNCAU134NTPG" accepted.
2025-05-04 16:52:52.715 +07:00 [DBG] Connection id "0HNCAU134NTPG" started.
2025-05-04 16:52:52.716 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 64
2025-05-04 16:52:52.719 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 16:52:52.720 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 16:52:52.722 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 16:52:52.724 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 16:52:52.729 +07:00 [DBG] Successfully validated the token.
2025-05-04 16:52:52.730 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 16:52:52.731 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 16:52:52.734 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 16:52:52.739 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 16:52:52.742 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 16:52:52.746 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 16:52:52.748 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 16:52:52.749 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 16:52:52.750 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 16:52:52.752 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 16:52:52.753 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 16:52:52.755 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 16:52:52.756 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 16:52:52.757 +07:00 [DBG] Connection id "0HNCAU134NTPG", Request id "0HNCAU134NTPG:00000001": started reading request body.
2025-05-04 16:52:52.759 +07:00 [DBG] Connection id "0HNCAU134NTPG", Request id "0HNCAU134NTPG:00000001": done reading request body.
2025-05-04 16:52:52.760 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 16:52:52.760 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 16:52:52.761 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 16:52:52.762 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 16:52:52.763 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 16:52:52.764 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 16:52:52.766 +07:00 [DBG] Creating DbConnection.
2025-05-04 16:52:52.767 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 16:52:52.767 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:52:52.772 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:52:52.773 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 16:52:52.774 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 16:52:52.775 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 16:52:52.776 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 16:52:52.781 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 16:52:52.783 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 16:52:52.784 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 16:52:52.784 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 16:52:52.785 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:52:52.786 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 3ms reading results.
2025-05-04 16:52:52.788 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:52:52.789 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 16:52:52.930 +07:00 [WRN] Login failed: invalid password for nguyetnkhuyen@gmail.com
2025-05-04 16:52:52.933 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 16:52:52.934 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 16:52:52.935 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 16:52:52.936 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 16:52:52.936 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 16:52:52.938 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType4`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 16:52:52.939 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 189.4594ms
2025-05-04 16:52:52.942 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 16:52:52.943 +07:00 [INF] HTTP POST /api/Auth/login responded 400 in 219.4199 ms
2025-05-04 16:52:52.944 +07:00 [DBG] Connection id "0HNCAU134NTPG" completed keep alive response.
2025-05-04 16:52:52.945 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 16:52:52.946 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:52:52.947 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 16:52:52.948 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 400 null application/json; charset=utf-8 231.9289ms
2025-05-04 16:53:40.759 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 71
2025-05-04 16:53:40.763 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 16:53:40.764 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 16:53:40.766 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 16:53:40.768 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 16:53:40.770 +07:00 [DBG] Successfully validated the token.
2025-05-04 16:53:40.771 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 16:53:40.772 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 16:53:40.792 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 16:53:40.805 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 16:53:40.807 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 16:53:40.808 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 16:53:40.809 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 16:53:40.811 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 16:53:40.812 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 16:53:40.813 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 16:53:40.817 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 16:53:40.819 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 16:53:40.821 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 16:53:40.822 +07:00 [DBG] Connection id "0HNCAU134NTPG", Request id "0HNCAU134NTPG:00000002": started reading request body.
2025-05-04 16:53:40.823 +07:00 [DBG] Connection id "0HNCAU134NTPG", Request id "0HNCAU134NTPG:00000002": done reading request body.
2025-05-04 16:53:40.824 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 16:53:40.825 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 16:53:40.826 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 16:53:40.827 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 16:53:40.827 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 16:53:40.829 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 16:53:40.831 +07:00 [DBG] Creating DbConnection.
2025-05-04 16:53:40.832 +07:00 [DBG] Created DbConnection. (1ms).
2025-05-04 16:53:40.833 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:53:40.834 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:53:40.835 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 16:53:40.836 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 16:53:40.837 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 16:53:40.837 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 16:53:40.842 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 16:53:40.844 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 16:53:40.845 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 16:53:40.846 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 16:53:40.847 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:53:40.849 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 4ms reading results.
2025-05-04 16:53:40.850 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:53:40.851 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (0ms).
2025-05-04 16:53:40.990 +07:00 [INF] User nguyetnkhuyen@gmail.com logged in successfully
2025-05-04 16:53:40.992 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 16:53:40.994 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 16:53:40.994 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 16:53:40.995 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 16:53:40.996 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 16:53:40.997 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType6`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 16:53:40.999 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 187.0671ms
2025-05-04 16:53:41.001 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 16:53:41.002 +07:00 [INF] HTTP POST /api/Auth/login responded 200 in 233.9949 ms
2025-05-04 16:53:41.004 +07:00 [DBG] Connection id "0HNCAU134NTPG" completed keep alive response.
2025-05-04 16:53:41.005 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 16:53:41.006 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 16:53:41.007 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 16:53:41.008 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 200 null application/json; charset=utf-8 248.8509ms
2025-05-04 16:55:52.115 +07:00 [DBG] Connection id "0HNCAU134NTPG" disconnecting.
2025-05-04 16:55:52.117 +07:00 [DBG] Connection id "0HNCAU134NTPG" stopped.
2025-05-04 16:55:52.119 +07:00 [DBG] Connection id "0HNCAU134NTPG" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 17:05:12.702 +07:00 [INF] Application is shutting down...
2025-05-04 17:05:12.703 +07:00 [DBG] Hosting stopping
2025-05-04 17:05:12.709 +07:00 [DBG] Hosting stopped
2025-05-04 18:35:08.534 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-05-04 18:35:08.890 +07:00 [DBG] Hosting starting
2025-05-04 18:35:08.902 +07:00 [INF] User profile is available. Using 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-04 18:35:08.920 +07:00 [DBG] Reading data from file 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys\key-1a51a872-ea43-4350-815f-0422835a65dd.xml'.
2025-05-04 18:35:08.929 +07:00 [DBG] Found key {1a51a872-ea43-4350-815f-0422835a65dd}.
2025-05-04 18:35:08.943 +07:00 [DBG] Considering key {1a51a872-ea43-4350-815f-0422835a65dd} with expiration date 2025-07-05 19:31:04Z as default key.
2025-05-04 18:35:08.954 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 18:35:08.963 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-05-04 18:35:08.968 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 18:35:08.979 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-05-04 18:35:08.985 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-05-04 18:35:08.993 +07:00 [DBG] Using key {1a51a872-ea43-4350-815f-0422835a65dd} as the default key.
2025-05-04 18:35:08.998 +07:00 [DBG] Key ring with default key {1a51a872-ea43-4350-815f-0422835a65dd} was loaded during application startup.
2025-05-04 18:35:09.047 +07:00 [INF] Now listening on: http://localhost:5120
2025-05-04 18:35:09.050 +07:00 [DBG] Loaded hosting startup assembly ExchangeDocument
2025-05-04 18:35:09.052 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-04 18:35:09.056 +07:00 [INF] Hosting environment: Development
2025-05-04 18:35:09.060 +07:00 [INF] Content root path: D:\Gộp module Auth\ExchangeDocument(Tự làm Auth_User) - Đã làm logout(2)\ExchangeDocument
2025-05-04 18:35:09.065 +07:00 [DBG] Hosting started
2025-05-04 18:35:14.186 +07:00 [DBG] Connection id "0HNCAVUU9FUB4" accepted.
2025-05-04 18:35:14.192 +07:00 [DBG] Connection id "0HNCAVUU9FUB4" started.
2025-05-04 18:35:14.193 +07:00 [DBG] Connection id "0HNCAVUU9FUB5" accepted.
2025-05-04 18:35:14.200 +07:00 [DBG] Connection id "0HNCAVUU9FUB5" started.
2025-05-04 18:35:14.257 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/index.html - null null
2025-05-04 18:35:14.264 +07:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-05-04 18:35:14.289 +07:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-05-04 18:35:14.293 +07:00 [DBG] Request did not match any endpoints
2025-05-04 18:35:14.418 +07:00 [INF] HTTP GET /swagger/index.html responded 200 in 119.3677 ms
2025-05-04 18:35:14.425 +07:00 [DBG] Connection id "0HNCAVUU9FUB4" completed keep alive response.
2025-05-04 18:35:14.434 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/index.html - 200 null text/html;charset=utf-8 178.3075ms
2025-05-04 18:35:15.570 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - null null
2025-05-04 18:35:15.583 +07:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-05-04 18:35:15.587 +07:00 [DBG] Request did not match any endpoints
2025-05-04 18:35:15.927 +07:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 337.1991 ms
2025-05-04 18:35:15.932 +07:00 [DBG] Connection id "0HNCAVUU9FUB4" completed keep alive response.
2025-05-04 18:35:15.935 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 364.6132ms
2025-05-04 18:35:47.156 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=2 - null null
2025-05-04 18:35:47.165 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users'
2025-05-04 18:35:47.180 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)' with route pattern 'api/Users' is valid for the request path '/api/Users'
2025-05-04 18:35:47.189 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 18:35:47.202 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 18:35:47.208 +07:00 [WRN] Failed to determine the https port for redirect.
2025-05-04 18:35:49.505 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 18:35:49.515 +07:00 [DBG] Policy authentication schemes  did not succeed
2025-05-04 18:35:49.525 +07:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-05-04 18:35:49.541 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-04 18:35:49.545 +07:00 [INF] HTTP GET /api/Users responded 401 in 2346.0029 ms
2025-05-04 18:35:49.551 +07:00 [DBG] Connection id "0HNCAVUU9FUB4" completed keep alive response.
2025-05-04 18:35:49.553 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=2 - 401 0 null 2397.3059ms
2025-05-04 18:36:28.766 +07:00 [DBG] Connection id "0HNCAVUU9FUB5" received FIN.
2025-05-04 18:36:28.771 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 64
2025-05-04 18:36:28.771 +07:00 [DBG] Connection id "0HNCAVUU9FUB5" disconnecting.
2025-05-04 18:36:28.779 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 18:36:28.783 +07:00 [DBG] Connection id "0HNCAVUU9FUB5" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 18:36:28.785 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 18:36:28.798 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 18:36:28.798 +07:00 [DBG] Connection id "0HNCAVUU9FUB5" stopped.
2025-05-04 18:36:28.801 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 18:36:28.815 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 18:36:28.825 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 18:36:28.902 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 18:36:28.913 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 18:36:28.917 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 18:36:28.921 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 18:36:28.927 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 18:36:28.931 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 18:36:28.941 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 18:36:29.516 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-05-04 18:36:29.581 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 18:36:29.597 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 18:36:29.605 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 18:36:29.614 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 18:36:29.661 +07:00 [DBG] Connection id "0HNCAVUU9FUB4", Request id "0HNCAVUU9FUB4:00000004": started reading request body.
2025-05-04 18:36:29.665 +07:00 [DBG] Connection id "0HNCAVUU9FUB4", Request id "0HNCAVUU9FUB4:00000004": done reading request body.
2025-05-04 18:36:29.696 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 18:36:29.701 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 18:36:29.704 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 18:36:29.709 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 18:36:29.725 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 18:36:31.079 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'OrderDetail'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 18:36:31.086 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'Review'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 18:36:31.456 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 18:36:31.962 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .FirstOrDefault(u => u.Email == __email_0)'
2025-05-04 18:36:32.109 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-04 18:36:32.676 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE u.email == @__email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE u.email == @__email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            Role entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<Email>k__BackingField = dataReader.GetString(2);
                                    instance.<FullName>k__BackingField = dataReader.GetString(3);
                                    instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(4);
                                    instance.<Password>k__BackingField = dataReader.GetString(5);
                                    instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                    instance.<Phone>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(8) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(8);
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(9);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                Role instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(Role);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(11) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (Role)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                            {
                                return 
                                {
                                    Role instance;
                                    instance = new Role();
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                    instance.<RoleName>k__BackingField = dataReader.GetString(12);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Role)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
                fixup: (namelessParameter{8}, namelessParameter{9}) => 
                {
                    namelessParameter{8}.<Role>k__BackingField = namelessParameter{9};
                    return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                        entity: namelessParameter{9}, 
                        value: namelessParameter{8}, 
                        forMaterialization: True);
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-04 18:36:32.831 +07:00 [DBG] Creating DbConnection.
2025-05-04 18:36:32.881 +07:00 [DBG] Created DbConnection. (46ms).
2025-05-04 18:36:32.891 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:36:33.870 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:36:33.883 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 18:36:33.904 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (11ms).
2025-05-04 18:36:33.924 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (40ms).
2025-05-04 18:36:33.947 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 18:36:34.108 +07:00 [INF] Executed DbCommand (167ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 18:36:34.198 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:36:34.309 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:36:34.326 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:36:34.356 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:36:34.378 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 250ms reading results.
2025-05-04 18:36:34.395 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:36:34.413 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (16ms).
2025-05-04 18:36:35.365 +07:00 [WRN] Login failed: invalid password for nguyetnkhuyen@gmail.com
2025-05-04 18:36:35.378 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 18:36:35.388 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 18:36:35.391 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 18:36:35.395 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 18:36:35.400 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 18:36:35.408 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType4`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 18:36:35.455 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 6511.3538ms
2025-05-04 18:36:35.462 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 18:36:35.472 +07:00 [INF] HTTP POST /api/Auth/login responded 400 in 6670.5639 ms
2025-05-04 18:36:35.478 +07:00 [DBG] Connection id "0HNCAVUU9FUB4" completed keep alive response.
2025-05-04 18:36:35.486 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 18:36:35.498 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:36:35.504 +07:00 [DBG] Disposed connection to database '' on server '' (5ms).
2025-05-04 18:36:35.509 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 400 null application/json; charset=utf-8 6738.2966ms
2025-05-04 18:36:52.993 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 69
2025-05-04 18:36:53.002 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 18:36:53.008 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 18:36:53.016 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 18:36:53.021 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 18:36:53.028 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 18:36:53.031 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 18:36:53.038 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 18:36:53.047 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 18:36:53.054 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 18:36:53.060 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 18:36:53.067 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 18:36:53.073 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 18:36:53.078 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 18:36:53.088 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 18:36:53.096 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 18:36:53.102 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 18:36:53.108 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 18:36:53.114 +07:00 [DBG] Connection id "0HNCAVUU9FUB4", Request id "0HNCAVUU9FUB4:00000005": started reading request body.
2025-05-04 18:36:53.118 +07:00 [DBG] Connection id "0HNCAVUU9FUB4", Request id "0HNCAVUU9FUB4:00000005": done reading request body.
2025-05-04 18:36:53.123 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 18:36:53.126 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 18:36:53.130 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 18:36:53.136 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 18:36:53.142 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 18:36:53.178 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 18:36:53.196 +07:00 [DBG] Creating DbConnection.
2025-05-04 18:36:53.199 +07:00 [DBG] Created DbConnection. (2ms).
2025-05-04 18:36:53.203 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:36:53.211 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:36:53.214 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 18:36:53.219 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2025-05-04 18:36:53.225 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (10ms).
2025-05-04 18:36:53.229 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 18:36:53.251 +07:00 [INF] Executed DbCommand (22ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 18:36:53.262 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:36:53.271 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:36:53.276 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:36:53.281 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:36:53.285 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 23ms reading results.
2025-05-04 18:36:53.292 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:36:53.298 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (6ms).
2025-05-04 18:36:53.902 +07:00 [WRN] Login failed: invalid password for nguyetnkhuyen@gmail.com
2025-05-04 18:36:53.909 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 18:36:53.918 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 18:36:53.921 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 18:36:53.925 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 18:36:53.928 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 18:36:53.935 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType4`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 18:36:53.941 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 863.1082ms
2025-05-04 18:36:53.946 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 18:36:53.950 +07:00 [INF] HTTP POST /api/Auth/login responded 400 in 928.6916 ms
2025-05-04 18:36:53.956 +07:00 [DBG] Connection id "0HNCAVUU9FUB4" completed keep alive response.
2025-05-04 18:36:53.960 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 18:36:53.963 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:36:53.968 +07:00 [DBG] Disposed connection to database '' on server '' (5ms).
2025-05-04 18:36:53.973 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 400 null application/json; charset=utf-8 979.5163ms
2025-05-04 18:37:04.724 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 71
2025-05-04 18:37:04.731 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 18:37:04.736 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 18:37:04.777 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 18:37:04.781 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 18:37:04.792 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 18:37:04.795 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 18:37:04.798 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 18:37:04.806 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 18:37:04.811 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 18:37:04.815 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 18:37:04.822 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 18:37:04.826 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 18:37:04.831 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 18:37:04.854 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 18:37:04.858 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 18:37:04.861 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 18:37:04.865 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 18:37:04.869 +07:00 [DBG] Connection id "0HNCAVUU9FUB4", Request id "0HNCAVUU9FUB4:00000006": started reading request body.
2025-05-04 18:37:04.873 +07:00 [DBG] Connection id "0HNCAVUU9FUB4", Request id "0HNCAVUU9FUB4:00000006": done reading request body.
2025-05-04 18:37:04.877 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 18:37:04.880 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 18:37:04.885 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 18:37:04.890 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 18:37:04.894 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 18:37:05.038 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 18:37:05.047 +07:00 [DBG] Creating DbConnection.
2025-05-04 18:37:05.050 +07:00 [DBG] Created DbConnection. (2ms).
2025-05-04 18:37:05.057 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:37:05.061 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:37:05.064 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 18:37:05.068 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-05-04 18:37:05.073 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (8ms).
2025-05-04 18:37:05.078 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 18:37:05.088 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 18:37:05.100 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:37:05.106 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:37:05.109 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:37:05.116 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:37:05.121 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 20ms reading results.
2025-05-04 18:37:05.126 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:37:05.131 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (5ms).
2025-05-04 18:37:05.591 +07:00 [WRN] Login failed: invalid password for nguyetnkhuyen@gmail.com
2025-05-04 18:37:05.595 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 18:37:05.602 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 18:37:05.605 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 18:37:05.607 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 18:37:05.609 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 18:37:05.614 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType4`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 18:37:05.619 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 787.5736ms
2025-05-04 18:37:05.624 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 18:37:05.627 +07:00 [INF] HTTP POST /api/Auth/login responded 400 in 845.5550 ms
2025-05-04 18:37:05.632 +07:00 [DBG] Connection id "0HNCAVUU9FUB4" completed keep alive response.
2025-05-04 18:37:05.636 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 18:37:05.638 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:37:05.641 +07:00 [DBG] Disposed connection to database '' on server '' (3ms).
2025-05-04 18:37:05.684 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 400 null application/json; charset=utf-8 959.5359ms
2025-05-04 18:37:17.063 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 71
2025-05-04 18:37:17.067 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 18:37:17.070 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 18:37:17.075 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 18:37:17.077 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 18:37:17.080 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 18:37:17.089 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 18:37:17.093 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 18:37:17.102 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 18:37:17.106 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 18:37:17.112 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 18:37:17.117 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 18:37:17.122 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 18:37:17.127 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 18:37:17.131 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 18:37:17.135 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 18:37:17.139 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 18:37:17.143 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 18:37:17.148 +07:00 [DBG] Connection id "0HNCAVUU9FUB4", Request id "0HNCAVUU9FUB4:00000007": started reading request body.
2025-05-04 18:37:17.152 +07:00 [DBG] Connection id "0HNCAVUU9FUB4", Request id "0HNCAVUU9FUB4:00000007": done reading request body.
2025-05-04 18:37:17.156 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 18:37:17.160 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 18:37:17.164 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 18:37:17.168 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 18:37:17.172 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 18:37:17.177 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 18:37:17.185 +07:00 [DBG] Creating DbConnection.
2025-05-04 18:37:17.187 +07:00 [DBG] Created DbConnection. (1ms).
2025-05-04 18:37:17.189 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:37:17.192 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:37:17.196 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 18:37:17.199 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-05-04 18:37:17.202 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (6ms).
2025-05-04 18:37:17.205 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 18:37:17.211 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 18:37:17.218 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:37:17.221 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:37:17.224 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:37:17.227 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:37:17.231 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 13ms reading results.
2025-05-04 18:37:17.236 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:37:17.240 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (4ms).
2025-05-04 18:37:17.774 +07:00 [INF] User nguyetnkhuyen@gmail.com logged in successfully
2025-05-04 18:37:17.778 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 18:37:17.785 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 18:37:17.787 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 18:37:17.791 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 18:37:17.794 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 18:37:17.798 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType6`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 18:37:17.807 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 680.4455ms
2025-05-04 18:37:17.811 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 18:37:17.814 +07:00 [INF] HTTP POST /api/Auth/login responded 200 in 736.6192 ms
2025-05-04 18:37:17.820 +07:00 [DBG] Connection id "0HNCAVUU9FUB4" completed keep alive response.
2025-05-04 18:37:17.824 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 18:37:17.826 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:37:17.830 +07:00 [DBG] Disposed connection to database '' on server '' (3ms).
2025-05-04 18:37:17.833 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 200 null application/json; charset=utf-8 770.4954ms
2025-05-04 18:38:07.164 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=2 - null null
2025-05-04 18:38:07.169 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users'
2025-05-04 18:38:07.171 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)' with route pattern 'api/Users' is valid for the request path '/api/Users'
2025-05-04 18:38:07.176 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 18:38:07.181 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 18:38:07.279 +07:00 [DBG] Successfully validated the token.
2025-05-04 18:38:07.293 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 18:38:07.301 +07:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-05-04 18:38:07.308 +07:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-05-04 18:38:07.315 +07:00 [INF] HTTP GET /api/Users responded 403 in 134.3695 ms
2025-05-04 18:38:07.324 +07:00 [DBG] Connection id "0HNCAVUU9FUB4" completed keep alive response.
2025-05-04 18:38:07.328 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=2 - 403 0 null 164.1154ms
2025-05-04 18:38:43.744 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=2 - null null
2025-05-04 18:38:43.748 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users'
2025-05-04 18:38:43.750 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)' with route pattern 'api/Users' is valid for the request path '/api/Users'
2025-05-04 18:38:43.756 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 18:38:43.761 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 18:38:43.768 +07:00 [DBG] Successfully validated the token.
2025-05-04 18:38:43.773 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 18:38:43.781 +07:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-05-04 18:38:43.786 +07:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-05-04 18:38:43.790 +07:00 [INF] HTTP GET /api/Users responded 403 in 28.9809 ms
2025-05-04 18:38:43.799 +07:00 [DBG] Connection id "0HNCAVUU9FUB4" completed keep alive response.
2025-05-04 18:38:43.803 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=2 - 403 0 null 59.6076ms
2025-05-04 18:38:51.699 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=2 - null null
2025-05-04 18:38:51.704 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users'
2025-05-04 18:38:51.706 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)' with route pattern 'api/Users' is valid for the request path '/api/Users'
2025-05-04 18:38:51.712 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 18:38:51.745 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 18:38:51.751 +07:00 [DBG] Successfully validated the token.
2025-05-04 18:38:51.753 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 18:38:51.756 +07:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-05-04 18:38:51.761 +07:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-05-04 18:38:51.764 +07:00 [INF] HTTP GET /api/Users responded 403 in 18.9721 ms
2025-05-04 18:38:51.768 +07:00 [DBG] Connection id "0HNCAVUU9FUB4" completed keep alive response.
2025-05-04 18:38:51.772 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=2 - 403 0 null 73.1261ms
2025-05-04 18:39:07.851 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 71
2025-05-04 18:39:07.854 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 18:39:07.858 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 18:39:07.969 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 18:39:08.007 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 18:39:08.020 +07:00 [DBG] Successfully validated the token.
2025-05-04 18:39:08.049 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 18:39:08.054 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 18:39:08.058 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 18:39:08.064 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 18:39:08.071 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 18:39:08.107 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 18:39:08.111 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 18:39:08.114 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 18:39:08.118 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 18:39:08.123 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 18:39:08.126 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 18:39:08.130 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 18:39:08.135 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 18:39:08.139 +07:00 [DBG] Connection id "0HNCAVUU9FUB4", Request id "0HNCAVUU9FUB4:0000000B": started reading request body.
2025-05-04 18:39:08.143 +07:00 [DBG] Connection id "0HNCAVUU9FUB4", Request id "0HNCAVUU9FUB4:0000000B": done reading request body.
2025-05-04 18:39:08.146 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 18:39:08.149 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 18:39:08.153 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 18:39:08.157 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 18:39:08.160 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 18:39:08.165 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 18:39:08.172 +07:00 [DBG] Creating DbConnection.
2025-05-04 18:39:08.174 +07:00 [DBG] Created DbConnection. (1ms).
2025-05-04 18:39:08.176 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:39:08.179 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:39:08.182 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 18:39:08.185 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-05-04 18:39:08.188 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2025-05-04 18:39:08.190 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 18:39:08.207 +07:00 [INF] Executed DbCommand (17ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 18:39:08.213 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:39:08.216 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:39:08.221 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:39:08.224 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:39:08.228 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 15ms reading results.
2025-05-04 18:39:08.232 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:39:08.236 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (3ms).
2025-05-04 18:39:08.700 +07:00 [INF] User nguyetnkhuyen@gmail.com logged in successfully
2025-05-04 18:39:08.703 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 18:39:08.712 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 18:39:08.714 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 18:39:08.718 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 18:39:08.721 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 18:39:08.726 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType6`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 18:39:08.730 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 611.7352ms
2025-05-04 18:39:08.735 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 18:39:08.738 +07:00 [INF] HTTP POST /api/Auth/login responded 200 in 730.8920 ms
2025-05-04 18:39:08.743 +07:00 [DBG] Connection id "0HNCAVUU9FUB4" completed keep alive response.
2025-05-04 18:39:08.746 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 18:39:08.751 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:39:08.755 +07:00 [DBG] Disposed connection to database '' on server '' (4ms).
2025-05-04 18:39:08.759 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 200 null application/json; charset=utf-8 907.8792ms
2025-05-04 18:39:37.040 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=2 - null null
2025-05-04 18:39:37.043 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users'
2025-05-04 18:39:37.045 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)' with route pattern 'api/Users' is valid for the request path '/api/Users'
2025-05-04 18:39:37.049 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 18:39:37.090 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 18:39:37.093 +07:00 [DBG] Successfully validated the token.
2025-05-04 18:39:37.103 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 18:39:37.107 +07:00 [DBG] Authorization was successful.
2025-05-04 18:39:37.111 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 18:39:37.127 +07:00 [INF] Route matched with {action = "GetAll", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Int32, Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 18:39:37.134 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 18:39:37.139 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 18:39:37.141 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 18:39:37.146 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 18:39:37.152 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 18:39:37.155 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 18:39:37.160 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 18:39:37.171 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 18:39:37.176 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' using the name 'pageNumber' in request data ...
2025-05-04 18:39:37.182 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 18:39:37.188 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 18:39:37.193 +07:00 [DBG] Attempting to validate the bound parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 18:39:37.198 +07:00 [DBG] Done attempting to validate the bound parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 18:39:37.202 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 18:39:37.206 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' using the name 'pageSize' in request data ...
2025-05-04 18:39:37.211 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 18:39:37.215 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 18:39:37.219 +07:00 [DBG] Attempting to validate the bound parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 18:39:37.222 +07:00 [DBG] Done attempting to validate the bound parameter 'pageSize' of type 'System.Int32'.
2025-05-04 18:39:37.235 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 18:39:37.241 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-05-04 18:39:37.276 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: SingleQueryingEnumerable.Create<int>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM users AS u) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM users AS u, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            int? value1;
            value1 = dataReader.IsDBNull(0) ? default(int?) : (int?)dataReader.GetInt32(0);
            return (int)value1;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-04 18:39:37.303 +07:00 [DBG] Creating DbConnection.
2025-05-04 18:39:37.306 +07:00 [DBG] Created DbConnection. (2ms).
2025-05-04 18:39:37.309 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:39:37.313 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:39:37.317 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 18:39:37.320 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-05-04 18:39:37.323 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2025-05-04 18:39:37.328 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [users] AS [u]
2025-05-04 18:39:37.338 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [users] AS [u]
2025-05-04 18:39:37.348 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:39:37.353 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 7ms reading results.
2025-05-04 18:39:37.361 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:39:37.366 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (5ms).
2025-05-04 18:39:37.388 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .Include(u => u.Userprofile)
    .OrderBy(u => u.UserId)
    .Skip(__p_0)
    .Take(__p_1)'
2025-05-04 18:39:37.397 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-04 18:39:37.404 +07:00 [DBG] Including navigation: 'User.Userprofile'.
2025-05-04 18:39:37.460 +07:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<User>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
            1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
        SELECT u0.userId, u0.CreatedAt, u0.email, u0.fullName, u0.IsEmailVerified, u0.password, u0.PasswordResetToken, u0.phone, u0.ResetTokenExpires, u0.roleId, u0.UpdatedAt, r.roleId, r.roleName, u1.userprofileId, u1.address, u1.birth, u1.userId
        FROM 
        (
            SELECT u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt
            FROM users AS u
            ORDER BY u.userId ASC
            OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
        ) AS u0
        INNER JOIN roles AS r ON u0.roleId == r.roleId
        LEFT JOIN userprofiles AS u1 ON u0.userId == u1.userId
        ORDER BY u0.userId ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
            1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
        SELECT u0.userId, u0.CreatedAt, u0.email, u0.fullName, u0.IsEmailVerified, u0.password, u0.PasswordResetToken, u0.phone, u0.ResetTokenExpires, u0.roleId, u0.UpdatedAt, r.roleId, r.roleName, u1.userprofileId, u1.address, u1.birth, u1.userId
        FROM 
        (
            SELECT u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt
            FROM users AS u
            ORDER BY u.userId ASC
            OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
        ) AS u0
        INNER JOIN roles AS r ON u0.roleId == r.roleId
        LEFT JOIN userprofiles AS u1 ON u0.userId == u1.userId
        ORDER BY u0.userId ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        User entity;
        Role entity;
        Userprofile entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            User instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(User);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (User)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                        {
                            return 
                            {
                                User instance;
                                instance = new User();
                                instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                instance.<Email>k__BackingField = dataReader.GetString(2);
                                instance.<FullName>k__BackingField = dataReader.GetString(3);
                                instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(4);
                                instance.<Password>k__BackingField = dataReader.GetString(5);
                                instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                instance.<Phone>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(8) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(8);
                                instance.<RoleId>k__BackingField = dataReader.GetInt32(9);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(User)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        entity = 
        {
            MaterializationContext materializationContext2;
            IEntityType entityType2;
            Role instance2;
            InternalEntityEntry entry2;
            bool hasNullKey2;
            materializationContext2 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance2 = default(Role);
            entry2 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(11) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey2);
            !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
            {
                entityType2 = entry2.EntityType;
                return instance2 = (Role)entry2.Entity;
            } : 
            {
                ISnapshot shadowSnapshot2;
                shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                instance2 = switch (entityType2)
                {
                    case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                        {
                            return 
                            {
                                Role instance;
                                instance = new Role();
                                instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                instance.<RoleName>k__BackingField = dataReader.GetString(12);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext2.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Role)
                }
                ;
                entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType2, 
                    entity: instance2, 
                    snapshot: shadowSnapshot2);
                return instance2;
            } : default(void);
            return instance2;
        };
        entity = 
        {
            MaterializationContext materializationContext3;
            IEntityType entityType3;
            Userprofile instance3;
            InternalEntityEntry entry3;
            bool hasNullKey3;
            materializationContext3 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance3 = default(Userprofile);
            entry3 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Userprofile.UserprofileId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindPrimaryKey()], 
                keyValues: new object[]{ dataReader.IsDBNull(13) ? default(object) : (object)dataReader.GetInt32(13) }, 
                throwOnNullKey: False, 
                hasNullKey: hasNullKey3);
            !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
            {
                entityType3 = entry3.EntityType;
                return instance3 = (Userprofile)entry3.Entity;
            } : 
            {
                ISnapshot shadowSnapshot3;
                shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType3 = [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")];
                instance3 = switch (entityType3)
                {
                    case [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]: 
                        {
                            return 
                            {
                                Userprofile instance;
                                instance = new Userprofile();
                                instance.<UserprofileId>k__BackingField = dataReader.IsDBNull(13) ? default(int) : dataReader.GetInt32(13);
                                instance.<Address>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                instance.<Birth>k__BackingField = dataReader.IsDBNull(15) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(15);
                                instance.<UserId>k__BackingField = dataReader.IsDBNull(16) ? default(int) : dataReader.GetInt32(16);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext3.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Userprofile)
                }
                ;
                entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType3, 
                    entity: instance3, 
                    snapshot: shadowSnapshot3);
                return instance3;
            } : default(void);
            return instance3;
        };
        ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
            fixup: (namelessParameter{11}, namelessParameter{12}) => 
            {
                namelessParameter{11}.<Role>k__BackingField = namelessParameter{12};
                return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                    entity: namelessParameter{12}, 
                    value: namelessParameter{11}, 
                    forMaterialization: True);
            }, 
            trackingQuery: True);
        ShaperProcessingExpressionVisitor.IncludeReference<User, User, Userprofile>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: User.Userprofile (Userprofile) ToDependent Userprofile Inverse: User | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Userprofile")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Userprofile.User (User) ToPrincipal User Inverse: Userprofile | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindNavigation("User")], 
            fixup: (namelessParameter{16}, namelessParameter{17}) => 
            {
                namelessParameter{16}.<Userprofile>k__BackingField = namelessParameter{17};
                return namelessParameter{17}.<User>k__BackingField = namelessParameter{16};
            }, 
            trackingQuery: True);
        return entity;
    }, 
    contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-05-04 18:39:37.561 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:39:37.565 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:39:37.570 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 18:39:37.572 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-05-04 18:39:37.576 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (6ms).
2025-05-04 18:39:37.581 +07:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[userId], [u0].[CreatedAt], [u0].[email], [u0].[fullName], [u0].[IsEmailVerified], [u0].[password], [u0].[PasswordResetToken], [u0].[phone], [u0].[ResetTokenExpires], [u0].[roleId], [u0].[UpdatedAt], [r].[roleId], [r].[roleName], [u1].[userprofileId], [u1].[address], [u1].[birth], [u1].[userId]
FROM (
    SELECT [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
    FROM [users] AS [u]
    ORDER BY [u].[userId]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [roles] AS [r] ON [u0].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u1] ON [u0].[userId] = [u1].[userId]
ORDER BY [u0].[userId]
2025-05-04 18:39:37.607 +07:00 [INF] Executed DbCommand (28ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[userId], [u0].[CreatedAt], [u0].[email], [u0].[fullName], [u0].[IsEmailVerified], [u0].[password], [u0].[PasswordResetToken], [u0].[phone], [u0].[ResetTokenExpires], [u0].[roleId], [u0].[UpdatedAt], [r].[roleId], [r].[roleName], [u1].[userprofileId], [u1].[address], [u1].[birth], [u1].[userId]
FROM (
    SELECT [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
    FROM [users] AS [u]
    ORDER BY [u].[userId]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [roles] AS [r] ON [u0].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u1] ON [u0].[userId] = [u1].[userId]
ORDER BY [u0].[userId]
2025-05-04 18:39:37.617 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:39:37.621 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:39:37.625 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:39:37.637 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:39:37.643 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:39:37.647 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 30ms reading results.
2025-05-04 18:39:37.653 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:39:37.659 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (5ms).
2025-05-04 18:39:37.668 +07:00 [INF] Admin fetched users page 1 with size 2
2025-05-04 18:39:37.671 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 18:39:37.678 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 18:39:37.680 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 18:39:37.682 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 18:39:37.686 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 18:39:37.693 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.PagedResponseDTO`1[[ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO, ExchangeDocument, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 18:39:37.745 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument) in 589.7844ms
2025-05-04 18:39:37.749 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 18:39:37.753 +07:00 [INF] HTTP GET /api/Users responded 200 in 663.2686 ms
2025-05-04 18:39:37.758 +07:00 [DBG] Connection id "0HNCAVUU9FUB4" completed keep alive response.
2025-05-04 18:39:37.760 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 18:39:37.763 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:39:37.767 +07:00 [DBG] Disposed connection to database '' on server '' (4ms).
2025-05-04 18:39:37.771 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=2 - 200 null application/json; charset=utf-8 730.6071ms
2025-05-04 18:40:06.203 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=2&pageSize=2 - null null
2025-05-04 18:40:06.207 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users'
2025-05-04 18:40:06.209 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)' with route pattern 'api/Users' is valid for the request path '/api/Users'
2025-05-04 18:40:06.217 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 18:40:06.220 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 18:40:06.223 +07:00 [DBG] Successfully validated the token.
2025-05-04 18:40:06.225 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 18:40:06.230 +07:00 [DBG] Authorization was successful.
2025-05-04 18:40:06.234 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 18:40:06.238 +07:00 [INF] Route matched with {action = "GetAll", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Int32, Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 18:40:06.243 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 18:40:06.248 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 18:40:06.253 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 18:40:06.261 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 18:40:06.265 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 18:40:06.269 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 18:40:06.274 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 18:40:06.279 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 18:40:06.283 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' using the name 'pageNumber' in request data ...
2025-05-04 18:40:06.287 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 18:40:06.290 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 18:40:06.294 +07:00 [DBG] Attempting to validate the bound parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 18:40:06.298 +07:00 [DBG] Done attempting to validate the bound parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 18:40:06.301 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 18:40:06.305 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' using the name 'pageSize' in request data ...
2025-05-04 18:40:06.309 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 18:40:06.312 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 18:40:06.316 +07:00 [DBG] Attempting to validate the bound parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 18:40:06.318 +07:00 [DBG] Done attempting to validate the bound parameter 'pageSize' of type 'System.Int32'.
2025-05-04 18:40:06.323 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 18:40:06.329 +07:00 [DBG] Creating DbConnection.
2025-05-04 18:40:06.331 +07:00 [DBG] Created DbConnection. (1ms).
2025-05-04 18:40:06.333 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:40:06.337 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:40:06.341 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 18:40:06.344 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-05-04 18:40:06.348 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (7ms).
2025-05-04 18:40:06.351 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [users] AS [u]
2025-05-04 18:40:06.362 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [users] AS [u]
2025-05-04 18:40:06.367 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:40:06.370 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 3ms reading results.
2025-05-04 18:40:06.374 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:40:06.379 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (4ms).
2025-05-04 18:40:06.385 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .Include(u => u.Userprofile)
    .OrderBy(u => u.UserId)
    .Skip(__p_0)
    .Take(__p_0)'
2025-05-04 18:40:06.393 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-04 18:40:06.396 +07:00 [DBG] Including navigation: 'User.Userprofile'.
2025-05-04 18:40:06.420 +07:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<User>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
            1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
        SELECT u0.userId, u0.CreatedAt, u0.email, u0.fullName, u0.IsEmailVerified, u0.password, u0.PasswordResetToken, u0.phone, u0.ResetTokenExpires, u0.roleId, u0.UpdatedAt, r.roleId, r.roleName, u1.userprofileId, u1.address, u1.birth, u1.userId
        FROM 
        (
            SELECT u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt
            FROM users AS u
            ORDER BY u.userId ASC
            OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
        ) AS u0
        INNER JOIN roles AS r ON u0.roleId == r.roleId
        LEFT JOIN userprofiles AS u1 ON u0.userId == u1.userId
        ORDER BY u0.userId ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
            1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
        SELECT u0.userId, u0.CreatedAt, u0.email, u0.fullName, u0.IsEmailVerified, u0.password, u0.PasswordResetToken, u0.phone, u0.ResetTokenExpires, u0.roleId, u0.UpdatedAt, r.roleId, r.roleName, u1.userprofileId, u1.address, u1.birth, u1.userId
        FROM 
        (
            SELECT u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt
            FROM users AS u
            ORDER BY u.userId ASC
            OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
        ) AS u0
        INNER JOIN roles AS r ON u0.roleId == r.roleId
        LEFT JOIN userprofiles AS u1 ON u0.userId == u1.userId
        ORDER BY u0.userId ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        User entity;
        Role entity;
        Userprofile entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            User instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(User);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (User)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                        {
                            return 
                            {
                                User instance;
                                instance = new User();
                                instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                instance.<Email>k__BackingField = dataReader.GetString(2);
                                instance.<FullName>k__BackingField = dataReader.GetString(3);
                                instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(4);
                                instance.<Password>k__BackingField = dataReader.GetString(5);
                                instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                instance.<Phone>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(8) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(8);
                                instance.<RoleId>k__BackingField = dataReader.GetInt32(9);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(User)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        entity = 
        {
            MaterializationContext materializationContext2;
            IEntityType entityType2;
            Role instance2;
            InternalEntityEntry entry2;
            bool hasNullKey2;
            materializationContext2 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance2 = default(Role);
            entry2 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(11) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey2);
            !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
            {
                entityType2 = entry2.EntityType;
                return instance2 = (Role)entry2.Entity;
            } : 
            {
                ISnapshot shadowSnapshot2;
                shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                instance2 = switch (entityType2)
                {
                    case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                        {
                            return 
                            {
                                Role instance;
                                instance = new Role();
                                instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                instance.<RoleName>k__BackingField = dataReader.GetString(12);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext2.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Role)
                }
                ;
                entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType2, 
                    entity: instance2, 
                    snapshot: shadowSnapshot2);
                return instance2;
            } : default(void);
            return instance2;
        };
        entity = 
        {
            MaterializationContext materializationContext3;
            IEntityType entityType3;
            Userprofile instance3;
            InternalEntityEntry entry3;
            bool hasNullKey3;
            materializationContext3 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance3 = default(Userprofile);
            entry3 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Userprofile.UserprofileId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindPrimaryKey()], 
                keyValues: new object[]{ dataReader.IsDBNull(13) ? default(object) : (object)dataReader.GetInt32(13) }, 
                throwOnNullKey: False, 
                hasNullKey: hasNullKey3);
            !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
            {
                entityType3 = entry3.EntityType;
                return instance3 = (Userprofile)entry3.Entity;
            } : 
            {
                ISnapshot shadowSnapshot3;
                shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType3 = [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")];
                instance3 = switch (entityType3)
                {
                    case [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]: 
                        {
                            return 
                            {
                                Userprofile instance;
                                instance = new Userprofile();
                                instance.<UserprofileId>k__BackingField = dataReader.IsDBNull(13) ? default(int) : dataReader.GetInt32(13);
                                instance.<Address>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                instance.<Birth>k__BackingField = dataReader.IsDBNull(15) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(15);
                                instance.<UserId>k__BackingField = dataReader.IsDBNull(16) ? default(int) : dataReader.GetInt32(16);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext3.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Userprofile)
                }
                ;
                entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType3, 
                    entity: instance3, 
                    snapshot: shadowSnapshot3);
                return instance3;
            } : default(void);
            return instance3;
        };
        ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
            fixup: (namelessParameter{11}, namelessParameter{12}) => 
            {
                namelessParameter{11}.<Role>k__BackingField = namelessParameter{12};
                return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                    entity: namelessParameter{12}, 
                    value: namelessParameter{11}, 
                    forMaterialization: True);
            }, 
            trackingQuery: True);
        ShaperProcessingExpressionVisitor.IncludeReference<User, User, Userprofile>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: User.Userprofile (Userprofile) ToDependent Userprofile Inverse: User | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Userprofile")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Userprofile.User (User) ToPrincipal User Inverse: Userprofile | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindNavigation("User")], 
            fixup: (namelessParameter{16}, namelessParameter{17}) => 
            {
                namelessParameter{16}.<Userprofile>k__BackingField = namelessParameter{17};
                return namelessParameter{17}.<User>k__BackingField = namelessParameter{16};
            }, 
            trackingQuery: True);
        return entity;
    }, 
    contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-05-04 18:40:06.513 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:40:06.517 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:40:06.521 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 18:40:06.523 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-05-04 18:40:06.528 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (6ms).
2025-05-04 18:40:06.531 +07:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[userId], [u0].[CreatedAt], [u0].[email], [u0].[fullName], [u0].[IsEmailVerified], [u0].[password], [u0].[PasswordResetToken], [u0].[phone], [u0].[ResetTokenExpires], [u0].[roleId], [u0].[UpdatedAt], [r].[roleId], [r].[roleName], [u1].[userprofileId], [u1].[address], [u1].[birth], [u1].[userId]
FROM (
    SELECT [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
    FROM [users] AS [u]
    ORDER BY [u].[userId]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [u0]
INNER JOIN [roles] AS [r] ON [u0].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u1] ON [u0].[userId] = [u1].[userId]
ORDER BY [u0].[userId]
2025-05-04 18:40:06.549 +07:00 [INF] Executed DbCommand (17ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[userId], [u0].[CreatedAt], [u0].[email], [u0].[fullName], [u0].[IsEmailVerified], [u0].[password], [u0].[PasswordResetToken], [u0].[phone], [u0].[ResetTokenExpires], [u0].[roleId], [u0].[UpdatedAt], [r].[roleId], [r].[roleName], [u1].[userprofileId], [u1].[address], [u1].[birth], [u1].[userId]
FROM (
    SELECT [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
    FROM [users] AS [u]
    ORDER BY [u].[userId]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [u0]
INNER JOIN [roles] AS [r] ON [u0].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u1] ON [u0].[userId] = [u1].[userId]
ORDER BY [u0].[userId]
2025-05-04 18:40:06.558 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:40:06.561 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:40:06.565 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:40:06.583 +07:00 [DBG] The navigation 'User.Userprofile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:40:06.587 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Userprofile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:40:06.605 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:40:06.608 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 51ms reading results.
2025-05-04 18:40:06.613 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:40:06.617 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (3ms).
2025-05-04 18:40:06.621 +07:00 [INF] Admin fetched users page 2 with size 2
2025-05-04 18:40:06.625 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 18:40:06.631 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 18:40:06.633 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 18:40:06.635 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 18:40:06.637 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 18:40:06.641 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.PagedResponseDTO`1[[ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO, ExchangeDocument, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 18:40:06.647 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument) in 377.8999ms
2025-05-04 18:40:06.650 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 18:40:06.653 +07:00 [INF] HTTP GET /api/Users responded 200 in 433.1284 ms
2025-05-04 18:40:06.656 +07:00 [DBG] Connection id "0HNCAVUU9FUB4" completed keep alive response.
2025-05-04 18:40:06.658 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 18:40:06.662 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:40:06.665 +07:00 [DBG] Disposed connection to database '' on server '' (3ms).
2025-05-04 18:40:06.669 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=2&pageSize=2 - 200 null application/json; charset=utf-8 465.7973ms
2025-05-04 18:40:48.598 +07:00 [DBG] Connection id "0HNCAVUU9FUB4" received FIN.
2025-05-04 18:40:48.601 +07:00 [DBG] Connection id "0HNCAVUU9FUB4" disconnecting.
2025-05-04 18:40:48.603 +07:00 [DBG] Connection id "0HNCAVUU9FUB4" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 18:40:48.616 +07:00 [DBG] Connection id "0HNCAVUU9FUB4" stopped.
2025-05-04 18:42:45.220 +07:00 [DBG] Connection id "0HNCAVUU9FUB6" accepted.
2025-05-04 18:42:45.224 +07:00 [DBG] Connection id "0HNCAVUU9FUB6" started.
2025-05-04 18:42:45.226 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=2&pageSize=2 - null null
2025-05-04 18:42:45.233 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users'
2025-05-04 18:42:45.235 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)' with route pattern 'api/Users' is valid for the request path '/api/Users'
2025-05-04 18:42:45.243 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 18:42:45.250 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 18:42:45.254 +07:00 [DBG] Successfully validated the token.
2025-05-04 18:42:45.260 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 18:42:45.264 +07:00 [DBG] Authorization was successful.
2025-05-04 18:42:45.268 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 18:42:45.274 +07:00 [INF] Route matched with {action = "GetAll", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Int32, Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 18:42:45.281 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 18:42:45.285 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 18:42:45.291 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 18:42:45.299 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 18:42:45.304 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 18:42:45.311 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 18:42:45.318 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 18:42:45.322 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 18:42:45.327 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' using the name 'pageNumber' in request data ...
2025-05-04 18:42:45.333 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 18:42:45.338 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 18:42:45.342 +07:00 [DBG] Attempting to validate the bound parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 18:42:45.347 +07:00 [DBG] Done attempting to validate the bound parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 18:42:45.351 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 18:42:45.354 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' using the name 'pageSize' in request data ...
2025-05-04 18:42:45.360 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 18:42:45.363 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 18:42:45.366 +07:00 [DBG] Attempting to validate the bound parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 18:42:45.372 +07:00 [DBG] Done attempting to validate the bound parameter 'pageSize' of type 'System.Int32'.
2025-05-04 18:42:45.379 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 18:42:45.388 +07:00 [DBG] Creating DbConnection.
2025-05-04 18:42:45.390 +07:00 [DBG] Created DbConnection. (2ms).
2025-05-04 18:42:45.394 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:42:45.397 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:42:45.401 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 18:42:45.404 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-05-04 18:42:45.409 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (7ms).
2025-05-04 18:42:45.413 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [users] AS [u]
2025-05-04 18:42:45.423 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [users] AS [u]
2025-05-04 18:42:45.430 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:42:45.436 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 5ms reading results.
2025-05-04 18:42:45.441 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:42:45.446 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (4ms).
2025-05-04 18:42:45.451 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:42:45.457 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:42:45.462 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 18:42:45.465 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-05-04 18:42:45.470 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (7ms).
2025-05-04 18:42:45.475 +07:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[userId], [u0].[CreatedAt], [u0].[email], [u0].[fullName], [u0].[IsEmailVerified], [u0].[password], [u0].[PasswordResetToken], [u0].[phone], [u0].[ResetTokenExpires], [u0].[roleId], [u0].[UpdatedAt], [r].[roleId], [r].[roleName], [u1].[userprofileId], [u1].[address], [u1].[birth], [u1].[userId]
FROM (
    SELECT [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
    FROM [users] AS [u]
    ORDER BY [u].[userId]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [u0]
INNER JOIN [roles] AS [r] ON [u0].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u1] ON [u0].[userId] = [u1].[userId]
ORDER BY [u0].[userId]
2025-05-04 18:42:45.498 +07:00 [INF] Executed DbCommand (23ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[userId], [u0].[CreatedAt], [u0].[email], [u0].[fullName], [u0].[IsEmailVerified], [u0].[password], [u0].[PasswordResetToken], [u0].[phone], [u0].[ResetTokenExpires], [u0].[roleId], [u0].[UpdatedAt], [r].[roleId], [r].[roleName], [u1].[userprofileId], [u1].[address], [u1].[birth], [u1].[userId]
FROM (
    SELECT [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
    FROM [users] AS [u]
    ORDER BY [u].[userId]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [u0]
INNER JOIN [roles] AS [r] ON [u0].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u1] ON [u0].[userId] = [u1].[userId]
ORDER BY [u0].[userId]
2025-05-04 18:42:45.510 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:42:45.514 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:42:45.519 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:42:45.523 +07:00 [DBG] The navigation 'User.Userprofile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:42:45.528 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Userprofile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:42:45.535 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:42:45.541 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 31ms reading results.
2025-05-04 18:42:45.546 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:42:45.551 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (4ms).
2025-05-04 18:42:45.555 +07:00 [INF] Admin fetched users page 2 with size 2
2025-05-04 18:42:45.560 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 18:42:45.565 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 18:42:45.568 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 18:42:45.570 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 18:42:45.573 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 18:42:45.577 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.PagedResponseDTO`1[[ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO, ExchangeDocument, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 18:42:45.581 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument) in 270.3365ms
2025-05-04 18:42:45.584 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 18:42:45.587 +07:00 [INF] HTTP GET /api/Users responded 200 in 338.0023 ms
2025-05-04 18:42:45.593 +07:00 [DBG] Connection id "0HNCAVUU9FUB6" completed keep alive response.
2025-05-04 18:42:45.596 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 18:42:45.598 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:42:45.602 +07:00 [DBG] Disposed connection to database '' on server '' (3ms).
2025-05-04 18:42:45.605 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=2&pageSize=2 - 200 null application/json; charset=utf-8 378.9794ms
2025-05-04 18:42:50.264 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=2 - null null
2025-05-04 18:42:50.272 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users'
2025-05-04 18:42:50.275 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)' with route pattern 'api/Users' is valid for the request path '/api/Users'
2025-05-04 18:42:50.309 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 18:42:50.313 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 18:42:50.324 +07:00 [DBG] Successfully validated the token.
2025-05-04 18:42:50.327 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 18:42:50.330 +07:00 [DBG] Authorization was successful.
2025-05-04 18:42:50.334 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 18:42:50.338 +07:00 [INF] Route matched with {action = "GetAll", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Int32, Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 18:42:50.344 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 18:42:50.348 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 18:42:50.351 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 18:42:50.359 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 18:42:50.363 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 18:42:50.368 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 18:42:50.373 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 18:42:50.377 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 18:42:50.379 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' using the name 'pageNumber' in request data ...
2025-05-04 18:42:50.382 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 18:42:50.386 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 18:42:50.390 +07:00 [DBG] Attempting to validate the bound parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 18:42:50.394 +07:00 [DBG] Done attempting to validate the bound parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 18:42:50.397 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 18:42:50.402 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' using the name 'pageSize' in request data ...
2025-05-04 18:42:50.406 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 18:42:50.409 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 18:42:50.413 +07:00 [DBG] Attempting to validate the bound parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 18:42:50.416 +07:00 [DBG] Done attempting to validate the bound parameter 'pageSize' of type 'System.Int32'.
2025-05-04 18:42:50.420 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 18:42:50.426 +07:00 [DBG] Creating DbConnection.
2025-05-04 18:42:50.429 +07:00 [DBG] Created DbConnection. (2ms).
2025-05-04 18:42:50.431 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:42:50.435 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:42:50.440 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 18:42:50.443 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-05-04 18:42:50.447 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (6ms).
2025-05-04 18:42:50.450 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [users] AS [u]
2025-05-04 18:42:50.457 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [users] AS [u]
2025-05-04 18:42:50.463 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:42:50.466 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 3ms reading results.
2025-05-04 18:42:50.470 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:42:50.474 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (3ms).
2025-05-04 18:42:50.479 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:42:50.483 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:42:50.486 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 18:42:50.489 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-05-04 18:42:50.492 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (6ms).
2025-05-04 18:42:50.496 +07:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[userId], [u0].[CreatedAt], [u0].[email], [u0].[fullName], [u0].[IsEmailVerified], [u0].[password], [u0].[PasswordResetToken], [u0].[phone], [u0].[ResetTokenExpires], [u0].[roleId], [u0].[UpdatedAt], [r].[roleId], [r].[roleName], [u1].[userprofileId], [u1].[address], [u1].[birth], [u1].[userId]
FROM (
    SELECT [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
    FROM [users] AS [u]
    ORDER BY [u].[userId]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [roles] AS [r] ON [u0].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u1] ON [u0].[userId] = [u1].[userId]
ORDER BY [u0].[userId]
2025-05-04 18:42:50.513 +07:00 [INF] Executed DbCommand (17ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[userId], [u0].[CreatedAt], [u0].[email], [u0].[fullName], [u0].[IsEmailVerified], [u0].[password], [u0].[PasswordResetToken], [u0].[phone], [u0].[ResetTokenExpires], [u0].[roleId], [u0].[UpdatedAt], [r].[roleId], [r].[roleName], [u1].[userprofileId], [u1].[address], [u1].[birth], [u1].[userId]
FROM (
    SELECT [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
    FROM [users] AS [u]
    ORDER BY [u].[userId]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [roles] AS [r] ON [u0].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u1] ON [u0].[userId] = [u1].[userId]
ORDER BY [u0].[userId]
2025-05-04 18:42:50.521 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:42:50.525 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:42:50.529 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:42:50.533 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 18:42:50.537 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:42:50.541 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 20ms reading results.
2025-05-04 18:42:50.545 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:42:50.549 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (3ms).
2025-05-04 18:42:50.553 +07:00 [INF] Admin fetched users page 1 with size 2
2025-05-04 18:42:50.557 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 18:42:50.564 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 18:42:50.566 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 18:42:50.568 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 18:42:50.570 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 18:42:50.573 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.PagedResponseDTO`1[[ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO, ExchangeDocument, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 18:42:50.578 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument) in 209.633ms
2025-05-04 18:42:50.581 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 18:42:50.584 +07:00 [INF] HTTP GET /api/Users responded 200 in 270.6214 ms
2025-05-04 18:42:50.587 +07:00 [DBG] Connection id "0HNCAVUU9FUB6" completed keep alive response.
2025-05-04 18:42:50.590 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 18:42:50.593 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 18:42:50.597 +07:00 [DBG] Disposed connection to database '' on server '' (3ms).
2025-05-04 18:42:50.600 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=2 - 200 null application/json; charset=utf-8 336.0611ms
2025-05-04 18:45:01.951 +07:00 [DBG] Connection id "0HNCAVUU9FUB6" disconnecting.
2025-05-04 18:45:01.954 +07:00 [DBG] Connection id "0HNCAVUU9FUB6" stopped.
2025-05-04 18:45:01.957 +07:00 [DBG] Connection id "0HNCAVUU9FUB6" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 19:14:22.257 +07:00 [INF] Application is shutting down...
2025-05-04 19:14:22.258 +07:00 [DBG] Hosting stopping
2025-05-04 19:14:22.268 +07:00 [DBG] Hosting stopped
2025-05-04 19:16:27.143 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-05-04 19:16:27.314 +07:00 [DBG] Hosting starting
2025-05-04 19:16:27.340 +07:00 [INF] User profile is available. Using 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-04 19:16:27.357 +07:00 [DBG] Reading data from file 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys\key-1a51a872-ea43-4350-815f-0422835a65dd.xml'.
2025-05-04 19:16:27.373 +07:00 [DBG] Found key {1a51a872-ea43-4350-815f-0422835a65dd}.
2025-05-04 19:16:27.391 +07:00 [DBG] Considering key {1a51a872-ea43-4350-815f-0422835a65dd} with expiration date 2025-07-05 19:31:04Z as default key.
2025-05-04 19:16:27.398 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 19:16:27.407 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-05-04 19:16:27.415 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 19:16:27.432 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-05-04 19:16:27.438 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-05-04 19:16:27.448 +07:00 [DBG] Using key {1a51a872-ea43-4350-815f-0422835a65dd} as the default key.
2025-05-04 19:16:27.453 +07:00 [DBG] Key ring with default key {1a51a872-ea43-4350-815f-0422835a65dd} was loaded during application startup.
2025-05-04 19:16:27.527 +07:00 [INF] Now listening on: http://localhost:5120
2025-05-04 19:16:27.530 +07:00 [DBG] Loaded hosting startup assembly ExchangeDocument
2025-05-04 19:16:27.534 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-04 19:16:27.538 +07:00 [INF] Hosting environment: Development
2025-05-04 19:16:27.540 +07:00 [INF] Content root path: D:\Gộp module Auth\ExchangeDocument(Tự làm Auth_User) - Đã làm logout(2)\ExchangeDocument
2025-05-04 19:16:27.542 +07:00 [DBG] Hosting started
2025-05-04 19:16:34.007 +07:00 [DBG] Connection id "0HNCB0M1ATHK0" accepted.
2025-05-04 19:16:34.015 +07:00 [DBG] Connection id "0HNCB0M1ATHK0" started.
2025-05-04 19:16:34.015 +07:00 [DBG] Connection id "0HNCB0M1ATHK1" accepted.
2025-05-04 19:16:34.028 +07:00 [DBG] Connection id "0HNCB0M1ATHK1" started.
2025-05-04 19:16:34.063 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/index.html - null null
2025-05-04 19:16:34.082 +07:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-05-04 19:16:34.108 +07:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-05-04 19:16:34.115 +07:00 [DBG] Request did not match any endpoints
2025-05-04 19:16:34.230 +07:00 [INF] HTTP GET /swagger/index.html responded 200 in 104.6269 ms
2025-05-04 19:16:34.243 +07:00 [DBG] Connection id "0HNCB0M1ATHK0" completed keep alive response.
2025-05-04 19:16:34.250 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/index.html - 200 null text/html;charset=utf-8 188.5981ms
2025-05-04 19:16:34.911 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - null null
2025-05-04 19:16:34.921 +07:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-05-04 19:16:34.927 +07:00 [DBG] Request did not match any endpoints
2025-05-04 19:16:35.239 +07:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 307.2099 ms
2025-05-04 19:16:35.243 +07:00 [DBG] Connection id "0HNCB0M1ATHK0" completed keep alive response.
2025-05-04 19:16:35.247 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 336.9757ms
2025-05-04 19:18:03.590 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/-9 - null null
2025-05-04 19:18:03.591 +07:00 [DBG] Connection id "0HNCB0M1ATHK1" received FIN.
2025-05-04 19:18:03.600 +07:00 [DBG] Connection id "0HNCB0M1ATHK1" disconnecting.
2025-05-04 19:18:03.632 +07:00 [DBG] Connection id "0HNCB0M1ATHK1" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 19:18:03.632 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/-9'
2025-05-04 19:18:03.648 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/-9'
2025-05-04 19:18:03.649 +07:00 [DBG] Connection id "0HNCB0M1ATHK1" stopped.
2025-05-04 19:18:03.654 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:18:03.662 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 19:18:03.665 +07:00 [WRN] Failed to determine the https port for redirect.
2025-05-04 19:18:03.697 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 19:18:03.704 +07:00 [DBG] Policy authentication schemes  did not succeed
2025-05-04 19:18:03.711 +07:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-05-04 19:18:03.716 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-04 19:18:03.719 +07:00 [INF] HTTP GET /api/Users/-9 responded 401 in 57.6452 ms
2025-05-04 19:18:03.726 +07:00 [DBG] Connection id "0HNCB0M1ATHK0" completed keep alive response.
2025-05-04 19:18:03.728 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/-9 - 401 0 null 137.8999ms
2025-05-04 19:19:04.341 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 71
2025-05-04 19:19:04.350 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 19:19:04.355 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 19:19:04.362 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 19:19:04.366 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 19:19:04.375 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 19:19:04.382 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 19:19:04.419 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 19:19:04.426 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 19:19:04.430 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 19:19:04.433 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 19:19:04.436 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 19:19:04.438 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 19:19:04.441 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 19:19:04.558 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-05-04 19:19:04.589 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 19:19:04.597 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 19:19:04.603 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 19:19:04.609 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 19:19:04.633 +07:00 [DBG] Connection id "0HNCB0M1ATHK0", Request id "0HNCB0M1ATHK0:00000004": started reading request body.
2025-05-04 19:19:04.639 +07:00 [DBG] Connection id "0HNCB0M1ATHK0", Request id "0HNCB0M1ATHK0:00000004": done reading request body.
2025-05-04 19:19:04.655 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 19:19:04.660 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 19:19:04.664 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 19:19:04.670 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 19:19:04.686 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 19:19:05.200 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'OrderDetail'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 19:19:05.204 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'Review'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 19:19:05.365 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 19:19:05.447 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .FirstOrDefault(u => u.Email == __email_0)'
2025-05-04 19:19:05.558 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-04 19:19:05.845 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE u.email == @__email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE u.email == @__email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            Role entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<Email>k__BackingField = dataReader.GetString(2);
                                    instance.<FullName>k__BackingField = dataReader.GetString(3);
                                    instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(4);
                                    instance.<Password>k__BackingField = dataReader.GetString(5);
                                    instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                    instance.<Phone>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(8) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(8);
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(9);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                Role instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(Role);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(11) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (Role)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                            {
                                return 
                                {
                                    Role instance;
                                    instance = new Role();
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                    instance.<RoleName>k__BackingField = dataReader.GetString(12);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Role)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
                fixup: (namelessParameter{8}, namelessParameter{9}) => 
                {
                    namelessParameter{8}.<Role>k__BackingField = namelessParameter{9};
                    return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                        entity: namelessParameter{9}, 
                        value: namelessParameter{8}, 
                        forMaterialization: True);
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-04 19:19:05.942 +07:00 [DBG] Creating DbConnection.
2025-05-04 19:19:05.966 +07:00 [DBG] Created DbConnection. (21ms).
2025-05-04 19:19:05.979 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:19:06.195 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:19:06.211 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 19:19:06.226 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (12ms).
2025-05-04 19:19:06.240 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (30ms).
2025-05-04 19:19:06.256 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 19:19:06.334 +07:00 [INF] Executed DbCommand (77ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 19:19:06.405 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:19:06.490 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:19:06.506 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:19:06.527 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:19:06.548 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 188ms reading results.
2025-05-04 19:19:06.563 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:19:06.585 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (22ms).
2025-05-04 19:19:07.134 +07:00 [INF] User nguyetnkhuyen@gmail.com logged in successfully
2025-05-04 19:19:07.140 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 19:19:07.147 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 19:19:07.150 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 19:19:07.151 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 19:19:07.155 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 19:19:07.158 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType6`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 19:19:07.192 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 2745.7499ms
2025-05-04 19:19:07.197 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 19:19:07.203 +07:00 [INF] HTTP POST /api/Auth/login responded 200 in 2837.0313 ms
2025-05-04 19:19:07.208 +07:00 [DBG] Connection id "0HNCB0M1ATHK0" completed keep alive response.
2025-05-04 19:19:07.214 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 19:19:07.225 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:19:07.231 +07:00 [DBG] Disposed connection to database '' on server '' (6ms).
2025-05-04 19:19:07.237 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 200 null application/json; charset=utf-8 2896.1906ms
2025-05-04 19:19:45.816 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/-9 - null null
2025-05-04 19:19:45.821 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/-9'
2025-05-04 19:19:45.823 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/-9'
2025-05-04 19:19:45.827 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:19:45.831 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 19:19:45.881 +07:00 [DBG] Successfully validated the token.
2025-05-04 19:19:45.894 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 19:19:45.903 +07:00 [DBG] Authorization was successful.
2025-05-04 19:19:45.907 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:19:45.918 +07:00 [INF] Route matched with {action = "GetById", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 19:19:45.928 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 19:19:45.937 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 19:19:45.947 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 19:19:45.956 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 19:19:45.966 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 19:19:45.973 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:19:45.983 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:19:45.992 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 19:19:46.001 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 19:19:46.009 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 19:19:46.017 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 19:19:46.023 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 19:19:46.032 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 19:19:46.043 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 19:19:46.056 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 19:19:46.062 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 19:19:46.068 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 19:19:46.073 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 19:19:46.081 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 19:19:46.093 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument) in 120.1892ms
2025-05-04 19:19:46.100 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:19:46.106 +07:00 [INF] HTTP GET /api/Users/-9 responded 400 in 274.8589 ms
2025-05-04 19:19:46.115 +07:00 [DBG] Connection id "0HNCB0M1ATHK0" completed keep alive response.
2025-05-04 19:19:46.121 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/-9 - 400 null application/json; charset=utf-8 304.6157ms
2025-05-04 19:19:51.960 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/1 - null null
2025-05-04 19:19:51.966 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1'
2025-05-04 19:19:51.967 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/1'
2025-05-04 19:19:51.973 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:19:51.978 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 19:19:51.981 +07:00 [DBG] Successfully validated the token.
2025-05-04 19:19:51.984 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 19:19:51.991 +07:00 [DBG] Authorization was successful.
2025-05-04 19:19:51.995 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:19:52.000 +07:00 [INF] Route matched with {action = "GetById", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 19:19:52.007 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 19:19:52.011 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 19:19:52.014 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 19:19:52.016 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 19:19:52.018 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 19:19:52.020 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:19:52.027 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:19:52.029 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 19:19:52.031 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 19:19:52.033 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 19:19:52.034 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 19:19:52.036 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 19:19:52.039 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 19:19:52.058 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 19:19:52.068 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .Include(u => u.Userprofile)
    .FirstOrDefault(u => u.UserId == __userId_0)'
2025-05-04 19:19:52.076 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-04 19:19:52.082 +07:00 [DBG] Including navigation: 'User.Userprofile'.
2025-05-04 19:19:52.124 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
                2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName, u0.userprofileId, u0.address, u0.birth, u0.userId
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            LEFT JOIN userprofiles AS u0 ON u.userId == u0.userId
            WHERE u.userId == @__userId_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
                2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName, u0.userprofileId, u0.address, u0.birth, u0.userId
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            LEFT JOIN userprofiles AS u0 ON u.userId == u0.userId
            WHERE u.userId == @__userId_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            Role entity;
            Userprofile entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<Email>k__BackingField = dataReader.GetString(2);
                                    instance.<FullName>k__BackingField = dataReader.GetString(3);
                                    instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(4);
                                    instance.<Password>k__BackingField = dataReader.GetString(5);
                                    instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                    instance.<Phone>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(8) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(8);
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(9);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                Role instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(Role);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(11) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (Role)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                            {
                                return 
                                {
                                    Role instance;
                                    instance = new Role();
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                    instance.<RoleName>k__BackingField = dataReader.GetString(12);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Role)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            entity = 
            {
                MaterializationContext materializationContext3;
                IEntityType entityType3;
                Userprofile instance3;
                InternalEntityEntry entry3;
                bool hasNullKey3;
                materializationContext3 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance3 = default(Userprofile);
                entry3 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Userprofile.UserprofileId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(13) ? default(object) : (object)dataReader.GetInt32(13) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey3);
                !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
                {
                    entityType3 = entry3.EntityType;
                    return instance3 = (Userprofile)entry3.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot3;
                    shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType3 = [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")];
                    instance3 = switch (entityType3)
                    {
                        case [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]: 
                            {
                                return 
                                {
                                    Userprofile instance;
                                    instance = new Userprofile();
                                    instance.<UserprofileId>k__BackingField = dataReader.IsDBNull(13) ? default(int) : dataReader.GetInt32(13);
                                    instance.<Address>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                    instance.<Birth>k__BackingField = dataReader.IsDBNull(15) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(15);
                                    instance.<UserId>k__BackingField = dataReader.IsDBNull(16) ? default(int) : dataReader.GetInt32(16);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext3.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Userprofile)
                    }
                    ;
                    entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType3, 
                        entity: instance3, 
                        snapshot: shadowSnapshot3);
                    return instance3;
                } : default(void);
                return instance3;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
                fixup: (namelessParameter{11}, namelessParameter{12}) => 
                {
                    namelessParameter{11}.<Role>k__BackingField = namelessParameter{12};
                    return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                        entity: namelessParameter{12}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                }, 
                trackingQuery: True);
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Userprofile>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Userprofile (Userprofile) ToDependent Userprofile Inverse: User | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Userprofile")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Userprofile.User (User) ToPrincipal User Inverse: Userprofile | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindNavigation("User")], 
                fixup: (namelessParameter{16}, namelessParameter{17}) => 
                {
                    namelessParameter{16}.<Userprofile>k__BackingField = namelessParameter{17};
                    return namelessParameter{17}.<User>k__BackingField = namelessParameter{16};
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-04 19:19:52.194 +07:00 [DBG] Creating DbConnection.
2025-05-04 19:19:52.196 +07:00 [DBG] Created DbConnection. (1ms).
2025-05-04 19:19:52.197 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:19:52.199 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:19:52.201 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 19:19:52.202 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-04 19:19:52.205 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-05-04 19:19:52.209 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 19:19:52.228 +07:00 [INF] Executed DbCommand (20ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 19:19:52.235 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:19:52.238 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:19:52.241 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:19:52.246 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:19:52.248 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 13ms reading results.
2025-05-04 19:19:52.250 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:19:52.251 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 19:19:52.256 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 19:19:52.260 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 19:19:52.261 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 19:19:52.263 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 19:19:52.264 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 19:19:52.265 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO'.
2025-05-04 19:19:52.284 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument) in 263.6432ms
2025-05-04 19:19:52.290 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:19:52.293 +07:00 [INF] HTTP GET /api/Users/1 responded 200 in 315.6683 ms
2025-05-04 19:19:52.296 +07:00 [DBG] Connection id "0HNCB0M1ATHK0" completed keep alive response.
2025-05-04 19:19:52.299 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 19:19:52.301 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:19:52.303 +07:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-05-04 19:19:52.308 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/1 - 200 null application/json; charset=utf-8 347.7607ms
2025-05-04 19:20:02.860 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/3 - null null
2025-05-04 19:20:02.864 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/3'
2025-05-04 19:20:02.866 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/3'
2025-05-04 19:20:02.871 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:20:02.875 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 19:20:02.877 +07:00 [DBG] Successfully validated the token.
2025-05-04 19:20:02.879 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 19:20:02.882 +07:00 [DBG] Authorization was successful.
2025-05-04 19:20:02.885 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:20:02.931 +07:00 [INF] Route matched with {action = "GetById", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 19:20:02.936 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 19:20:02.945 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 19:20:02.947 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 19:20:02.949 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 19:20:02.952 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 19:20:02.956 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:20:02.962 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:20:02.965 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 19:20:02.966 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 19:20:02.969 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 19:20:02.972 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 19:20:02.975 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 19:20:02.977 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 19:20:03.050 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 19:20:03.059 +07:00 [DBG] Creating DbConnection.
2025-05-04 19:20:03.061 +07:00 [DBG] Created DbConnection. (1ms).
2025-05-04 19:20:03.063 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:20:03.064 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:20:03.066 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 19:20:03.067 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-04 19:20:03.069 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-05-04 19:20:03.072 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 19:20:03.079 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 19:20:03.084 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:20:03.086 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:20:03.089 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:20:03.100 +07:00 [DBG] The navigation 'User.Userprofile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:20:03.102 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Userprofile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:20:03.113 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:20:03.115 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 31ms reading results.
2025-05-04 19:20:03.117 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:20:03.119 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (2ms).
2025-05-04 19:20:03.124 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 19:20:03.128 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 19:20:03.129 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 19:20:03.130 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 19:20:03.132 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 19:20:03.135 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO'.
2025-05-04 19:20:03.140 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument) in 183.3248ms
2025-05-04 19:20:03.142 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:20:03.145 +07:00 [INF] HTTP GET /api/Users/3 responded 200 in 269.6353 ms
2025-05-04 19:20:03.148 +07:00 [DBG] Connection id "0HNCB0M1ATHK0" completed keep alive response.
2025-05-04 19:20:03.150 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 19:20:03.152 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:20:03.155 +07:00 [DBG] Disposed connection to database '' on server '' (3ms).
2025-05-04 19:20:03.157 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/3 - 200 null application/json; charset=utf-8 297.4714ms
2025-05-04 19:21:22.733 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=10 - null null
2025-05-04 19:21:22.742 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users'
2025-05-04 19:21:22.751 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)' with route pattern 'api/Users' is valid for the request path '/api/Users'
2025-05-04 19:21:22.758 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 19:21:22.765 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 19:21:22.770 +07:00 [DBG] Successfully validated the token.
2025-05-04 19:21:22.776 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 19:21:22.784 +07:00 [DBG] Authorization was successful.
2025-05-04 19:21:22.788 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 19:21:22.801 +07:00 [INF] Route matched with {action = "GetAll", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Int32, Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 19:21:22.809 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 19:21:22.817 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 19:21:22.824 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 19:21:22.830 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 19:21:22.838 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 19:21:22.841 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:21:22.845 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:21:22.858 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 19:21:22.864 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' using the name 'pageNumber' in request data ...
2025-05-04 19:21:22.867 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 19:21:22.869 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 19:21:22.871 +07:00 [DBG] Attempting to validate the bound parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 19:21:22.873 +07:00 [DBG] Done attempting to validate the bound parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 19:21:22.875 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 19:21:22.880 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' using the name 'pageSize' in request data ...
2025-05-04 19:21:22.886 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 19:21:22.887 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 19:21:22.889 +07:00 [DBG] Attempting to validate the bound parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 19:21:22.891 +07:00 [DBG] Done attempting to validate the bound parameter 'pageSize' of type 'System.Int32'.
2025-05-04 19:21:22.901 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 19:21:22.910 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-05-04 19:21:22.932 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: SingleQueryingEnumerable.Create<int>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM users AS u) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM users AS u, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            int? value1;
            value1 = dataReader.IsDBNull(0) ? default(int?) : (int?)dataReader.GetInt32(0);
            return (int)value1;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-04 19:21:22.950 +07:00 [DBG] Creating DbConnection.
2025-05-04 19:21:22.952 +07:00 [DBG] Created DbConnection. (1ms).
2025-05-04 19:21:22.955 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:21:22.958 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:21:22.962 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 19:21:22.964 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-05-04 19:21:22.966 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-05-04 19:21:22.968 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [users] AS [u]
2025-05-04 19:21:22.977 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [users] AS [u]
2025-05-04 19:21:22.984 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:21:22.986 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 3ms reading results.
2025-05-04 19:21:22.988 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:21:22.990 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 19:21:23.002 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .Include(u => u.Userprofile)
    .OrderBy(u => u.UserId)
    .Skip(__p_0)
    .Take(__p_1)'
2025-05-04 19:21:23.006 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-04 19:21:23.008 +07:00 [DBG] Including navigation: 'User.Userprofile'.
2025-05-04 19:21:23.037 +07:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<User>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
            1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
        SELECT u0.userId, u0.CreatedAt, u0.email, u0.fullName, u0.IsEmailVerified, u0.password, u0.PasswordResetToken, u0.phone, u0.ResetTokenExpires, u0.roleId, u0.UpdatedAt, r.roleId, r.roleName, u1.userprofileId, u1.address, u1.birth, u1.userId
        FROM 
        (
            SELECT u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt
            FROM users AS u
            ORDER BY u.userId ASC
            OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
        ) AS u0
        INNER JOIN roles AS r ON u0.roleId == r.roleId
        LEFT JOIN userprofiles AS u1 ON u0.userId == u1.userId
        ORDER BY u0.userId ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
            1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
        SELECT u0.userId, u0.CreatedAt, u0.email, u0.fullName, u0.IsEmailVerified, u0.password, u0.PasswordResetToken, u0.phone, u0.ResetTokenExpires, u0.roleId, u0.UpdatedAt, r.roleId, r.roleName, u1.userprofileId, u1.address, u1.birth, u1.userId
        FROM 
        (
            SELECT u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt
            FROM users AS u
            ORDER BY u.userId ASC
            OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
        ) AS u0
        INNER JOIN roles AS r ON u0.roleId == r.roleId
        LEFT JOIN userprofiles AS u1 ON u0.userId == u1.userId
        ORDER BY u0.userId ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        User entity;
        Role entity;
        Userprofile entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            User instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(User);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (User)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                        {
                            return 
                            {
                                User instance;
                                instance = new User();
                                instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                instance.<Email>k__BackingField = dataReader.GetString(2);
                                instance.<FullName>k__BackingField = dataReader.GetString(3);
                                instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(4);
                                instance.<Password>k__BackingField = dataReader.GetString(5);
                                instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                instance.<Phone>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(8) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(8);
                                instance.<RoleId>k__BackingField = dataReader.GetInt32(9);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(User)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        entity = 
        {
            MaterializationContext materializationContext2;
            IEntityType entityType2;
            Role instance2;
            InternalEntityEntry entry2;
            bool hasNullKey2;
            materializationContext2 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance2 = default(Role);
            entry2 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(11) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey2);
            !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
            {
                entityType2 = entry2.EntityType;
                return instance2 = (Role)entry2.Entity;
            } : 
            {
                ISnapshot shadowSnapshot2;
                shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                instance2 = switch (entityType2)
                {
                    case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                        {
                            return 
                            {
                                Role instance;
                                instance = new Role();
                                instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                instance.<RoleName>k__BackingField = dataReader.GetString(12);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext2.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Role)
                }
                ;
                entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType2, 
                    entity: instance2, 
                    snapshot: shadowSnapshot2);
                return instance2;
            } : default(void);
            return instance2;
        };
        entity = 
        {
            MaterializationContext materializationContext3;
            IEntityType entityType3;
            Userprofile instance3;
            InternalEntityEntry entry3;
            bool hasNullKey3;
            materializationContext3 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance3 = default(Userprofile);
            entry3 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Userprofile.UserprofileId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindPrimaryKey()], 
                keyValues: new object[]{ dataReader.IsDBNull(13) ? default(object) : (object)dataReader.GetInt32(13) }, 
                throwOnNullKey: False, 
                hasNullKey: hasNullKey3);
            !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
            {
                entityType3 = entry3.EntityType;
                return instance3 = (Userprofile)entry3.Entity;
            } : 
            {
                ISnapshot shadowSnapshot3;
                shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType3 = [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")];
                instance3 = switch (entityType3)
                {
                    case [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]: 
                        {
                            return 
                            {
                                Userprofile instance;
                                instance = new Userprofile();
                                instance.<UserprofileId>k__BackingField = dataReader.IsDBNull(13) ? default(int) : dataReader.GetInt32(13);
                                instance.<Address>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                instance.<Birth>k__BackingField = dataReader.IsDBNull(15) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(15);
                                instance.<UserId>k__BackingField = dataReader.IsDBNull(16) ? default(int) : dataReader.GetInt32(16);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext3.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Userprofile)
                }
                ;
                entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType3, 
                    entity: instance3, 
                    snapshot: shadowSnapshot3);
                return instance3;
            } : default(void);
            return instance3;
        };
        ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
            fixup: (namelessParameter{11}, namelessParameter{12}) => 
            {
                namelessParameter{11}.<Role>k__BackingField = namelessParameter{12};
                return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                    entity: namelessParameter{12}, 
                    value: namelessParameter{11}, 
                    forMaterialization: True);
            }, 
            trackingQuery: True);
        ShaperProcessingExpressionVisitor.IncludeReference<User, User, Userprofile>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: User.Userprofile (Userprofile) ToDependent Userprofile Inverse: User | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Userprofile")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Userprofile.User (User) ToPrincipal User Inverse: Userprofile | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindNavigation("User")], 
            fixup: (namelessParameter{16}, namelessParameter{17}) => 
            {
                namelessParameter{16}.<Userprofile>k__BackingField = namelessParameter{17};
                return namelessParameter{17}.<User>k__BackingField = namelessParameter{16};
            }, 
            trackingQuery: True);
        return entity;
    }, 
    contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-05-04 19:21:23.087 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:21:23.089 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:21:23.091 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 19:21:23.094 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-05-04 19:21:23.097 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2025-05-04 19:21:23.098 +07:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[userId], [u0].[CreatedAt], [u0].[email], [u0].[fullName], [u0].[IsEmailVerified], [u0].[password], [u0].[PasswordResetToken], [u0].[phone], [u0].[ResetTokenExpires], [u0].[roleId], [u0].[UpdatedAt], [r].[roleId], [r].[roleName], [u1].[userprofileId], [u1].[address], [u1].[birth], [u1].[userId]
FROM (
    SELECT [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
    FROM [users] AS [u]
    ORDER BY [u].[userId]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [roles] AS [r] ON [u0].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u1] ON [u0].[userId] = [u1].[userId]
ORDER BY [u0].[userId]
2025-05-04 19:21:23.113 +07:00 [INF] Executed DbCommand (14ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[userId], [u0].[CreatedAt], [u0].[email], [u0].[fullName], [u0].[IsEmailVerified], [u0].[password], [u0].[PasswordResetToken], [u0].[phone], [u0].[ResetTokenExpires], [u0].[roleId], [u0].[UpdatedAt], [r].[roleId], [r].[roleName], [u1].[userprofileId], [u1].[address], [u1].[birth], [u1].[userId]
FROM (
    SELECT [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
    FROM [users] AS [u]
    ORDER BY [u].[userId]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [roles] AS [r] ON [u0].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u1] ON [u0].[userId] = [u1].[userId]
ORDER BY [u0].[userId]
2025-05-04 19:21:23.119 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:21:23.121 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:21:23.123 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:21:23.127 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:21:23.131 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:21:23.134 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:21:23.135 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:21:23.137 +07:00 [DBG] The navigation 'User.Userprofile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:21:23.138 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Userprofile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:21:23.140 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:21:23.142 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 23ms reading results.
2025-05-04 19:21:23.146 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:21:23.148 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (2ms).
2025-05-04 19:21:23.152 +07:00 [INF] Admin fetched users page 1 with size 10
2025-05-04 19:21:23.153 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 19:21:23.156 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 19:21:23.157 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 19:21:23.159 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 19:21:23.161 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 19:21:23.164 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.PagedResponseDTO`1[[ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO, ExchangeDocument, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 19:21:23.173 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument) in 332.334ms
2025-05-04 19:21:23.177 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 19:21:23.180 +07:00 [INF] HTTP GET /api/Users responded 200 in 415.5174 ms
2025-05-04 19:21:23.184 +07:00 [DBG] Connection id "0HNCB0M1ATHK0" completed keep alive response.
2025-05-04 19:21:23.185 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 19:21:23.187 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:21:23.189 +07:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-05-04 19:21:23.191 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=10 - 200 null application/json; charset=utf-8 457.8602ms
2025-05-04 19:23:34.202 +07:00 [DBG] Connection id "0HNCB0M1ATHK0" disconnecting.
2025-05-04 19:23:34.205 +07:00 [DBG] Connection id "0HNCB0M1ATHK0" stopped.
2025-05-04 19:23:34.209 +07:00 [DBG] Connection id "0HNCB0M1ATHK0" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 19:23:53.135 +07:00 [DBG] Connection id "0HNCB0M1ATHK2" accepted.
2025-05-04 19:23:53.137 +07:00 [DBG] Connection id "0HNCB0M1ATHK2" started.
2025-05-04 19:23:53.140 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/3 - null null
2025-05-04 19:23:53.146 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/3'
2025-05-04 19:23:53.150 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/3'
2025-05-04 19:23:53.156 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:23:53.160 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 19:23:53.165 +07:00 [DBG] Successfully validated the token.
2025-05-04 19:23:53.171 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 19:23:53.178 +07:00 [DBG] Authorization was successful.
2025-05-04 19:23:53.182 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:23:53.189 +07:00 [INF] Route matched with {action = "GetById", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 19:23:53.202 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 19:23:53.208 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 19:23:53.217 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 19:23:53.225 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 19:23:53.234 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 19:23:53.241 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:23:53.250 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:23:53.258 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 19:23:53.265 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 19:23:53.272 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 19:23:53.279 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 19:23:53.283 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 19:23:53.286 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 19:23:53.290 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 19:23:53.295 +07:00 [DBG] Creating DbConnection.
2025-05-04 19:23:53.299 +07:00 [DBG] Created DbConnection. (4ms).
2025-05-04 19:23:53.304 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:23:53.308 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:23:53.314 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 19:23:53.320 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2025-05-04 19:23:53.323 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (8ms).
2025-05-04 19:23:53.326 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 19:23:53.339 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 19:23:53.346 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:23:53.348 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:23:53.350 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:23:53.353 +07:00 [DBG] The navigation 'User.Userprofile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:23:53.354 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Userprofile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:23:53.358 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:23:53.361 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 15ms reading results.
2025-05-04 19:23:53.363 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:23:53.364 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 19:23:53.366 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 19:23:53.369 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 19:23:53.370 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 19:23:53.371 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 19:23:53.373 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 19:23:53.376 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO'.
2025-05-04 19:23:53.378 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument) in 137.3801ms
2025-05-04 19:23:53.381 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:23:53.382 +07:00 [INF] HTTP GET /api/Users/3 responded 200 in 222.4603 ms
2025-05-04 19:23:53.384 +07:00 [DBG] Connection id "0HNCB0M1ATHK2" completed keep alive response.
2025-05-04 19:23:53.385 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 19:23:53.387 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:23:53.388 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 19:23:53.390 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/3 - 200 null application/json; charset=utf-8 250.1381ms
2025-05-04 19:26:05.266 +07:00 [DBG] Connection id "0HNCB0M1ATHK2" disconnecting.
2025-05-04 19:26:05.269 +07:00 [DBG] Connection id "0HNCB0M1ATHK2" stopped.
2025-05-04 19:26:05.272 +07:00 [DBG] Connection id "0HNCB0M1ATHK2" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 19:31:55.549 +07:00 [INF] Application is shutting down...
2025-05-04 19:31:55.550 +07:00 [DBG] Hosting stopping
2025-05-04 19:31:55.561 +07:00 [DBG] Hosting stopped
2025-05-04 19:32:08.377 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-05-04 19:32:08.516 +07:00 [DBG] Hosting starting
2025-05-04 19:32:08.535 +07:00 [INF] User profile is available. Using 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-04 19:32:08.558 +07:00 [DBG] Reading data from file 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys\key-1a51a872-ea43-4350-815f-0422835a65dd.xml'.
2025-05-04 19:32:08.574 +07:00 [DBG] Found key {1a51a872-ea43-4350-815f-0422835a65dd}.
2025-05-04 19:32:08.590 +07:00 [DBG] Considering key {1a51a872-ea43-4350-815f-0422835a65dd} with expiration date 2025-07-05 19:31:04Z as default key.
2025-05-04 19:32:08.598 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 19:32:08.605 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-05-04 19:32:08.608 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 19:32:08.619 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-05-04 19:32:08.622 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-05-04 19:32:08.625 +07:00 [DBG] Using key {1a51a872-ea43-4350-815f-0422835a65dd} as the default key.
2025-05-04 19:32:08.629 +07:00 [DBG] Key ring with default key {1a51a872-ea43-4350-815f-0422835a65dd} was loaded during application startup.
2025-05-04 19:32:08.697 +07:00 [INF] Now listening on: http://localhost:5120
2025-05-04 19:32:08.698 +07:00 [DBG] Loaded hosting startup assembly ExchangeDocument
2025-05-04 19:32:08.700 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-04 19:32:08.701 +07:00 [INF] Hosting environment: Development
2025-05-04 19:32:08.702 +07:00 [INF] Content root path: D:\Gộp module Auth\ExchangeDocument(Tự làm Auth_User) - Đã làm logout(2)\ExchangeDocument
2025-05-04 19:32:08.703 +07:00 [DBG] Hosting started
2025-05-04 19:32:12.172 +07:00 [DBG] Connection id "0HNCB0UOTUU4M" accepted.
2025-05-04 19:32:12.179 +07:00 [DBG] Connection id "0HNCB0UOTUU4N" accepted.
2025-05-04 19:32:12.179 +07:00 [DBG] Connection id "0HNCB0UOTUU4M" started.
2025-05-04 19:32:12.181 +07:00 [DBG] Connection id "0HNCB0UOTUU4N" started.
2025-05-04 19:32:12.237 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/index.html - null null
2025-05-04 19:32:12.248 +07:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-05-04 19:32:12.279 +07:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-05-04 19:32:12.283 +07:00 [DBG] Request did not match any endpoints
2025-05-04 19:32:12.431 +07:00 [INF] HTTP GET /swagger/index.html responded 200 in 141.5581 ms
2025-05-04 19:32:12.437 +07:00 [DBG] Connection id "0HNCB0UOTUU4M" completed keep alive response.
2025-05-04 19:32:12.443 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/index.html - 200 null text/html;charset=utf-8 207.694ms
2025-05-04 19:32:13.122 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - null null
2025-05-04 19:32:13.133 +07:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-05-04 19:32:13.136 +07:00 [DBG] Request did not match any endpoints
2025-05-04 19:32:13.443 +07:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 304.0820 ms
2025-05-04 19:32:13.447 +07:00 [DBG] Connection id "0HNCB0UOTUU4M" completed keep alive response.
2025-05-04 19:32:13.449 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 327.6491ms
2025-05-04 19:33:48.920 +07:00 [DBG] Connection id "0HNCB0UOTUU4N" received FIN.
2025-05-04 19:33:48.924 +07:00 [DBG] Connection id "0HNCB0UOTUU4N" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 19:33:48.927 +07:00 [DBG] Connection id "0HNCB0UOTUU4N" disconnecting.
2025-05-04 19:33:48.935 +07:00 [DBG] Connection id "0HNCB0UOTUU4N" stopped.
2025-05-04 19:34:23.733 +07:00 [DBG] Connection id "0HNCB0UOTUU4M" disconnecting.
2025-05-04 19:34:23.740 +07:00 [DBG] Connection id "0HNCB0UOTUU4M" stopped.
2025-05-04 19:34:23.744 +07:00 [DBG] Connection id "0HNCB0UOTUU4M" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 19:36:28.138 +07:00 [INF] Application is shutting down...
2025-05-04 19:36:28.140 +07:00 [DBG] Hosting stopping
2025-05-04 19:36:28.155 +07:00 [DBG] Hosting stopped
2025-05-04 19:40:45.197 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-05-04 19:40:45.300 +07:00 [DBG] Hosting starting
2025-05-04 19:40:45.316 +07:00 [INF] User profile is available. Using 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-04 19:40:45.334 +07:00 [DBG] Reading data from file 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys\key-1a51a872-ea43-4350-815f-0422835a65dd.xml'.
2025-05-04 19:40:45.347 +07:00 [DBG] Found key {1a51a872-ea43-4350-815f-0422835a65dd}.
2025-05-04 19:40:45.357 +07:00 [DBG] Considering key {1a51a872-ea43-4350-815f-0422835a65dd} with expiration date 2025-07-05 19:31:04Z as default key.
2025-05-04 19:40:45.364 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 19:40:45.373 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-05-04 19:40:45.378 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 19:40:45.389 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-05-04 19:40:45.395 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-05-04 19:40:45.401 +07:00 [DBG] Using key {1a51a872-ea43-4350-815f-0422835a65dd} as the default key.
2025-05-04 19:40:45.406 +07:00 [DBG] Key ring with default key {1a51a872-ea43-4350-815f-0422835a65dd} was loaded during application startup.
2025-05-04 19:40:45.448 +07:00 [INF] Now listening on: http://localhost:5120
2025-05-04 19:40:45.454 +07:00 [DBG] Loaded hosting startup assembly ExchangeDocument
2025-05-04 19:40:45.459 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-04 19:40:45.463 +07:00 [INF] Hosting environment: Development
2025-05-04 19:40:45.465 +07:00 [INF] Content root path: D:\Gộp module Auth\ExchangeDocument(Tự làm Auth_User) - Đã làm logout(2)\ExchangeDocument
2025-05-04 19:40:45.466 +07:00 [DBG] Hosting started
2025-05-04 19:40:47.834 +07:00 [DBG] Connection id "0HNCB13IJMHKS" accepted.
2025-05-04 19:40:47.843 +07:00 [DBG] Connection id "0HNCB13IJMHKS" started.
2025-05-04 19:40:47.844 +07:00 [DBG] Connection id "0HNCB13IJMHKT" accepted.
2025-05-04 19:40:47.852 +07:00 [DBG] Connection id "0HNCB13IJMHKT" started.
2025-05-04 19:40:47.881 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/index.html - null null
2025-05-04 19:40:47.895 +07:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-05-04 19:40:47.911 +07:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-05-04 19:40:47.917 +07:00 [DBG] Request did not match any endpoints
2025-05-04 19:40:48.000 +07:00 [INF] HTTP GET /swagger/index.html responded 200 in 76.1521 ms
2025-05-04 19:40:48.012 +07:00 [DBG] Connection id "0HNCB13IJMHKS" completed keep alive response.
2025-05-04 19:40:48.016 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/index.html - 200 null text/html;charset=utf-8 136.5085ms
2025-05-04 19:40:48.232 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - null null
2025-05-04 19:40:48.236 +07:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-05-04 19:40:48.238 +07:00 [DBG] Request did not match any endpoints
2025-05-04 19:40:48.424 +07:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 184.2053 ms
2025-05-04 19:40:48.427 +07:00 [DBG] Connection id "0HNCB13IJMHKS" completed keep alive response.
2025-05-04 19:40:48.430 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 198.0456ms
2025-05-04 19:40:48.606 +07:00 [DBG] Connection id "0HNCB13IJMHKT" received FIN.
2025-05-04 19:40:48.607 +07:00 [DBG] Connection id "0HNCB13IJMHKS" received FIN.
2025-05-04 19:40:48.610 +07:00 [DBG] Connection id "0HNCB13IJMHKT" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 19:40:48.610 +07:00 [DBG] Connection id "0HNCB13IJMHKS" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 19:40:48.614 +07:00 [DBG] Connection id "0HNCB13IJMHKT" disconnecting.
2025-05-04 19:40:48.615 +07:00 [DBG] Connection id "0HNCB13IJMHKS" disconnecting.
2025-05-04 19:40:48.619 +07:00 [DBG] Connection id "0HNCB13IJMHKT" stopped.
2025-05-04 19:40:48.619 +07:00 [DBG] Connection id "0HNCB13IJMHKS" stopped.
2025-05-04 19:40:56.819 +07:00 [DBG] Connection id "0HNCB13IJMHKU" accepted.
2025-05-04 19:40:56.821 +07:00 [DBG] Connection id "0HNCB13IJMHKU" started.
2025-05-04 19:40:56.823 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/me - null null
2025-05-04 19:40:56.836 +07:00 [DBG] 2 candidate(s) found for the request path '/api/Users/me'
2025-05-04 19:40:56.846 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 19:40:56.856 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/me'
2025-05-04 19:40:56.860 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 19:40:56.866 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 19:40:56.869 +07:00 [WRN] Failed to determine the https port for redirect.
2025-05-04 19:40:56.893 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 19:40:56.898 +07:00 [DBG] Policy authentication schemes  did not succeed
2025-05-04 19:40:56.900 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-04 19:40:56.904 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-04 19:40:56.905 +07:00 [INF] HTTP GET /api/Users/me responded 401 in 40.4151 ms
2025-05-04 19:40:56.908 +07:00 [DBG] Connection id "0HNCB13IJMHKU" completed keep alive response.
2025-05-04 19:40:56.910 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/me - 401 0 null 87.0187ms
2025-05-04 19:41:01.184 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/me - null null
2025-05-04 19:41:01.192 +07:00 [DBG] 2 candidate(s) found for the request path '/api/Users/me'
2025-05-04 19:41:01.193 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 19:41:01.195 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/me'
2025-05-04 19:41:01.202 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 19:41:01.206 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 19:41:01.211 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 19:41:01.216 +07:00 [DBG] Policy authentication schemes  did not succeed
2025-05-04 19:41:01.219 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-04 19:41:01.221 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-04 19:41:01.222 +07:00 [INF] HTTP GET /api/Users/me responded 401 in 16.9471 ms
2025-05-04 19:41:01.226 +07:00 [DBG] Connection id "0HNCB13IJMHKU" completed keep alive response.
2025-05-04 19:41:01.229 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/me - 401 0 null 44.4866ms
2025-05-04 19:41:21.418 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 64
2025-05-04 19:41:21.422 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 19:41:21.424 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 19:41:21.426 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 19:41:21.428 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 19:41:21.431 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 19:41:21.441 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 19:41:21.466 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 19:41:21.470 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 19:41:21.474 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 19:41:21.477 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 19:41:21.481 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 19:41:21.483 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 19:41:21.486 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 19:41:21.552 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-05-04 19:41:21.569 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 19:41:21.574 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 19:41:21.580 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 19:41:21.582 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 19:41:21.597 +07:00 [DBG] Connection id "0HNCB13IJMHKU", Request id "0HNCB13IJMHKU:00000003": started reading request body.
2025-05-04 19:41:21.598 +07:00 [DBG] Connection id "0HNCB13IJMHKU", Request id "0HNCB13IJMHKU:00000003": done reading request body.
2025-05-04 19:41:21.611 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 19:41:21.613 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 19:41:21.615 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 19:41:21.617 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 19:41:21.626 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 19:41:21.996 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'OrderDetail'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 19:41:21.998 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'Review'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 19:41:22.123 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 19:41:22.170 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .FirstOrDefault(u => u.Email == __email_0)'
2025-05-04 19:41:22.227 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-04 19:41:22.417 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE u.email == @__email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE u.email == @__email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            Role entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<Email>k__BackingField = dataReader.GetString(2);
                                    instance.<FullName>k__BackingField = dataReader.GetString(3);
                                    instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(4);
                                    instance.<Password>k__BackingField = dataReader.GetString(5);
                                    instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                    instance.<Phone>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(8) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(8);
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(9);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                Role instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(Role);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(11) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (Role)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                            {
                                return 
                                {
                                    Role instance;
                                    instance = new Role();
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                    instance.<RoleName>k__BackingField = dataReader.GetString(12);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Role)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
                fixup: (namelessParameter{8}, namelessParameter{9}) => 
                {
                    namelessParameter{8}.<Role>k__BackingField = namelessParameter{9};
                    return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                        entity: namelessParameter{9}, 
                        value: namelessParameter{8}, 
                        forMaterialization: True);
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-04 19:41:22.476 +07:00 [DBG] Creating DbConnection.
2025-05-04 19:41:22.491 +07:00 [DBG] Created DbConnection. (12ms).
2025-05-04 19:41:22.495 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:41:22.607 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:41:22.610 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 19:41:22.616 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-05-04 19:41:22.625 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (14ms).
2025-05-04 19:41:22.631 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 19:41:22.668 +07:00 [INF] Executed DbCommand (38ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 19:41:22.696 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:41:22.733 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:41:22.741 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:41:22.749 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:41:22.761 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 83ms reading results.
2025-05-04 19:41:22.764 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:41:22.769 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (4ms).
2025-05-04 19:41:23.041 +07:00 [WRN] Login failed: invalid password for nguyetnkhuyen@gmail.com
2025-05-04 19:41:23.048 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 19:41:23.056 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 19:41:23.058 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 19:41:23.060 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 19:41:23.062 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 19:41:23.063 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType4`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 19:41:23.079 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 1591.7034ms
2025-05-04 19:41:23.081 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 19:41:23.084 +07:00 [INF] HTTP POST /api/Auth/login responded 400 in 1656.2159 ms
2025-05-04 19:41:23.088 +07:00 [DBG] Connection id "0HNCB13IJMHKU" completed keep alive response.
2025-05-04 19:41:23.093 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 19:41:23.097 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:41:23.100 +07:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-05-04 19:41:23.103 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 400 null application/json; charset=utf-8 1684.9435ms
2025-05-04 19:41:52.509 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 71
2025-05-04 19:41:52.518 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 19:41:52.520 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 19:41:52.526 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 19:41:52.528 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 19:41:52.529 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 19:41:52.532 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 19:41:52.535 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 19:41:52.540 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 19:41:52.546 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 19:41:52.553 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 19:41:52.559 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 19:41:52.562 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 19:41:52.574 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 19:41:52.582 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 19:41:52.587 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 19:41:52.591 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 19:41:52.593 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 19:41:52.595 +07:00 [DBG] Connection id "0HNCB13IJMHKU", Request id "0HNCB13IJMHKU:00000004": started reading request body.
2025-05-04 19:41:52.597 +07:00 [DBG] Connection id "0HNCB13IJMHKU", Request id "0HNCB13IJMHKU:00000004": done reading request body.
2025-05-04 19:41:52.599 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 19:41:52.601 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 19:41:52.604 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 19:41:52.606 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 19:41:52.609 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 19:41:52.638 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 19:41:52.649 +07:00 [DBG] Creating DbConnection.
2025-05-04 19:41:52.651 +07:00 [DBG] Created DbConnection. (2ms).
2025-05-04 19:41:52.653 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:41:52.655 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:41:52.657 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 19:41:52.657 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 19:41:52.658 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 19:41:52.659 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 19:41:52.668 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 19:41:52.671 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:41:52.673 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:41:52.674 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:41:52.675 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:41:52.677 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 5ms reading results.
2025-05-04 19:41:52.678 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:41:52.679 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 19:41:52.949 +07:00 [INF] User nguyetnkhuyen@gmail.com logged in successfully
2025-05-04 19:41:52.951 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 19:41:52.955 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 19:41:52.957 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 19:41:52.958 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 19:41:52.959 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 19:41:52.960 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType6`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 19:41:52.963 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 389.687ms
2025-05-04 19:41:52.964 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 19:41:52.965 +07:00 [INF] HTTP POST /api/Auth/login responded 200 in 437.6716 ms
2025-05-04 19:41:52.967 +07:00 [DBG] Connection id "0HNCB13IJMHKU" completed keep alive response.
2025-05-04 19:41:52.968 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 19:41:52.969 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:41:52.972 +07:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-05-04 19:41:52.974 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 200 null application/json; charset=utf-8 464.5544ms
2025-05-04 19:42:26.959 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/me - null null
2025-05-04 19:42:26.966 +07:00 [DBG] 2 candidate(s) found for the request path '/api/Users/me'
2025-05-04 19:42:26.967 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 19:42:26.969 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/me'
2025-05-04 19:42:26.971 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 19:42:26.975 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 19:42:27.016 +07:00 [DBG] Successfully validated the token.
2025-05-04 19:42:27.021 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 19:42:27.024 +07:00 [DBG] Authorization was successful.
2025-05-04 19:42:27.025 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 19:42:27.034 +07:00 [INF] Route matched with {action = "GetMe", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMe() on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 19:42:27.038 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 19:42:27.040 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 19:42:27.041 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 19:42:27.043 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 19:42:27.044 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 19:42:27.046 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:42:27.051 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:42:27.105 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 19:42:27.108 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .Include(u => u.Userprofile)
    .FirstOrDefault(u => u.UserId == __userId_0)'
2025-05-04 19:42:27.110 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-04 19:42:27.114 +07:00 [DBG] Including navigation: 'User.Userprofile'.
2025-05-04 19:42:27.131 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
                2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName, u0.userprofileId, u0.address, u0.birth, u0.userId
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            LEFT JOIN userprofiles AS u0 ON u.userId == u0.userId
            WHERE u.userId == @__userId_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
                2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName, u0.userprofileId, u0.address, u0.birth, u0.userId
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            LEFT JOIN userprofiles AS u0 ON u.userId == u0.userId
            WHERE u.userId == @__userId_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            Role entity;
            Userprofile entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<Email>k__BackingField = dataReader.GetString(2);
                                    instance.<FullName>k__BackingField = dataReader.GetString(3);
                                    instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(4);
                                    instance.<Password>k__BackingField = dataReader.GetString(5);
                                    instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                    instance.<Phone>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(8) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(8);
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(9);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                Role instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(Role);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(11) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (Role)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                            {
                                return 
                                {
                                    Role instance;
                                    instance = new Role();
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                    instance.<RoleName>k__BackingField = dataReader.GetString(12);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Role)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            entity = 
            {
                MaterializationContext materializationContext3;
                IEntityType entityType3;
                Userprofile instance3;
                InternalEntityEntry entry3;
                bool hasNullKey3;
                materializationContext3 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance3 = default(Userprofile);
                entry3 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Userprofile.UserprofileId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(13) ? default(object) : (object)dataReader.GetInt32(13) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey3);
                !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
                {
                    entityType3 = entry3.EntityType;
                    return instance3 = (Userprofile)entry3.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot3;
                    shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType3 = [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")];
                    instance3 = switch (entityType3)
                    {
                        case [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]: 
                            {
                                return 
                                {
                                    Userprofile instance;
                                    instance = new Userprofile();
                                    instance.<UserprofileId>k__BackingField = dataReader.IsDBNull(13) ? default(int) : dataReader.GetInt32(13);
                                    instance.<Address>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                    instance.<Birth>k__BackingField = dataReader.IsDBNull(15) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(15);
                                    instance.<UserId>k__BackingField = dataReader.IsDBNull(16) ? default(int) : dataReader.GetInt32(16);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext3.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Userprofile)
                    }
                    ;
                    entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType3, 
                        entity: instance3, 
                        snapshot: shadowSnapshot3);
                    return instance3;
                } : default(void);
                return instance3;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
                fixup: (namelessParameter{11}, namelessParameter{12}) => 
                {
                    namelessParameter{11}.<Role>k__BackingField = namelessParameter{12};
                    return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                        entity: namelessParameter{12}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                }, 
                trackingQuery: True);
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Userprofile>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Userprofile (Userprofile) ToDependent Userprofile Inverse: User | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Userprofile")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Userprofile.User (User) ToPrincipal User Inverse: Userprofile | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindNavigation("User")], 
                fixup: (namelessParameter{16}, namelessParameter{17}) => 
                {
                    namelessParameter{16}.<Userprofile>k__BackingField = namelessParameter{17};
                    return namelessParameter{17}.<User>k__BackingField = namelessParameter{16};
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-04 19:42:27.154 +07:00 [DBG] Creating DbConnection.
2025-05-04 19:42:27.155 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 19:42:27.156 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:42:27.157 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:42:27.158 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 19:42:27.159 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 19:42:27.160 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 19:42:27.161 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 19:42:27.169 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 19:42:27.171 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:42:27.172 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:42:27.173 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:42:27.178 +07:00 [DBG] The navigation 'User.Userprofile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:42:27.181 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Userprofile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:42:27.187 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:42:27.188 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 16ms reading results.
2025-05-04 19:42:27.189 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:42:27.190 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 19:42:27.192 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 19:42:27.194 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 19:42:27.194 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 19:42:27.195 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 19:42:27.196 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 19:42:27.198 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO'.
2025-05-04 19:42:27.206 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument) in 159.949ms
2025-05-04 19:42:27.207 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 19:42:27.208 +07:00 [INF] HTTP GET /api/Users/me responded 200 in 233.2212 ms
2025-05-04 19:42:27.209 +07:00 [DBG] Connection id "0HNCB13IJMHKU" completed keep alive response.
2025-05-04 19:42:27.210 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 19:42:27.211 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:42:27.213 +07:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-05-04 19:42:27.215 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/me - 200 null application/json; charset=utf-8 255.7107ms
2025-05-04 19:43:11.592 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/me - application/json 110
2025-05-04 19:43:11.597 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me'
2025-05-04 19:43:11.598 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 19:43:11.599 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 19:43:11.620 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 19:43:11.622 +07:00 [DBG] Successfully validated the token.
2025-05-04 19:43:11.624 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 19:43:11.629 +07:00 [DBG] Authorization was successful.
2025-05-04 19:43:11.632 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 19:43:11.636 +07:00 [INF] Route matched with {action = "UpdateMe", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateMe(ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 19:43:11.638 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 19:43:11.641 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 19:43:11.643 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 19:43:11.646 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 19:43:11.647 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 19:43:11.648 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:43:11.650 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:43:11.651 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' ...
2025-05-04 19:43:11.652 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' using the name '' in request data ...
2025-05-04 19:43:11.654 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 19:43:11.656 +07:00 [DBG] Connection id "0HNCB13IJMHKU", Request id "0HNCB13IJMHKU:00000006": started reading request body.
2025-05-04 19:43:11.659 +07:00 [DBG] Connection id "0HNCB13IJMHKU", Request id "0HNCB13IJMHKU:00000006": done reading request body.
2025-05-04 19:43:11.669 +07:00 [DBG] JSON input formatter threw an exception: '0x0A' is invalid within a JSON string. The string should be correctly escaped. Path: $.phone | LineNumber: 2 | BytePositionInLine: 23.
2025-05-04 19:43:11.670 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 19:43:11.672 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 19:43:11.673 +07:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' ...
2025-05-04 19:43:11.678 +07:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 19:43:11.680 +07:00 [DBG] The request has model state errors, returning an error response.
2025-05-04 19:43:11.682 +07:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2025-05-04 19:43:11.683 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 19:43:11.686 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 19:43:11.687 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-05-04 19:43:11.690 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-05-04 19:43:11.693 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-04 19:43:11.718 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument) in 69.6352ms
2025-05-04 19:43:11.719 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 19:43:11.721 +07:00 [INF] HTTP PUT /api/Users/me responded 400 in 101.0540 ms
2025-05-04 19:43:11.722 +07:00 [DBG] Connection id "0HNCB13IJMHKU" completed keep alive response.
2025-05-04 19:43:11.724 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/me - 400 null application/problem+json; charset=utf-8 131.9264ms
2025-05-04 19:43:22.145 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/me - application/json 111
2025-05-04 19:43:22.148 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me'
2025-05-04 19:43:22.150 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 19:43:22.152 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 19:43:22.154 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 19:43:22.157 +07:00 [DBG] Successfully validated the token.
2025-05-04 19:43:22.158 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 19:43:22.160 +07:00 [DBG] Authorization was successful.
2025-05-04 19:43:22.161 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 19:43:22.163 +07:00 [INF] Route matched with {action = "UpdateMe", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateMe(ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 19:43:22.166 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 19:43:22.169 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 19:43:22.170 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 19:43:22.172 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 19:43:22.175 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 19:43:22.178 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:43:22.182 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:43:22.184 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' ...
2025-05-04 19:43:22.185 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' using the name '' in request data ...
2025-05-04 19:43:22.187 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 19:43:22.188 +07:00 [DBG] Connection id "0HNCB13IJMHKU", Request id "0HNCB13IJMHKU:00000007": started reading request body.
2025-05-04 19:43:22.189 +07:00 [DBG] Connection id "0HNCB13IJMHKU", Request id "0HNCB13IJMHKU:00000007": done reading request body.
2025-05-04 19:43:22.195 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'
2025-05-04 19:43:22.196 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 19:43:22.198 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 19:43:22.199 +07:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' ...
2025-05-04 19:43:22.205 +07:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 19:43:22.211 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 19:43:22.213 +07:00 [DBG] Creating DbConnection.
2025-05-04 19:43:22.214 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 19:43:22.215 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:43:22.217 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:43:22.218 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 19:43:22.219 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-04 19:43:22.220 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 19:43:22.221 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 19:43:22.229 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 19:43:22.233 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:43:22.235 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:43:22.236 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:43:22.237 +07:00 [DBG] The navigation 'User.Userprofile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:43:22.238 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Userprofile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:43:22.242 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:43:22.244 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 10ms reading results.
2025-05-04 19:43:22.246 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:43:22.247 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 19:43:22.251 +07:00 [DBG] SaveChanges starting for 'ExchangeDocumentContext'.
2025-05-04 19:43:22.254 +07:00 [DBG] DetectChanges starting for 'ExchangeDocumentContext'.
2025-05-04 19:43:22.265 +07:00 [DBG] The unchanged property 'User.FullName' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-04 19:43:22.272 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:43:22.283 +07:00 [DBG] The unchanged property 'User.UpdatedAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-04 19:43:22.293 +07:00 [DBG] DetectChanges completed for 'ExchangeDocumentContext'.
2025-05-04 19:43:22.332 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:43:22.334 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:43:22.336 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 19:43:22.337 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 19:43:22.339 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 19:43:22.342 +07:00 [DBG] Executing DbCommand [Parameters=[@p2='?' (DbType = Int32), @p0='?' (Size = 255), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [users] SET [fullName] = @p0, [UpdatedAt] = @p1
OUTPUT 1
WHERE [userId] = @p2;
2025-05-04 19:43:22.348 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (Size = 255), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [users] SET [fullName] = @p0, [UpdatedAt] = @p1
OUTPUT 1
WHERE [userId] = @p2;
2025-05-04 19:43:22.355 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:43:22.357 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 5ms reading results.
2025-05-04 19:43:22.361 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:43:22.363 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 19:43:22.367 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:43:22.371 +07:00 [DBG] SaveChanges completed for 'ExchangeDocumentContext' with 1 entities written to the database.
2025-05-04 19:43:22.376 +07:00 [INF] User 3 updated profile at "2025-05-04T12:43:22.2500033Z"
2025-05-04 19:43:22.377 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 19:43:22.381 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 19:43:22.381 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 19:43:22.382 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 19:43:22.383 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 19:43:22.384 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO'.
2025-05-04 19:43:22.386 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument) in 208.2414ms
2025-05-04 19:43:22.388 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 19:43:22.390 +07:00 [INF] HTTP PUT /api/Users/me responded 200 in 235.5758 ms
2025-05-04 19:43:22.393 +07:00 [DBG] Connection id "0HNCB13IJMHKU" completed keep alive response.
2025-05-04 19:43:22.394 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 19:43:22.394 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:43:22.396 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 19:43:22.397 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/me - 200 null application/json; charset=utf-8 252.105ms
2025-05-04 19:44:11.685 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/me/change-password - application/json 110
2025-05-04 19:44:11.689 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me/change-password'
2025-05-04 19:44:11.690 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)' with route pattern 'api/Users/me/change-password' is valid for the request path '/api/Users/me/change-password'
2025-05-04 19:44:11.692 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)'
2025-05-04 19:44:11.694 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 19:44:11.696 +07:00 [DBG] Successfully validated the token.
2025-05-04 19:44:11.697 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 19:44:11.699 +07:00 [DBG] Authorization was successful.
2025-05-04 19:44:11.701 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)'
2025-05-04 19:44:11.710 +07:00 [INF] Route matched with {action = "ChangePassword", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ChangePassword(ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 19:44:11.713 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 19:44:11.714 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 19:44:11.716 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 19:44:11.721 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 19:44:11.723 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 19:44:11.725 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:44:11.728 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:44:11.731 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO' ...
2025-05-04 19:44:11.734 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO' using the name '' in request data ...
2025-05-04 19:44:11.737 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 19:44:11.741 +07:00 [DBG] Connection id "0HNCB13IJMHKU", Request id "0HNCB13IJMHKU:00000008": started reading request body.
2025-05-04 19:44:11.743 +07:00 [DBG] Connection id "0HNCB13IJMHKU", Request id "0HNCB13IJMHKU:00000008": done reading request body.
2025-05-04 19:44:11.745 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'
2025-05-04 19:44:11.746 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'.
2025-05-04 19:44:11.747 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'.
2025-05-04 19:44:11.748 +07:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO' ...
2025-05-04 19:44:11.756 +07:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'.
2025-05-04 19:44:11.759 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 19:44:11.761 +07:00 [DBG] Creating DbConnection.
2025-05-04 19:44:11.761 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 19:44:11.762 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:11.764 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:11.765 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 19:44:11.766 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-04 19:44:11.767 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 19:44:11.769 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 19:44:11.774 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 19:44:11.777 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:44:11.778 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:44:11.779 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:44:11.781 +07:00 [DBG] The navigation 'User.Userprofile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:44:11.782 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Userprofile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:44:11.785 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:11.787 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 10ms reading results.
2025-05-04 19:44:11.790 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:11.792 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 19:44:12.073 +07:00 [DBG] SaveChanges starting for 'ExchangeDocumentContext'.
2025-05-04 19:44:12.074 +07:00 [DBG] DetectChanges starting for 'ExchangeDocumentContext'.
2025-05-04 19:44:12.075 +07:00 [DBG] The unchanged property 'User.Password' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-04 19:44:12.077 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:44:12.078 +07:00 [DBG] The unchanged property 'User.UpdatedAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-04 19:44:12.082 +07:00 [DBG] DetectChanges completed for 'ExchangeDocumentContext'.
2025-05-04 19:44:12.084 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:12.086 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:12.087 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 19:44:12.088 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-04 19:44:12.090 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 19:44:12.091 +07:00 [DBG] Executing DbCommand [Parameters=[@p2='?' (DbType = Int32), @p0='?' (Size = 255), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [users] SET [password] = @p0, [UpdatedAt] = @p1
OUTPUT 1
WHERE [userId] = @p2;
2025-05-04 19:44:12.100 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (Size = 255), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [users] SET [password] = @p0, [UpdatedAt] = @p1
OUTPUT 1
WHERE [userId] = @p2;
2025-05-04 19:44:12.103 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:12.104 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 1ms reading results.
2025-05-04 19:44:12.108 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:12.111 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (3ms).
2025-05-04 19:44:12.114 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:44:12.117 +07:00 [DBG] SaveChanges completed for 'ExchangeDocumentContext' with 1 entities written to the database.
2025-05-04 19:44:12.120 +07:00 [INF] User 3 changed password at "2025-05-04T12:44:12.0736141Z"
2025-05-04 19:44:12.122 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 19:44:12.125 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 19:44:12.126 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 19:44:12.127 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 19:44:12.128 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 19:44:12.130 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 19:44:12.133 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument) in 408.0433ms
2025-05-04 19:44:12.135 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)'
2025-05-04 19:44:12.138 +07:00 [INF] HTTP PUT /api/Users/me/change-password responded 200 in 443.9527 ms
2025-05-04 19:44:12.139 +07:00 [DBG] Connection id "0HNCB13IJMHKU" completed keep alive response.
2025-05-04 19:44:12.141 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 19:44:12.142 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:12.144 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 19:44:12.146 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/me/change-password - 200 null application/json; charset=utf-8 460.557ms
2025-05-04 19:44:21.389 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=2 - null null
2025-05-04 19:44:21.395 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users'
2025-05-04 19:44:21.396 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)' with route pattern 'api/Users' is valid for the request path '/api/Users'
2025-05-04 19:44:21.402 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 19:44:21.405 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 19:44:21.419 +07:00 [DBG] Successfully validated the token.
2025-05-04 19:44:21.425 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 19:44:21.428 +07:00 [DBG] Authorization was successful.
2025-05-04 19:44:21.429 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 19:44:21.438 +07:00 [INF] Route matched with {action = "GetAll", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Int32, Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 19:44:21.441 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 19:44:21.442 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 19:44:21.443 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 19:44:21.445 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 19:44:21.446 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 19:44:21.447 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:44:21.450 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:44:21.454 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 19:44:21.456 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' using the name 'pageNumber' in request data ...
2025-05-04 19:44:21.457 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 19:44:21.458 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 19:44:21.459 +07:00 [DBG] Attempting to validate the bound parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 19:44:21.460 +07:00 [DBG] Done attempting to validate the bound parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 19:44:21.461 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 19:44:21.462 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' using the name 'pageSize' in request data ...
2025-05-04 19:44:21.463 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 19:44:21.464 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 19:44:21.465 +07:00 [DBG] Attempting to validate the bound parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 19:44:21.468 +07:00 [DBG] Done attempting to validate the bound parameter 'pageSize' of type 'System.Int32'.
2025-05-04 19:44:21.472 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 19:44:21.474 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-05-04 19:44:21.486 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: SingleQueryingEnumerable.Create<int>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM users AS u) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM users AS u, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            int? value1;
            value1 = dataReader.IsDBNull(0) ? default(int?) : (int?)dataReader.GetInt32(0);
            return (int)value1;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-04 19:44:21.494 +07:00 [DBG] Creating DbConnection.
2025-05-04 19:44:21.495 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 19:44:21.496 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:21.497 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:21.499 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 19:44:21.501 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-05-04 19:44:21.503 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-05-04 19:44:21.504 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [users] AS [u]
2025-05-04 19:44:21.507 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [users] AS [u]
2025-05-04 19:44:21.510 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:21.511 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 1ms reading results.
2025-05-04 19:44:21.513 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:21.514 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 19:44:21.520 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .Include(u => u.Userprofile)
    .OrderBy(u => u.UserId)
    .Skip(__p_0)
    .Take(__p_1)'
2025-05-04 19:44:21.524 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-04 19:44:21.525 +07:00 [DBG] Including navigation: 'User.Userprofile'.
2025-05-04 19:44:21.539 +07:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<User>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
            1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
        SELECT u0.userId, u0.CreatedAt, u0.email, u0.fullName, u0.IsEmailVerified, u0.password, u0.PasswordResetToken, u0.phone, u0.ResetTokenExpires, u0.roleId, u0.UpdatedAt, r.roleId, r.roleName, u1.userprofileId, u1.address, u1.birth, u1.userId
        FROM 
        (
            SELECT u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt
            FROM users AS u
            ORDER BY u.userId ASC
            OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
        ) AS u0
        INNER JOIN roles AS r ON u0.roleId == r.roleId
        LEFT JOIN userprofiles AS u1 ON u0.userId == u1.userId
        ORDER BY u0.userId ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
            1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
        SELECT u0.userId, u0.CreatedAt, u0.email, u0.fullName, u0.IsEmailVerified, u0.password, u0.PasswordResetToken, u0.phone, u0.ResetTokenExpires, u0.roleId, u0.UpdatedAt, r.roleId, r.roleName, u1.userprofileId, u1.address, u1.birth, u1.userId
        FROM 
        (
            SELECT u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt
            FROM users AS u
            ORDER BY u.userId ASC
            OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
        ) AS u0
        INNER JOIN roles AS r ON u0.roleId == r.roleId
        LEFT JOIN userprofiles AS u1 ON u0.userId == u1.userId
        ORDER BY u0.userId ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        User entity;
        Role entity;
        Userprofile entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            User instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(User);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (User)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                        {
                            return 
                            {
                                User instance;
                                instance = new User();
                                instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                instance.<Email>k__BackingField = dataReader.GetString(2);
                                instance.<FullName>k__BackingField = dataReader.GetString(3);
                                instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(4);
                                instance.<Password>k__BackingField = dataReader.GetString(5);
                                instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                instance.<Phone>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(8) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(8);
                                instance.<RoleId>k__BackingField = dataReader.GetInt32(9);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(User)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        entity = 
        {
            MaterializationContext materializationContext2;
            IEntityType entityType2;
            Role instance2;
            InternalEntityEntry entry2;
            bool hasNullKey2;
            materializationContext2 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance2 = default(Role);
            entry2 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(11) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey2);
            !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
            {
                entityType2 = entry2.EntityType;
                return instance2 = (Role)entry2.Entity;
            } : 
            {
                ISnapshot shadowSnapshot2;
                shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                instance2 = switch (entityType2)
                {
                    case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                        {
                            return 
                            {
                                Role instance;
                                instance = new Role();
                                instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                instance.<RoleName>k__BackingField = dataReader.GetString(12);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext2.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Role)
                }
                ;
                entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType2, 
                    entity: instance2, 
                    snapshot: shadowSnapshot2);
                return instance2;
            } : default(void);
            return instance2;
        };
        entity = 
        {
            MaterializationContext materializationContext3;
            IEntityType entityType3;
            Userprofile instance3;
            InternalEntityEntry entry3;
            bool hasNullKey3;
            materializationContext3 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance3 = default(Userprofile);
            entry3 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Userprofile.UserprofileId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindPrimaryKey()], 
                keyValues: new object[]{ dataReader.IsDBNull(13) ? default(object) : (object)dataReader.GetInt32(13) }, 
                throwOnNullKey: False, 
                hasNullKey: hasNullKey3);
            !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
            {
                entityType3 = entry3.EntityType;
                return instance3 = (Userprofile)entry3.Entity;
            } : 
            {
                ISnapshot shadowSnapshot3;
                shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType3 = [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")];
                instance3 = switch (entityType3)
                {
                    case [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]: 
                        {
                            return 
                            {
                                Userprofile instance;
                                instance = new Userprofile();
                                instance.<UserprofileId>k__BackingField = dataReader.IsDBNull(13) ? default(int) : dataReader.GetInt32(13);
                                instance.<Address>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                instance.<Birth>k__BackingField = dataReader.IsDBNull(15) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(15);
                                instance.<UserId>k__BackingField = dataReader.IsDBNull(16) ? default(int) : dataReader.GetInt32(16);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext3.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Userprofile)
                }
                ;
                entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType3, 
                    entity: instance3, 
                    snapshot: shadowSnapshot3);
                return instance3;
            } : default(void);
            return instance3;
        };
        ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
            fixup: (namelessParameter{11}, namelessParameter{12}) => 
            {
                namelessParameter{11}.<Role>k__BackingField = namelessParameter{12};
                return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                    entity: namelessParameter{12}, 
                    value: namelessParameter{11}, 
                    forMaterialization: True);
            }, 
            trackingQuery: True);
        ShaperProcessingExpressionVisitor.IncludeReference<User, User, Userprofile>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: User.Userprofile (Userprofile) ToDependent Userprofile Inverse: User | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Userprofile")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Userprofile.User (User) ToPrincipal User Inverse: Userprofile | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindNavigation("User")], 
            fixup: (namelessParameter{16}, namelessParameter{17}) => 
            {
                namelessParameter{16}.<Userprofile>k__BackingField = namelessParameter{17};
                return namelessParameter{17}.<User>k__BackingField = namelessParameter{16};
            }, 
            trackingQuery: True);
        return entity;
    }, 
    contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-05-04 19:44:21.572 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:21.573 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:21.575 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 19:44:21.576 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 19:44:21.577 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 19:44:21.578 +07:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[userId], [u0].[CreatedAt], [u0].[email], [u0].[fullName], [u0].[IsEmailVerified], [u0].[password], [u0].[PasswordResetToken], [u0].[phone], [u0].[ResetTokenExpires], [u0].[roleId], [u0].[UpdatedAt], [r].[roleId], [r].[roleName], [u1].[userprofileId], [u1].[address], [u1].[birth], [u1].[userId]
FROM (
    SELECT [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
    FROM [users] AS [u]
    ORDER BY [u].[userId]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [roles] AS [r] ON [u0].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u1] ON [u0].[userId] = [u1].[userId]
ORDER BY [u0].[userId]
2025-05-04 19:44:21.586 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[userId], [u0].[CreatedAt], [u0].[email], [u0].[fullName], [u0].[IsEmailVerified], [u0].[password], [u0].[PasswordResetToken], [u0].[phone], [u0].[ResetTokenExpires], [u0].[roleId], [u0].[UpdatedAt], [r].[roleId], [r].[roleName], [u1].[userprofileId], [u1].[address], [u1].[birth], [u1].[userId]
FROM (
    SELECT [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
    FROM [users] AS [u]
    ORDER BY [u].[userId]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [roles] AS [r] ON [u0].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u1] ON [u0].[userId] = [u1].[userId]
ORDER BY [u0].[userId]
2025-05-04 19:44:21.589 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:44:21.591 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:44:21.592 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:44:21.594 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:44:21.596 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:21.598 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 8ms reading results.
2025-05-04 19:44:21.600 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:21.602 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 19:44:21.605 +07:00 [INF] Admin fetched users page 1 with size 2
2025-05-04 19:44:21.606 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 19:44:21.609 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 19:44:21.610 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 19:44:21.611 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 19:44:21.612 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 19:44:21.613 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.PagedResponseDTO`1[[ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO, ExchangeDocument, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 19:44:21.618 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument) in 171.1088ms
2025-05-04 19:44:21.621 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 19:44:21.623 +07:00 [INF] HTTP GET /api/Users responded 200 in 218.3551 ms
2025-05-04 19:44:21.625 +07:00 [DBG] Connection id "0HNCB13IJMHKU" completed keep alive response.
2025-05-04 19:44:21.625 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 19:44:21.626 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:21.628 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 19:44:21.629 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=2 - 200 null application/json; charset=utf-8 240.063ms
2025-05-04 19:44:29.847 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=2&pageSize=2 - null null
2025-05-04 19:44:29.852 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users'
2025-05-04 19:44:29.853 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)' with route pattern 'api/Users' is valid for the request path '/api/Users'
2025-05-04 19:44:29.856 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 19:44:29.858 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 19:44:29.861 +07:00 [DBG] Successfully validated the token.
2025-05-04 19:44:29.861 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 19:44:29.868 +07:00 [DBG] Authorization was successful.
2025-05-04 19:44:29.869 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 19:44:29.871 +07:00 [INF] Route matched with {action = "GetAll", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Int32, Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 19:44:29.873 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 19:44:29.874 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 19:44:29.876 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 19:44:29.878 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 19:44:29.879 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 19:44:29.882 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:44:29.886 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:44:29.887 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 19:44:29.889 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' using the name 'pageNumber' in request data ...
2025-05-04 19:44:29.890 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 19:44:29.891 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 19:44:29.892 +07:00 [DBG] Attempting to validate the bound parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 19:44:29.894 +07:00 [DBG] Done attempting to validate the bound parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 19:44:29.896 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 19:44:29.899 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' using the name 'pageSize' in request data ...
2025-05-04 19:44:29.901 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 19:44:29.903 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 19:44:29.905 +07:00 [DBG] Attempting to validate the bound parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 19:44:29.907 +07:00 [DBG] Done attempting to validate the bound parameter 'pageSize' of type 'System.Int32'.
2025-05-04 19:44:29.909 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 19:44:29.915 +07:00 [DBG] Creating DbConnection.
2025-05-04 19:44:29.917 +07:00 [DBG] Created DbConnection. (2ms).
2025-05-04 19:44:29.918 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:29.921 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:29.924 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 19:44:29.925 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-04 19:44:29.926 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 19:44:29.927 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [users] AS [u]
2025-05-04 19:44:29.931 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [users] AS [u]
2025-05-04 19:44:29.935 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:29.938 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 2ms reading results.
2025-05-04 19:44:29.939 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:29.940 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 19:44:29.942 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .Include(u => u.Userprofile)
    .OrderBy(u => u.UserId)
    .Skip(__p_0)
    .Take(__p_0)'
2025-05-04 19:44:29.944 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-04 19:44:29.945 +07:00 [DBG] Including navigation: 'User.Userprofile'.
2025-05-04 19:44:29.954 +07:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<User>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
            1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
        SELECT u0.userId, u0.CreatedAt, u0.email, u0.fullName, u0.IsEmailVerified, u0.password, u0.PasswordResetToken, u0.phone, u0.ResetTokenExpires, u0.roleId, u0.UpdatedAt, r.roleId, r.roleName, u1.userprofileId, u1.address, u1.birth, u1.userId
        FROM 
        (
            SELECT u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt
            FROM users AS u
            ORDER BY u.userId ASC
            OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
        ) AS u0
        INNER JOIN roles AS r ON u0.roleId == r.roleId
        LEFT JOIN userprofiles AS u1 ON u0.userId == u1.userId
        ORDER BY u0.userId ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
            1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
        SELECT u0.userId, u0.CreatedAt, u0.email, u0.fullName, u0.IsEmailVerified, u0.password, u0.PasswordResetToken, u0.phone, u0.ResetTokenExpires, u0.roleId, u0.UpdatedAt, r.roleId, r.roleName, u1.userprofileId, u1.address, u1.birth, u1.userId
        FROM 
        (
            SELECT u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt
            FROM users AS u
            ORDER BY u.userId ASC
            OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
        ) AS u0
        INNER JOIN roles AS r ON u0.roleId == r.roleId
        LEFT JOIN userprofiles AS u1 ON u0.userId == u1.userId
        ORDER BY u0.userId ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        User entity;
        Role entity;
        Userprofile entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            User instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(User);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (User)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                        {
                            return 
                            {
                                User instance;
                                instance = new User();
                                instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                instance.<Email>k__BackingField = dataReader.GetString(2);
                                instance.<FullName>k__BackingField = dataReader.GetString(3);
                                instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(4);
                                instance.<Password>k__BackingField = dataReader.GetString(5);
                                instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                instance.<Phone>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(8) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(8);
                                instance.<RoleId>k__BackingField = dataReader.GetInt32(9);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(User)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        entity = 
        {
            MaterializationContext materializationContext2;
            IEntityType entityType2;
            Role instance2;
            InternalEntityEntry entry2;
            bool hasNullKey2;
            materializationContext2 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance2 = default(Role);
            entry2 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(11) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey2);
            !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
            {
                entityType2 = entry2.EntityType;
                return instance2 = (Role)entry2.Entity;
            } : 
            {
                ISnapshot shadowSnapshot2;
                shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                instance2 = switch (entityType2)
                {
                    case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                        {
                            return 
                            {
                                Role instance;
                                instance = new Role();
                                instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                instance.<RoleName>k__BackingField = dataReader.GetString(12);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext2.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Role)
                }
                ;
                entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType2, 
                    entity: instance2, 
                    snapshot: shadowSnapshot2);
                return instance2;
            } : default(void);
            return instance2;
        };
        entity = 
        {
            MaterializationContext materializationContext3;
            IEntityType entityType3;
            Userprofile instance3;
            InternalEntityEntry entry3;
            bool hasNullKey3;
            materializationContext3 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance3 = default(Userprofile);
            entry3 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Userprofile.UserprofileId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindPrimaryKey()], 
                keyValues: new object[]{ dataReader.IsDBNull(13) ? default(object) : (object)dataReader.GetInt32(13) }, 
                throwOnNullKey: False, 
                hasNullKey: hasNullKey3);
            !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
            {
                entityType3 = entry3.EntityType;
                return instance3 = (Userprofile)entry3.Entity;
            } : 
            {
                ISnapshot shadowSnapshot3;
                shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType3 = [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")];
                instance3 = switch (entityType3)
                {
                    case [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]: 
                        {
                            return 
                            {
                                Userprofile instance;
                                instance = new Userprofile();
                                instance.<UserprofileId>k__BackingField = dataReader.IsDBNull(13) ? default(int) : dataReader.GetInt32(13);
                                instance.<Address>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                instance.<Birth>k__BackingField = dataReader.IsDBNull(15) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(15);
                                instance.<UserId>k__BackingField = dataReader.IsDBNull(16) ? default(int) : dataReader.GetInt32(16);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext3.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Userprofile)
                }
                ;
                entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType3, 
                    entity: instance3, 
                    snapshot: shadowSnapshot3);
                return instance3;
            } : default(void);
            return instance3;
        };
        ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
            fixup: (namelessParameter{11}, namelessParameter{12}) => 
            {
                namelessParameter{11}.<Role>k__BackingField = namelessParameter{12};
                return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                    entity: namelessParameter{12}, 
                    value: namelessParameter{11}, 
                    forMaterialization: True);
            }, 
            trackingQuery: True);
        ShaperProcessingExpressionVisitor.IncludeReference<User, User, Userprofile>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: User.Userprofile (Userprofile) ToDependent Userprofile Inverse: User | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Userprofile")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Userprofile.User (User) ToPrincipal User Inverse: Userprofile | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindNavigation("User")], 
            fixup: (namelessParameter{16}, namelessParameter{17}) => 
            {
                namelessParameter{16}.<Userprofile>k__BackingField = namelessParameter{17};
                return namelessParameter{17}.<User>k__BackingField = namelessParameter{16};
            }, 
            trackingQuery: True);
        return entity;
    }, 
    contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-05-04 19:44:29.983 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:29.985 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:29.986 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 19:44:29.987 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 19:44:29.988 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 19:44:29.988 +07:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[userId], [u0].[CreatedAt], [u0].[email], [u0].[fullName], [u0].[IsEmailVerified], [u0].[password], [u0].[PasswordResetToken], [u0].[phone], [u0].[ResetTokenExpires], [u0].[roleId], [u0].[UpdatedAt], [r].[roleId], [r].[roleName], [u1].[userprofileId], [u1].[address], [u1].[birth], [u1].[userId]
FROM (
    SELECT [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
    FROM [users] AS [u]
    ORDER BY [u].[userId]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [u0]
INNER JOIN [roles] AS [r] ON [u0].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u1] ON [u0].[userId] = [u1].[userId]
ORDER BY [u0].[userId]
2025-05-04 19:44:29.993 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[userId], [u0].[CreatedAt], [u0].[email], [u0].[fullName], [u0].[IsEmailVerified], [u0].[password], [u0].[PasswordResetToken], [u0].[phone], [u0].[ResetTokenExpires], [u0].[roleId], [u0].[UpdatedAt], [r].[roleId], [r].[roleName], [u1].[userprofileId], [u1].[address], [u1].[birth], [u1].[userId]
FROM (
    SELECT [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
    FROM [users] AS [u]
    ORDER BY [u].[userId]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [u0]
INNER JOIN [roles] AS [r] ON [u0].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u1] ON [u0].[userId] = [u1].[userId]
ORDER BY [u0].[userId]
2025-05-04 19:44:29.995 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:44:29.998 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:44:30.000 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:44:30.001 +07:00 [DBG] The navigation 'User.Userprofile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:44:30.002 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Userprofile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:44:30.004 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:30.005 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 9ms reading results.
2025-05-04 19:44:30.006 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:30.007 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (0ms).
2025-05-04 19:44:30.008 +07:00 [INF] Admin fetched users page 2 with size 2
2025-05-04 19:44:30.008 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 19:44:30.010 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 19:44:30.010 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 19:44:30.011 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 19:44:30.011 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 19:44:30.012 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.PagedResponseDTO`1[[ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO, ExchangeDocument, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 19:44:30.016 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument) in 133.6161ms
2025-05-04 19:44:30.017 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 19:44:30.018 +07:00 [INF] HTTP GET /api/Users responded 200 in 160.3551 ms
2025-05-04 19:44:30.019 +07:00 [DBG] Connection id "0HNCB13IJMHKU" completed keep alive response.
2025-05-04 19:44:30.020 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 19:44:30.022 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:30.023 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 19:44:30.024 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=2&pageSize=2 - 200 null application/json; charset=utf-8 176.6407ms
2025-05-04 19:44:53.203 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/10 - null null
2025-05-04 19:44:53.207 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/10'
2025-05-04 19:44:53.208 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/10'
2025-05-04 19:44:53.211 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:44:53.213 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 19:44:53.216 +07:00 [DBG] Successfully validated the token.
2025-05-04 19:44:53.217 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 19:44:53.219 +07:00 [DBG] Authorization was successful.
2025-05-04 19:44:53.219 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:44:53.224 +07:00 [INF] Route matched with {action = "GetById", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 19:44:53.227 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 19:44:53.230 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 19:44:53.233 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 19:44:53.235 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 19:44:53.236 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 19:44:53.238 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:44:53.240 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:44:53.242 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 19:44:53.243 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 19:44:53.245 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 19:44:53.248 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 19:44:53.250 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 19:44:53.251 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 19:44:53.254 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 19:44:53.256 +07:00 [DBG] Creating DbConnection.
2025-05-04 19:44:53.258 +07:00 [DBG] Created DbConnection. (1ms).
2025-05-04 19:44:53.259 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:53.260 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:53.262 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 19:44:53.264 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-04 19:44:53.265 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 19:44:53.269 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 19:44:53.275 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 19:44:53.280 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:53.283 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 3ms reading results.
2025-05-04 19:44:53.285 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:53.287 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 19:44:53.290 +07:00 [WRN] User not found for id 10
2025-05-04 19:44:53.291 +07:00 [WRN] GetById failed: User not found.
2025-05-04 19:44:53.292 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 19:44:53.296 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 19:44:53.297 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 19:44:53.298 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 19:44:53.300 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 19:44:53.301 +07:00 [INF] Executing NotFoundObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 19:44:53.303 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument) in 65.0443ms
2025-05-04 19:44:53.305 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:44:53.307 +07:00 [INF] HTTP GET /api/Users/10 responded 404 in 93.9804 ms
2025-05-04 19:44:53.310 +07:00 [DBG] Connection id "0HNCB13IJMHKU" completed keep alive response.
2025-05-04 19:44:53.312 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 19:44:53.315 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:53.317 +07:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-05-04 19:44:53.319 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/10 - 404 null application/json; charset=utf-8 116.5609ms
2025-05-04 19:44:59.077 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/3 - null null
2025-05-04 19:44:59.080 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/3'
2025-05-04 19:44:59.081 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/3'
2025-05-04 19:44:59.083 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:44:59.084 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 19:44:59.086 +07:00 [DBG] Successfully validated the token.
2025-05-04 19:44:59.087 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 19:44:59.111 +07:00 [DBG] Authorization was successful.
2025-05-04 19:44:59.112 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:44:59.114 +07:00 [INF] Route matched with {action = "GetById", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 19:44:59.115 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 19:44:59.117 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 19:44:59.119 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 19:44:59.123 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 19:44:59.124 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 19:44:59.126 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:44:59.128 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:44:59.130 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 19:44:59.133 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 19:44:59.135 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 19:44:59.136 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 19:44:59.138 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 19:44:59.140 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 19:44:59.141 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 19:44:59.143 +07:00 [DBG] Creating DbConnection.
2025-05-04 19:44:59.145 +07:00 [DBG] Created DbConnection. (1ms).
2025-05-04 19:44:59.146 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:59.149 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:59.150 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 19:44:59.151 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 19:44:59.152 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 19:44:59.153 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 19:44:59.158 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 19:44:59.161 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:44:59.162 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:44:59.163 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:44:59.164 +07:00 [DBG] The navigation 'User.Userprofile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:44:59.166 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Userprofile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:44:59.167 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:59.168 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 7ms reading results.
2025-05-04 19:44:59.169 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:59.170 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (0ms).
2025-05-04 19:44:59.171 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 19:44:59.173 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 19:44:59.173 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 19:44:59.174 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 19:44:59.175 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 19:44:59.176 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO'.
2025-05-04 19:44:59.178 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument) in 52.0529ms
2025-05-04 19:44:59.180 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:44:59.181 +07:00 [INF] HTTP GET /api/Users/3 responded 200 in 96.3601 ms
2025-05-04 19:44:59.182 +07:00 [DBG] Connection id "0HNCB13IJMHKU" completed keep alive response.
2025-05-04 19:44:59.182 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 19:44:59.183 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:44:59.184 +07:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-05-04 19:44:59.185 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/3 - 200 null application/json; charset=utf-8 108.2214ms
2025-05-04 19:45:04.836 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/1 - null null
2025-05-04 19:45:04.841 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1'
2025-05-04 19:45:04.843 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/1'
2025-05-04 19:45:04.846 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:45:04.849 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 19:45:04.851 +07:00 [DBG] Successfully validated the token.
2025-05-04 19:45:04.854 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 19:45:04.856 +07:00 [DBG] Authorization was successful.
2025-05-04 19:45:04.857 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:45:04.859 +07:00 [INF] Route matched with {action = "GetById", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 19:45:04.862 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 19:45:04.865 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 19:45:04.867 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 19:45:04.873 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 19:45:04.874 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 19:45:04.876 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:45:04.881 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:45:04.884 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 19:45:04.885 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 19:45:04.887 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 19:45:04.888 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 19:45:04.889 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 19:45:04.890 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 19:45:04.892 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 19:45:04.894 +07:00 [DBG] Creating DbConnection.
2025-05-04 19:45:04.895 +07:00 [DBG] Created DbConnection. (1ms).
2025-05-04 19:45:04.897 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:45:04.898 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:45:04.899 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 19:45:04.900 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 19:45:04.901 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 19:45:04.902 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 19:45:04.905 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 19:45:04.907 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:45:04.908 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:45:04.910 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:45:04.911 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:45:04.913 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 5ms reading results.
2025-05-04 19:45:04.914 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:45:04.915 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 19:45:04.916 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 19:45:04.918 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 19:45:04.919 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 19:45:04.919 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 19:45:04.920 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 19:45:04.921 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO'.
2025-05-04 19:45:04.922 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument) in 46.0502ms
2025-05-04 19:45:04.923 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:45:04.924 +07:00 [INF] HTTP GET /api/Users/1 responded 200 in 75.6438 ms
2025-05-04 19:45:04.926 +07:00 [DBG] Connection id "0HNCB13IJMHKU" completed keep alive response.
2025-05-04 19:45:04.928 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 19:45:04.929 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:45:04.930 +07:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-05-04 19:45:04.931 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/1 - 200 null application/json; charset=utf-8 94.9338ms
2025-05-04 19:45:15.162 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/3 - null null
2025-05-04 19:45:15.164 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/3'
2025-05-04 19:45:15.166 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/3'
2025-05-04 19:45:15.170 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:45:15.174 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 19:45:15.176 +07:00 [DBG] Successfully validated the token.
2025-05-04 19:45:15.179 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 19:45:15.182 +07:00 [DBG] Authorization was successful.
2025-05-04 19:45:15.186 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:45:15.188 +07:00 [INF] Route matched with {action = "GetById", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 19:45:15.191 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 19:45:15.195 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 19:45:15.198 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 19:45:15.201 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 19:45:15.202 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 19:45:15.203 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:45:15.205 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 19:45:15.206 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 19:45:15.207 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 19:45:15.210 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 19:45:15.211 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 19:45:15.212 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 19:45:15.213 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 19:45:15.215 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 19:45:15.217 +07:00 [DBG] Creating DbConnection.
2025-05-04 19:45:15.217 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 19:45:15.218 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:45:15.219 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:45:15.221 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 19:45:15.222 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 19:45:15.223 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 19:45:15.226 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 19:45:15.229 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 19:45:15.232 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:45:15.233 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:45:15.234 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:45:15.236 +07:00 [DBG] The navigation 'User.Userprofile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:45:15.237 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Userprofile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 19:45:15.239 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:45:15.241 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 9ms reading results.
2025-05-04 19:45:15.243 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:45:15.244 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 19:45:15.246 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 19:45:15.248 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 19:45:15.249 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 19:45:15.249 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 19:45:15.250 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 19:45:15.251 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO'.
2025-05-04 19:45:15.252 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument) in 49.1147ms
2025-05-04 19:45:15.253 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 19:45:15.254 +07:00 [INF] HTTP GET /api/Users/3 responded 200 in 80.6600 ms
2025-05-04 19:45:15.255 +07:00 [DBG] Connection id "0HNCB13IJMHKU" completed keep alive response.
2025-05-04 19:45:15.256 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 19:45:15.257 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 19:45:15.259 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 19:45:15.261 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/3 - 200 null application/json; charset=utf-8 98.6635ms
2025-05-04 19:47:27.013 +07:00 [DBG] Connection id "0HNCB13IJMHKU" disconnecting.
2025-05-04 19:47:27.019 +07:00 [DBG] Connection id "0HNCB13IJMHKU" stopped.
2025-05-04 19:47:27.023 +07:00 [DBG] Connection id "0HNCB13IJMHKU" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 19:59:40.376 +07:00 [INF] Application is shutting down...
2025-05-04 19:59:40.378 +07:00 [DBG] Hosting stopping
2025-05-04 19:59:40.386 +07:00 [DBG] Hosting stopped
2025-05-04 20:12:59.212 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-05-04 20:12:59.307 +07:00 [DBG] Hosting starting
2025-05-04 20:12:59.320 +07:00 [INF] User profile is available. Using 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-04 20:12:59.334 +07:00 [DBG] Reading data from file 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys\key-1a51a872-ea43-4350-815f-0422835a65dd.xml'.
2025-05-04 20:12:59.346 +07:00 [DBG] Found key {1a51a872-ea43-4350-815f-0422835a65dd}.
2025-05-04 20:12:59.360 +07:00 [DBG] Considering key {1a51a872-ea43-4350-815f-0422835a65dd} with expiration date 2025-07-05 19:31:04Z as default key.
2025-05-04 20:12:59.365 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 20:12:59.370 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-05-04 20:12:59.375 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 20:12:59.383 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-05-04 20:12:59.387 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-05-04 20:12:59.389 +07:00 [DBG] Using key {1a51a872-ea43-4350-815f-0422835a65dd} as the default key.
2025-05-04 20:12:59.390 +07:00 [DBG] Key ring with default key {1a51a872-ea43-4350-815f-0422835a65dd} was loaded during application startup.
2025-05-04 20:12:59.427 +07:00 [INF] Now listening on: http://localhost:5120
2025-05-04 20:12:59.430 +07:00 [DBG] Loaded hosting startup assembly ExchangeDocument
2025-05-04 20:12:59.432 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-04 20:12:59.433 +07:00 [INF] Hosting environment: Development
2025-05-04 20:12:59.437 +07:00 [INF] Content root path: D:\Gộp module Auth\ExchangeDocument(Tự làm Auth_User) - Đã làm logout(2)\ExchangeDocument
2025-05-04 20:12:59.438 +07:00 [DBG] Hosting started
2025-05-04 20:14:22.028 +07:00 [DBG] Connection id "0HNCB1MASHLRQ" accepted.
2025-05-04 20:14:22.036 +07:00 [DBG] Connection id "0HNCB1MASHLRQ" started.
2025-05-04 20:14:22.069 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/me - null null
2025-05-04 20:14:22.073 +07:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-05-04 20:14:22.087 +07:00 [DBG] 2 candidate(s) found for the request path '/api/Users/me'
2025-05-04 20:14:22.092 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 20:14:22.095 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/me'
2025-05-04 20:14:22.097 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 20:14:22.110 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 20:14:22.112 +07:00 [WRN] Failed to determine the https port for redirect.
2025-05-04 20:14:22.180 +07:00 [DBG] Successfully validated the token.
2025-05-04 20:14:22.187 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 20:14:22.194 +07:00 [DBG] Authorization was successful.
2025-05-04 20:14:22.197 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 20:14:22.218 +07:00 [INF] Route matched with {action = "GetMe", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMe() on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 20:14:22.224 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 20:14:22.226 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 20:14:22.228 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 20:14:22.230 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 20:14:22.232 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 20:14:22.237 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:14:22.300 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-05-04 20:14:22.320 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:14:22.695 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'OrderDetail'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 20:14:22.698 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'Review'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 20:14:22.825 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 20:14:22.882 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .Include(u => u.Userprofile)
    .FirstOrDefault(u => u.UserId == __userId_0)'
2025-05-04 20:14:22.931 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-04 20:14:22.937 +07:00 [DBG] Including navigation: 'User.Userprofile'.
2025-05-04 20:14:23.150 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
                2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName, u0.userprofileId, u0.address, u0.birth, u0.userId
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            LEFT JOIN userprofiles AS u0 ON u.userId == u0.userId
            WHERE u.userId == @__userId_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
                2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName, u0.userprofileId, u0.address, u0.birth, u0.userId
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            LEFT JOIN userprofiles AS u0 ON u.userId == u0.userId
            WHERE u.userId == @__userId_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            Role entity;
            Userprofile entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<Email>k__BackingField = dataReader.GetString(2);
                                    instance.<FullName>k__BackingField = dataReader.GetString(3);
                                    instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(4);
                                    instance.<Password>k__BackingField = dataReader.GetString(5);
                                    instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                    instance.<Phone>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(8) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(8);
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(9);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                Role instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(Role);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(11) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (Role)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                            {
                                return 
                                {
                                    Role instance;
                                    instance = new Role();
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                    instance.<RoleName>k__BackingField = dataReader.GetString(12);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Role)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            entity = 
            {
                MaterializationContext materializationContext3;
                IEntityType entityType3;
                Userprofile instance3;
                InternalEntityEntry entry3;
                bool hasNullKey3;
                materializationContext3 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance3 = default(Userprofile);
                entry3 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Userprofile.UserprofileId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(13) ? default(object) : (object)dataReader.GetInt32(13) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey3);
                !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
                {
                    entityType3 = entry3.EntityType;
                    return instance3 = (Userprofile)entry3.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot3;
                    shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType3 = [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")];
                    instance3 = switch (entityType3)
                    {
                        case [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]: 
                            {
                                return 
                                {
                                    Userprofile instance;
                                    instance = new Userprofile();
                                    instance.<UserprofileId>k__BackingField = dataReader.IsDBNull(13) ? default(int) : dataReader.GetInt32(13);
                                    instance.<Address>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                    instance.<Birth>k__BackingField = dataReader.IsDBNull(15) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(15);
                                    instance.<UserId>k__BackingField = dataReader.IsDBNull(16) ? default(int) : dataReader.GetInt32(16);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext3.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Userprofile)
                    }
                    ;
                    entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType3, 
                        entity: instance3, 
                        snapshot: shadowSnapshot3);
                    return instance3;
                } : default(void);
                return instance3;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
                fixup: (namelessParameter{11}, namelessParameter{12}) => 
                {
                    namelessParameter{11}.<Role>k__BackingField = namelessParameter{12};
                    return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                        entity: namelessParameter{12}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                }, 
                trackingQuery: True);
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Userprofile>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Userprofile (Userprofile) ToDependent Userprofile Inverse: User | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Userprofile")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Userprofile.User (User) ToPrincipal User Inverse: Userprofile | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindNavigation("User")], 
                fixup: (namelessParameter{16}, namelessParameter{17}) => 
                {
                    namelessParameter{16}.<Userprofile>k__BackingField = namelessParameter{17};
                    return namelessParameter{17}.<User>k__BackingField = namelessParameter{16};
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-04 20:14:23.222 +07:00 [DBG] Creating DbConnection.
2025-05-04 20:14:23.240 +07:00 [DBG] Created DbConnection. (17ms).
2025-05-04 20:14:23.245 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:14:23.351 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:14:23.357 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 20:14:23.364 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-05-04 20:14:23.374 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (16ms).
2025-05-04 20:14:23.381 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 20:14:23.424 +07:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 20:14:23.458 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:14:23.494 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:14:23.503 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:14:23.514 +07:00 [DBG] The navigation 'User.Userprofile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:14:23.519 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Userprofile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:14:23.534 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:14:23.546 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 110ms reading results.
2025-05-04 20:14:23.554 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:14:23.564 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (10ms).
2025-05-04 20:14:23.572 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 20:14:23.583 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 20:14:23.585 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 20:14:23.586 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 20:14:23.588 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 20:14:23.590 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO'.
2025-05-04 20:14:23.646 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument) in 1408.748ms
2025-05-04 20:14:23.653 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 20:14:23.661 +07:00 [INF] HTTP GET /api/Users/me responded 200 in 1559.6975 ms
2025-05-04 20:14:23.669 +07:00 [DBG] Connection id "0HNCB1MASHLRQ" completed keep alive response.
2025-05-04 20:14:23.674 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 20:14:23.681 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:14:23.685 +07:00 [DBG] Disposed connection to database '' on server '' (3ms).
2025-05-04 20:14:23.690 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/me - 200 null application/json; charset=utf-8 1622.8423ms
2025-05-04 20:14:26.779 +07:00 [DBG] Connection id "0HNCB1MASHLRR" accepted.
2025-05-04 20:14:26.780 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/index.html - null null
2025-05-04 20:14:26.784 +07:00 [DBG] Connection id "0HNCB1MASHLRR" started.
2025-05-04 20:14:26.792 +07:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-05-04 20:14:26.793 +07:00 [DBG] Request did not match any endpoints
2025-05-04 20:14:26.837 +07:00 [INF] HTTP GET /swagger/index.html responded 200 in 42.0985 ms
2025-05-04 20:14:26.845 +07:00 [DBG] Connection id "0HNCB1MASHLRQ" completed keep alive response.
2025-05-04 20:14:26.848 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/index.html - 200 null text/html;charset=utf-8 67.8549ms
2025-05-04 20:14:27.275 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - null null
2025-05-04 20:14:27.279 +07:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-05-04 20:14:27.281 +07:00 [DBG] Request did not match any endpoints
2025-05-04 20:14:27.458 +07:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 174.5640 ms
2025-05-04 20:14:27.460 +07:00 [DBG] Connection id "0HNCB1MASHLRQ" completed keep alive response.
2025-05-04 20:14:27.462 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 186.2674ms
2025-05-04 20:14:37.860 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/me - null null
2025-05-04 20:14:37.866 +07:00 [DBG] 2 candidate(s) found for the request path '/api/Users/me'
2025-05-04 20:14:37.870 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 20:14:37.874 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/me'
2025-05-04 20:14:37.877 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 20:14:37.879 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 20:14:37.883 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 20:14:37.885 +07:00 [DBG] Policy authentication schemes  did not succeed
2025-05-04 20:14:37.887 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-04 20:14:37.893 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-04 20:14:37.894 +07:00 [INF] HTTP GET /api/Users/me responded 401 in 15.1169 ms
2025-05-04 20:14:37.896 +07:00 [DBG] Connection id "0HNCB1MASHLRQ" completed keep alive response.
2025-05-04 20:14:37.898 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/me - 401 0 null 38.0403ms
2025-05-04 20:15:38.195 +07:00 [DBG] Connection id "0HNCB1MASHLRR" received FIN.
2025-05-04 20:15:38.200 +07:00 [DBG] Connection id "0HNCB1MASHLRR" disconnecting.
2025-05-04 20:15:38.201 +07:00 [DBG] Connection id "0HNCB1MASHLRR" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 20:15:38.208 +07:00 [DBG] Connection id "0HNCB1MASHLRR" stopped.
2025-05-04 20:16:49.017 +07:00 [DBG] Connection id "0HNCB1MASHLRQ" disconnecting.
2025-05-04 20:16:49.022 +07:00 [DBG] Connection id "0HNCB1MASHLRQ" stopped.
2025-05-04 20:16:49.026 +07:00 [DBG] Connection id "0HNCB1MASHLRQ" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 20:19:57.560 +07:00 [DBG] Connection id "0HNCB1MASHLRS" accepted.
2025-05-04 20:19:57.565 +07:00 [DBG] Connection id "0HNCB1MASHLRS" started.
2025-05-04 20:19:57.567 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 64
2025-05-04 20:19:57.571 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 20:19:57.573 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 20:19:57.580 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 20:19:57.583 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 20:19:57.585 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 20:19:57.587 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 20:19:57.597 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 20:19:57.601 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 20:19:57.603 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 20:19:57.604 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 20:19:57.605 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 20:19:57.608 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 20:19:57.610 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 20:19:57.616 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 20:19:57.620 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 20:19:57.623 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 20:19:57.625 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 20:19:57.630 +07:00 [DBG] Connection id "0HNCB1MASHLRS", Request id "0HNCB1MASHLRS:00000001": started reading request body.
2025-05-04 20:19:57.632 +07:00 [DBG] Connection id "0HNCB1MASHLRS", Request id "0HNCB1MASHLRS:00000001": done reading request body.
2025-05-04 20:19:57.641 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 20:19:57.643 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 20:19:57.646 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 20:19:57.649 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 20:19:57.654 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 20:19:57.671 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 20:19:57.676 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .FirstOrDefault(u => u.Email == __email_0)'
2025-05-04 20:19:57.679 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-04 20:19:57.688 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE u.email == @__email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE u.email == @__email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            Role entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<Email>k__BackingField = dataReader.GetString(2);
                                    instance.<FullName>k__BackingField = dataReader.GetString(3);
                                    instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(4);
                                    instance.<Password>k__BackingField = dataReader.GetString(5);
                                    instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                    instance.<Phone>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(8) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(8);
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(9);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                Role instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(Role);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(11) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (Role)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                            {
                                return 
                                {
                                    Role instance;
                                    instance = new Role();
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                    instance.<RoleName>k__BackingField = dataReader.GetString(12);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Role)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
                fixup: (namelessParameter{8}, namelessParameter{9}) => 
                {
                    namelessParameter{8}.<Role>k__BackingField = namelessParameter{9};
                    return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                        entity: namelessParameter{9}, 
                        value: namelessParameter{8}, 
                        forMaterialization: True);
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-04 20:19:57.712 +07:00 [DBG] Creating DbConnection.
2025-05-04 20:19:57.713 +07:00 [DBG] Created DbConnection. (1ms).
2025-05-04 20:19:57.714 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:19:57.716 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:19:57.717 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 20:19:57.718 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 20:19:57.719 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 20:19:57.720 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 20:19:57.729 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 20:19:57.731 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:19:57.733 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:19:57.734 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:19:57.735 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:19:57.736 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 5ms reading results.
2025-05-04 20:19:57.737 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:19:57.738 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 20:19:57.984 +07:00 [WRN] Login failed: invalid password for nguyetnkhuyen@gmail.com
2025-05-04 20:19:57.989 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 20:19:57.994 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 20:19:57.995 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 20:19:57.996 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 20:19:57.997 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 20:19:57.998 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType4`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 20:19:58.005 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 394.6114ms
2025-05-04 20:19:58.007 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 20:19:58.008 +07:00 [INF] HTTP POST /api/Auth/login responded 400 in 425.1473 ms
2025-05-04 20:19:58.009 +07:00 [DBG] Connection id "0HNCB1MASHLRS" completed keep alive response.
2025-05-04 20:19:58.011 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 20:19:58.012 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:19:58.013 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 20:19:58.014 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 400 null application/json; charset=utf-8 447.9148ms
2025-05-04 20:20:14.917 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 72
2025-05-04 20:20:14.927 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 20:20:14.930 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 20:20:14.955 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 20:20:14.958 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 20:20:14.961 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 20:20:14.965 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 20:20:14.967 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 20:20:14.972 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 20:20:14.974 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 20:20:14.976 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 20:20:14.978 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 20:20:14.979 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 20:20:14.980 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 20:20:14.983 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 20:20:14.984 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 20:20:14.985 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 20:20:14.986 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 20:20:14.988 +07:00 [DBG] Connection id "0HNCB1MASHLRS", Request id "0HNCB1MASHLRS:00000002": started reading request body.
2025-05-04 20:20:14.989 +07:00 [DBG] Connection id "0HNCB1MASHLRS", Request id "0HNCB1MASHLRS:00000002": done reading request body.
2025-05-04 20:20:14.991 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 20:20:14.992 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 20:20:14.993 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 20:20:14.994 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 20:20:14.995 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 20:20:15.038 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 20:20:15.047 +07:00 [DBG] Creating DbConnection.
2025-05-04 20:20:15.051 +07:00 [DBG] Created DbConnection. (4ms).
2025-05-04 20:20:15.054 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:20:15.056 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:20:15.057 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 20:20:15.057 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 20:20:15.058 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 20:20:15.059 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 20:20:15.064 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[email] = @__email_0
2025-05-04 20:20:15.066 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:20:15.067 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:20:15.068 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:20:15.069 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:20:15.070 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 3ms reading results.
2025-05-04 20:20:15.071 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:20:15.072 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 20:20:15.323 +07:00 [INF] User nguyetnkhuyen@gmail.com logged in successfully
2025-05-04 20:20:15.325 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 20:20:15.327 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 20:20:15.327 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 20:20:15.328 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 20:20:15.329 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 20:20:15.330 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType6`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 20:20:15.333 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 353.1839ms
2025-05-04 20:20:15.334 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 20:20:15.336 +07:00 [INF] HTTP POST /api/Auth/login responded 200 in 378.5056 ms
2025-05-04 20:20:15.338 +07:00 [DBG] Connection id "0HNCB1MASHLRS" completed keep alive response.
2025-05-04 20:20:15.340 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 20:20:15.341 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:20:15.343 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 20:20:15.344 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 200 null application/json; charset=utf-8 426.9071ms
2025-05-04 20:21:15.894 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/me - null null
2025-05-04 20:21:15.899 +07:00 [DBG] 2 candidate(s) found for the request path '/api/Users/me'
2025-05-04 20:21:15.905 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 20:21:15.909 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/me'
2025-05-04 20:21:15.915 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 20:21:15.918 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 20:21:15.921 +07:00 [DBG] Successfully validated the token.
2025-05-04 20:21:15.925 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 20:21:15.933 +07:00 [DBG] Authorization was successful.
2025-05-04 20:21:15.935 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 20:21:15.938 +07:00 [INF] Route matched with {action = "GetMe", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMe() on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 20:21:15.944 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 20:21:15.945 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 20:21:15.947 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 20:21:15.949 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 20:21:15.951 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 20:21:15.953 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:21:15.954 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:21:15.956 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 20:21:15.958 +07:00 [DBG] Creating DbConnection.
2025-05-04 20:21:15.958 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 20:21:15.959 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:21:15.960 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:21:15.961 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 20:21:15.962 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 20:21:15.963 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 20:21:15.965 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 20:21:15.971 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 20:21:15.974 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:21:15.976 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:21:15.977 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:21:15.978 +07:00 [DBG] The navigation 'User.Userprofile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:21:15.982 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Userprofile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:21:15.984 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:21:15.985 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 10ms reading results.
2025-05-04 20:21:15.987 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:21:15.988 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 20:21:15.989 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 20:21:15.991 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 20:21:15.991 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 20:21:15.992 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 20:21:15.993 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 20:21:15.993 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO'.
2025-05-04 20:21:15.994 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument) in 41.9503ms
2025-05-04 20:21:15.995 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 20:21:15.997 +07:00 [INF] HTTP GET /api/Users/me responded 200 in 79.0965 ms
2025-05-04 20:21:15.999 +07:00 [DBG] Connection id "0HNCB1MASHLRS" completed keep alive response.
2025-05-04 20:21:16.000 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 20:21:16.002 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:21:16.003 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 20:21:16.005 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/me - 200 null application/json; charset=utf-8 111.197ms
2025-05-04 20:22:02.261 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/me - null null
2025-05-04 20:22:02.266 +07:00 [DBG] 2 candidate(s) found for the request path '/api/Users/me'
2025-05-04 20:22:02.267 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 20:22:02.269 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/me'
2025-05-04 20:22:02.271 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 20:22:02.272 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 20:22:02.274 +07:00 [DBG] Successfully validated the token.
2025-05-04 20:22:02.276 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 20:22:02.278 +07:00 [DBG] Authorization was successful.
2025-05-04 20:22:02.280 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 20:22:02.282 +07:00 [INF] Route matched with {action = "GetMe", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMe() on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 20:22:02.285 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 20:22:02.286 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 20:22:02.288 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 20:22:02.290 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 20:22:02.293 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 20:22:02.296 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:22:02.300 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:22:02.304 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 20:22:02.307 +07:00 [DBG] Creating DbConnection.
2025-05-04 20:22:02.309 +07:00 [DBG] Created DbConnection. (2ms).
2025-05-04 20:22:02.311 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:22:02.314 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:22:02.315 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 20:22:02.316 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-04 20:22:02.318 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 20:22:02.319 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 20:22:02.326 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 20:22:02.330 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:22:02.332 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:22:02.333 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:22:02.334 +07:00 [DBG] The navigation 'User.Userprofile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:22:02.336 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Userprofile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:22:02.338 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:22:02.339 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 8ms reading results.
2025-05-04 20:22:02.342 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:22:02.344 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (2ms).
2025-05-04 20:22:02.346 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 20:22:02.349 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 20:22:02.350 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 20:22:02.351 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 20:22:02.352 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 20:22:02.354 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO'.
2025-05-04 20:22:02.355 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument) in 59.3122ms
2025-05-04 20:22:02.358 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetMe (ExchangeDocument)'
2025-05-04 20:22:02.361 +07:00 [INF] HTTP GET /api/Users/me responded 200 in 88.4948 ms
2025-05-04 20:22:02.362 +07:00 [DBG] Connection id "0HNCB1MASHLRS" completed keep alive response.
2025-05-04 20:22:02.364 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 20:22:02.365 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:22:02.366 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 20:22:02.367 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/me - 200 null application/json; charset=utf-8 106.0946ms
2025-05-04 20:22:20.426 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/me - application/json 95
2025-05-04 20:22:20.431 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me'
2025-05-04 20:22:20.432 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 20:22:20.434 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 20:22:20.439 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 20:22:20.441 +07:00 [DBG] Successfully validated the token.
2025-05-04 20:22:20.444 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 20:22:20.447 +07:00 [DBG] Authorization was successful.
2025-05-04 20:22:20.448 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 20:22:20.451 +07:00 [INF] Route matched with {action = "UpdateMe", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateMe(ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 20:22:20.454 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 20:22:20.457 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 20:22:20.459 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 20:22:20.464 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 20:22:20.467 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 20:22:20.469 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:22:20.471 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:22:20.473 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' ...
2025-05-04 20:22:20.475 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' using the name '' in request data ...
2025-05-04 20:22:20.478 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 20:22:20.481 +07:00 [DBG] Connection id "0HNCB1MASHLRS", Request id "0HNCB1MASHLRS:00000005": started reading request body.
2025-05-04 20:22:20.482 +07:00 [DBG] Connection id "0HNCB1MASHLRS", Request id "0HNCB1MASHLRS:00000005": done reading request body.
2025-05-04 20:22:20.485 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'
2025-05-04 20:22:20.486 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 20:22:20.489 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 20:22:20.491 +07:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' ...
2025-05-04 20:22:20.496 +07:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 20:22:20.498 +07:00 [DBG] The request has model state errors, returning an error response.
2025-05-04 20:22:20.499 +07:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2025-05-04 20:22:20.500 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 20:22:20.502 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 20:22:20.503 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-05-04 20:22:20.506 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-05-04 20:22:20.508 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-04 20:22:20.527 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument) in 58.3168ms
2025-05-04 20:22:20.529 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 20:22:20.530 +07:00 [INF] HTTP PUT /api/Users/me responded 400 in 91.9724 ms
2025-05-04 20:22:20.532 +07:00 [DBG] Connection id "0HNCB1MASHLRS" completed keep alive response.
2025-05-04 20:22:20.533 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/me - 400 null application/problem+json; charset=utf-8 107.1916ms
2025-05-04 20:22:45.274 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/me - application/json 101
2025-05-04 20:22:45.279 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me'
2025-05-04 20:22:45.281 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 20:22:45.284 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 20:22:45.285 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 20:22:45.287 +07:00 [DBG] Successfully validated the token.
2025-05-04 20:22:45.289 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 20:22:45.292 +07:00 [DBG] Authorization was successful.
2025-05-04 20:22:45.294 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 20:22:45.296 +07:00 [INF] Route matched with {action = "UpdateMe", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateMe(ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 20:22:45.300 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 20:22:45.302 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 20:22:45.305 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 20:22:45.308 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 20:22:45.310 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 20:22:45.313 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:22:45.315 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:22:45.319 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' ...
2025-05-04 20:22:45.322 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' using the name '' in request data ...
2025-05-04 20:22:45.326 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 20:22:45.327 +07:00 [DBG] Connection id "0HNCB1MASHLRS", Request id "0HNCB1MASHLRS:00000006": started reading request body.
2025-05-04 20:22:45.329 +07:00 [DBG] Connection id "0HNCB1MASHLRS", Request id "0HNCB1MASHLRS:00000006": done reading request body.
2025-05-04 20:22:45.330 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'
2025-05-04 20:22:45.330 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 20:22:45.331 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 20:22:45.332 +07:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' ...
2025-05-04 20:22:45.334 +07:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 20:22:45.338 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 20:22:45.341 +07:00 [DBG] Creating DbConnection.
2025-05-04 20:22:45.341 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 20:22:45.342 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:22:45.343 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:22:45.343 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 20:22:45.344 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 20:22:45.345 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 20:22:45.346 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 20:22:45.354 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 20:22:45.356 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:22:45.357 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:22:45.358 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:22:45.359 +07:00 [DBG] The navigation 'User.Userprofile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:22:45.360 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Userprofile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:22:45.361 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:22:45.362 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 6ms reading results.
2025-05-04 20:22:45.363 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:22:45.364 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (0ms).
2025-05-04 20:22:45.368 +07:00 [DBG] SaveChanges starting for 'ExchangeDocumentContext'.
2025-05-04 20:22:45.371 +07:00 [DBG] DetectChanges starting for 'ExchangeDocumentContext'.
2025-05-04 20:22:45.380 +07:00 [DBG] The unchanged property 'User.FullName' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-04 20:22:45.386 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:22:45.396 +07:00 [DBG] The unchanged property 'User.UpdatedAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-04 20:22:45.405 +07:00 [DBG] DetectChanges completed for 'ExchangeDocumentContext'.
2025-05-04 20:22:45.448 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:22:45.450 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:22:45.454 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 20:22:45.455 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-04 20:22:45.457 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-05-04 20:22:45.459 +07:00 [DBG] Executing DbCommand [Parameters=[@p2='?' (DbType = Int32), @p0='?' (Size = 255), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [users] SET [fullName] = @p0, [UpdatedAt] = @p1
OUTPUT 1
WHERE [userId] = @p2;
2025-05-04 20:22:45.466 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (Size = 255), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [users] SET [fullName] = @p0, [UpdatedAt] = @p1
OUTPUT 1
WHERE [userId] = @p2;
2025-05-04 20:22:45.474 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:22:45.476 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 7ms reading results.
2025-05-04 20:22:45.480 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:22:45.481 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 20:22:45.487 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:22:45.493 +07:00 [DBG] SaveChanges completed for 'ExchangeDocumentContext' with 1 entities written to the database.
2025-05-04 20:22:45.495 +07:00 [INF] User 3 updated profile at "2025-05-04T13:22:45.3660761Z"
2025-05-04 20:22:45.497 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 20:22:45.501 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 20:22:45.503 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 20:22:45.504 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 20:22:45.506 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 20:22:45.509 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO'.
2025-05-04 20:22:45.512 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument) in 198.4521ms
2025-05-04 20:22:45.515 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 20:22:45.516 +07:00 [INF] HTTP PUT /api/Users/me responded 200 in 231.1715 ms
2025-05-04 20:22:45.521 +07:00 [DBG] Connection id "0HNCB1MASHLRS" completed keep alive response.
2025-05-04 20:22:45.523 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 20:22:45.525 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:22:45.527 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 20:22:45.528 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/me - 200 null application/json; charset=utf-8 253.5465ms
2025-05-04 20:24:02.937 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/me - application/json 101
2025-05-04 20:24:02.942 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me'
2025-05-04 20:24:02.944 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)' with route pattern 'api/Users/me' is valid for the request path '/api/Users/me'
2025-05-04 20:24:02.948 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 20:24:02.951 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 20:24:02.954 +07:00 [DBG] Successfully validated the token.
2025-05-04 20:24:02.955 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 20:24:02.958 +07:00 [DBG] Authorization was successful.
2025-05-04 20:24:02.959 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 20:24:02.962 +07:00 [INF] Route matched with {action = "UpdateMe", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateMe(ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 20:24:02.966 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 20:24:02.969 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 20:24:02.970 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 20:24:02.972 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 20:24:02.973 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 20:24:02.974 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:24:02.976 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:24:02.977 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' ...
2025-05-04 20:24:02.979 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' using the name '' in request data ...
2025-05-04 20:24:02.981 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 20:24:02.982 +07:00 [DBG] Connection id "0HNCB1MASHLRS", Request id "0HNCB1MASHLRS:00000007": started reading request body.
2025-05-04 20:24:02.984 +07:00 [DBG] Connection id "0HNCB1MASHLRS", Request id "0HNCB1MASHLRS:00000007": done reading request body.
2025-05-04 20:24:02.985 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'
2025-05-04 20:24:02.985 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 20:24:02.986 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 20:24:02.987 +07:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO' ...
2025-05-04 20:24:02.989 +07:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.UpdateProfileRequestDTO'.
2025-05-04 20:24:02.990 +07:00 [DBG] The request has model state errors, returning an error response.
2025-05-04 20:24:02.991 +07:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2025-05-04 20:24:02.992 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 20:24:02.994 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 20:24:02.995 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-05-04 20:24:02.997 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-05-04 20:24:02.998 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-04 20:24:02.999 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument) in 25.2881ms
2025-05-04 20:24:03.000 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.UpdateMe (ExchangeDocument)'
2025-05-04 20:24:03.001 +07:00 [INF] HTTP PUT /api/Users/me responded 400 in 50.0997 ms
2025-05-04 20:24:03.002 +07:00 [DBG] Connection id "0HNCB1MASHLRS" completed keep alive response.
2025-05-04 20:24:03.003 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/me - 400 null application/problem+json; charset=utf-8 66.3577ms
2025-05-04 20:24:16.333 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/me/change-password - application/json 89
2025-05-04 20:24:16.339 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me/change-password'
2025-05-04 20:24:16.341 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)' with route pattern 'api/Users/me/change-password' is valid for the request path '/api/Users/me/change-password'
2025-05-04 20:24:16.344 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)'
2025-05-04 20:24:16.345 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 20:24:16.346 +07:00 [DBG] Successfully validated the token.
2025-05-04 20:24:16.347 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 20:24:16.350 +07:00 [DBG] Authorization was successful.
2025-05-04 20:24:16.354 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)'
2025-05-04 20:24:16.361 +07:00 [INF] Route matched with {action = "ChangePassword", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ChangePassword(ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 20:24:16.364 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 20:24:16.365 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 20:24:16.367 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 20:24:16.370 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 20:24:16.371 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 20:24:16.373 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:24:16.376 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:24:16.378 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO' ...
2025-05-04 20:24:16.380 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO' using the name '' in request data ...
2025-05-04 20:24:16.382 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 20:24:16.384 +07:00 [DBG] Connection id "0HNCB1MASHLRS", Request id "0HNCB1MASHLRS:00000008": started reading request body.
2025-05-04 20:24:16.385 +07:00 [DBG] Connection id "0HNCB1MASHLRS", Request id "0HNCB1MASHLRS:00000008": done reading request body.
2025-05-04 20:24:16.388 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'
2025-05-04 20:24:16.389 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'.
2025-05-04 20:24:16.390 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'.
2025-05-04 20:24:16.392 +07:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO' ...
2025-05-04 20:24:16.396 +07:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'.
2025-05-04 20:24:16.397 +07:00 [DBG] The request has model state errors, returning an error response.
2025-05-04 20:24:16.398 +07:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2025-05-04 20:24:16.399 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 20:24:16.402 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 20:24:16.402 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-05-04 20:24:16.405 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-05-04 20:24:16.407 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-04 20:24:16.409 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument) in 36.5436ms
2025-05-04 20:24:16.411 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)'
2025-05-04 20:24:16.412 +07:00 [INF] HTTP PUT /api/Users/me/change-password responded 400 in 66.9259 ms
2025-05-04 20:24:16.413 +07:00 [DBG] Connection id "0HNCB1MASHLRS" completed keep alive response.
2025-05-04 20:24:16.415 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/me/change-password - 400 null application/problem+json; charset=utf-8 81.2307ms
2025-05-04 20:24:41.886 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/me/change-password - application/json 91
2025-05-04 20:24:41.891 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/me/change-password'
2025-05-04 20:24:41.893 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)' with route pattern 'api/Users/me/change-password' is valid for the request path '/api/Users/me/change-password'
2025-05-04 20:24:41.896 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)'
2025-05-04 20:24:41.897 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 20:24:41.898 +07:00 [DBG] Successfully validated the token.
2025-05-04 20:24:41.899 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 20:24:41.900 +07:00 [DBG] Authorization was successful.
2025-05-04 20:24:41.900 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)'
2025-05-04 20:24:41.901 +07:00 [INF] Route matched with {action = "ChangePassword", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ChangePassword(ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 20:24:41.904 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 20:24:41.908 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 20:24:41.911 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 20:24:41.914 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 20:24:41.916 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 20:24:41.918 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:24:41.919 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:24:41.921 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO' ...
2025-05-04 20:24:41.924 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO' using the name '' in request data ...
2025-05-04 20:24:41.926 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 20:24:41.927 +07:00 [DBG] Connection id "0HNCB1MASHLRS", Request id "0HNCB1MASHLRS:00000009": started reading request body.
2025-05-04 20:24:41.928 +07:00 [DBG] Connection id "0HNCB1MASHLRS", Request id "0HNCB1MASHLRS:00000009": done reading request body.
2025-05-04 20:24:41.929 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'
2025-05-04 20:24:41.930 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'.
2025-05-04 20:24:41.931 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'.
2025-05-04 20:24:41.932 +07:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO' ...
2025-05-04 20:24:41.934 +07:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.ChangePasswordRequestDTO'.
2025-05-04 20:24:41.940 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 20:24:41.943 +07:00 [DBG] Creating DbConnection.
2025-05-04 20:24:41.943 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 20:24:41.944 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:24:41.946 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:24:41.947 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 20:24:41.949 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-04 20:24:41.950 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 20:24:41.951 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 20:24:41.959 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 20:24:41.962 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:24:41.964 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:24:41.965 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:24:41.967 +07:00 [DBG] The navigation 'User.Userprofile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:24:41.968 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Userprofile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:24:41.970 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:24:41.973 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 11ms reading results.
2025-05-04 20:24:41.975 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:24:41.977 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 20:24:42.122 +07:00 [WRN] ChangePassword failed: incorrect old password for user 3
2025-05-04 20:24:42.124 +07:00 [WRN] ChangePassword failed: Current password is incorrect.
2025-05-04 20:24:42.127 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 20:24:42.131 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 20:24:42.134 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 20:24:42.135 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 20:24:42.139 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 20:24:42.141 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 20:24:42.145 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument) in 227.2367ms
2025-05-04 20:24:42.147 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.ChangePassword (ExchangeDocument)'
2025-05-04 20:24:42.148 +07:00 [INF] HTTP PUT /api/Users/me/change-password responded 400 in 251.5433 ms
2025-05-04 20:24:42.153 +07:00 [DBG] Connection id "0HNCB1MASHLRS" completed keep alive response.
2025-05-04 20:24:42.157 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 20:24:42.159 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:24:42.161 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 20:24:42.163 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/me/change-password - 400 null application/json; charset=utf-8 276.1862ms
2025-05-04 20:25:52.862 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=52 - null null
2025-05-04 20:25:52.866 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users'
2025-05-04 20:25:52.867 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)' with route pattern 'api/Users' is valid for the request path '/api/Users'
2025-05-04 20:25:52.869 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 20:25:52.887 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 20:25:52.889 +07:00 [DBG] Successfully validated the token.
2025-05-04 20:25:52.891 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 20:25:52.897 +07:00 [DBG] Authorization was successful.
2025-05-04 20:25:52.898 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 20:25:52.902 +07:00 [INF] Route matched with {action = "GetAll", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Int32, Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 20:25:52.904 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 20:25:52.906 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 20:25:52.907 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 20:25:52.909 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 20:25:52.912 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 20:25:52.915 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:25:52.917 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:25:52.920 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 20:25:52.922 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' using the name 'pageNumber' in request data ...
2025-05-04 20:25:52.923 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 20:25:52.924 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 20:25:52.925 +07:00 [DBG] Attempting to validate the bound parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 20:25:52.926 +07:00 [DBG] Done attempting to validate the bound parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 20:25:52.928 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 20:25:52.930 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' using the name 'pageSize' in request data ...
2025-05-04 20:25:52.931 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 20:25:52.932 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 20:25:52.934 +07:00 [DBG] Attempting to validate the bound parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 20:25:52.935 +07:00 [DBG] Done attempting to validate the bound parameter 'pageSize' of type 'System.Int32'.
2025-05-04 20:25:52.936 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 20:25:52.938 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 20:25:52.939 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 20:25:52.939 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 20:25:52.940 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 20:25:52.941 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 20:25:52.942 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument) in 27.3286ms
2025-05-04 20:25:52.944 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 20:25:52.946 +07:00 [INF] HTTP GET /api/Users responded 400 in 58.2819 ms
2025-05-04 20:25:52.948 +07:00 [DBG] Connection id "0HNCB1MASHLRS" completed keep alive response.
2025-05-04 20:25:52.949 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=52 - 400 null application/json; charset=utf-8 86.8782ms
2025-05-04 20:26:13.575 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=50 - null null
2025-05-04 20:26:13.580 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users'
2025-05-04 20:26:13.583 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)' with route pattern 'api/Users' is valid for the request path '/api/Users'
2025-05-04 20:26:13.585 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 20:26:13.588 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 20:26:13.591 +07:00 [DBG] Successfully validated the token.
2025-05-04 20:26:13.595 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 20:26:13.596 +07:00 [DBG] Authorization was successful.
2025-05-04 20:26:13.598 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 20:26:13.599 +07:00 [INF] Route matched with {action = "GetAll", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Int32, Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 20:26:13.601 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 20:26:13.602 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 20:26:13.603 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 20:26:13.605 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 20:26:13.606 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 20:26:13.607 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:26:13.609 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:26:13.611 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 20:26:13.612 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' using the name 'pageNumber' in request data ...
2025-05-04 20:26:13.614 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 20:26:13.615 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 20:26:13.616 +07:00 [DBG] Attempting to validate the bound parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 20:26:13.617 +07:00 [DBG] Done attempting to validate the bound parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 20:26:13.618 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 20:26:13.619 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' using the name 'pageSize' in request data ...
2025-05-04 20:26:13.620 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 20:26:13.622 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 20:26:13.623 +07:00 [DBG] Attempting to validate the bound parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 20:26:13.625 +07:00 [DBG] Done attempting to validate the bound parameter 'pageSize' of type 'System.Int32'.
2025-05-04 20:26:13.631 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 20:26:13.635 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-05-04 20:26:13.650 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: SingleQueryingEnumerable.Create<int>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM users AS u) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM users AS u, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            int? value1;
            value1 = dataReader.IsDBNull(0) ? default(int?) : (int?)dataReader.GetInt32(0);
            return (int)value1;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-04 20:26:13.661 +07:00 [DBG] Creating DbConnection.
2025-05-04 20:26:13.662 +07:00 [DBG] Created DbConnection. (1ms).
2025-05-04 20:26:13.663 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:13.665 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:13.667 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 20:26:13.668 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 20:26:13.668 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 20:26:13.670 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [users] AS [u]
2025-05-04 20:26:13.674 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [users] AS [u]
2025-05-04 20:26:13.680 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:13.681 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 2ms reading results.
2025-05-04 20:26:13.682 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:13.683 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 20:26:13.688 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .Include(u => u.Userprofile)
    .OrderBy(u => u.UserId)
    .Skip(__p_0)
    .Take(__p_1)'
2025-05-04 20:26:13.691 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-04 20:26:13.693 +07:00 [DBG] Including navigation: 'User.Userprofile'.
2025-05-04 20:26:13.707 +07:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<User>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
            1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
        SELECT u0.userId, u0.CreatedAt, u0.email, u0.fullName, u0.IsEmailVerified, u0.password, u0.PasswordResetToken, u0.phone, u0.ResetTokenExpires, u0.roleId, u0.UpdatedAt, r.roleId, r.roleName, u1.userprofileId, u1.address, u1.birth, u1.userId
        FROM 
        (
            SELECT u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt
            FROM users AS u
            ORDER BY u.userId ASC
            OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
        ) AS u0
        INNER JOIN roles AS r ON u0.roleId == r.roleId
        LEFT JOIN userprofiles AS u1 ON u0.userId == u1.userId
        ORDER BY u0.userId ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
            1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
        SELECT u0.userId, u0.CreatedAt, u0.email, u0.fullName, u0.IsEmailVerified, u0.password, u0.PasswordResetToken, u0.phone, u0.ResetTokenExpires, u0.roleId, u0.UpdatedAt, r.roleId, r.roleName, u1.userprofileId, u1.address, u1.birth, u1.userId
        FROM 
        (
            SELECT u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt
            FROM users AS u
            ORDER BY u.userId ASC
            OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
        ) AS u0
        INNER JOIN roles AS r ON u0.roleId == r.roleId
        LEFT JOIN userprofiles AS u1 ON u0.userId == u1.userId
        ORDER BY u0.userId ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        User entity;
        Role entity;
        Userprofile entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            User instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(User);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (User)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                        {
                            return 
                            {
                                User instance;
                                instance = new User();
                                instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                instance.<Email>k__BackingField = dataReader.GetString(2);
                                instance.<FullName>k__BackingField = dataReader.GetString(3);
                                instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(4);
                                instance.<Password>k__BackingField = dataReader.GetString(5);
                                instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                instance.<Phone>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(8) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(8);
                                instance.<RoleId>k__BackingField = dataReader.GetInt32(9);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(User)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        entity = 
        {
            MaterializationContext materializationContext2;
            IEntityType entityType2;
            Role instance2;
            InternalEntityEntry entry2;
            bool hasNullKey2;
            materializationContext2 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance2 = default(Role);
            entry2 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(11) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey2);
            !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
            {
                entityType2 = entry2.EntityType;
                return instance2 = (Role)entry2.Entity;
            } : 
            {
                ISnapshot shadowSnapshot2;
                shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                instance2 = switch (entityType2)
                {
                    case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                        {
                            return 
                            {
                                Role instance;
                                instance = new Role();
                                instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                instance.<RoleName>k__BackingField = dataReader.GetString(12);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext2.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Role)
                }
                ;
                entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType2, 
                    entity: instance2, 
                    snapshot: shadowSnapshot2);
                return instance2;
            } : default(void);
            return instance2;
        };
        entity = 
        {
            MaterializationContext materializationContext3;
            IEntityType entityType3;
            Userprofile instance3;
            InternalEntityEntry entry3;
            bool hasNullKey3;
            materializationContext3 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance3 = default(Userprofile);
            entry3 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Userprofile.UserprofileId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindPrimaryKey()], 
                keyValues: new object[]{ dataReader.IsDBNull(13) ? default(object) : (object)dataReader.GetInt32(13) }, 
                throwOnNullKey: False, 
                hasNullKey: hasNullKey3);
            !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
            {
                entityType3 = entry3.EntityType;
                return instance3 = (Userprofile)entry3.Entity;
            } : 
            {
                ISnapshot shadowSnapshot3;
                shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType3 = [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")];
                instance3 = switch (entityType3)
                {
                    case [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]: 
                        {
                            return 
                            {
                                Userprofile instance;
                                instance = new Userprofile();
                                instance.<UserprofileId>k__BackingField = dataReader.IsDBNull(13) ? default(int) : dataReader.GetInt32(13);
                                instance.<Address>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                instance.<Birth>k__BackingField = dataReader.IsDBNull(15) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(15);
                                instance.<UserId>k__BackingField = dataReader.IsDBNull(16) ? default(int) : dataReader.GetInt32(16);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext3.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Userprofile)
                }
                ;
                entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType3, 
                    entity: instance3, 
                    snapshot: shadowSnapshot3);
                return instance3;
            } : default(void);
            return instance3;
        };
        ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
            fixup: (namelessParameter{11}, namelessParameter{12}) => 
            {
                namelessParameter{11}.<Role>k__BackingField = namelessParameter{12};
                return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                    entity: namelessParameter{12}, 
                    value: namelessParameter{11}, 
                    forMaterialization: True);
            }, 
            trackingQuery: True);
        ShaperProcessingExpressionVisitor.IncludeReference<User, User, Userprofile>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: User.Userprofile (Userprofile) ToDependent Userprofile Inverse: User | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Userprofile")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Userprofile.User (User) ToPrincipal User Inverse: Userprofile | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindNavigation("User")], 
            fixup: (namelessParameter{16}, namelessParameter{17}) => 
            {
                namelessParameter{16}.<Userprofile>k__BackingField = namelessParameter{17};
                return namelessParameter{17}.<User>k__BackingField = namelessParameter{16};
            }, 
            trackingQuery: True);
        return entity;
    }, 
    contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-05-04 20:26:13.739 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:13.745 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:13.746 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 20:26:13.748 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-04 20:26:13.749 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 20:26:13.750 +07:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[userId], [u0].[CreatedAt], [u0].[email], [u0].[fullName], [u0].[IsEmailVerified], [u0].[password], [u0].[PasswordResetToken], [u0].[phone], [u0].[ResetTokenExpires], [u0].[roleId], [u0].[UpdatedAt], [r].[roleId], [r].[roleName], [u1].[userprofileId], [u1].[address], [u1].[birth], [u1].[userId]
FROM (
    SELECT [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
    FROM [users] AS [u]
    ORDER BY [u].[userId]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [roles] AS [r] ON [u0].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u1] ON [u0].[userId] = [u1].[userId]
ORDER BY [u0].[userId]
2025-05-04 20:26:13.758 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[userId], [u0].[CreatedAt], [u0].[email], [u0].[fullName], [u0].[IsEmailVerified], [u0].[password], [u0].[PasswordResetToken], [u0].[phone], [u0].[ResetTokenExpires], [u0].[roleId], [u0].[UpdatedAt], [r].[roleId], [r].[roleName], [u1].[userprofileId], [u1].[address], [u1].[birth], [u1].[userId]
FROM (
    SELECT [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
    FROM [users] AS [u]
    ORDER BY [u].[userId]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [roles] AS [r] ON [u0].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u1] ON [u0].[userId] = [u1].[userId]
ORDER BY [u0].[userId]
2025-05-04 20:26:13.765 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:26:13.766 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:26:13.767 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:26:13.770 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:26:13.771 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:26:13.773 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:26:13.774 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:26:13.778 +07:00 [DBG] The navigation 'User.Userprofile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:26:13.780 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Userprofile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:26:13.782 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:13.783 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 18ms reading results.
2025-05-04 20:26:13.785 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:13.786 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 20:26:13.788 +07:00 [INF] Admin fetched users page 1 with size 50
2025-05-04 20:26:13.789 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 20:26:13.794 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 20:26:13.795 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 20:26:13.797 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 20:26:13.798 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 20:26:13.799 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.PagedResponseDTO`1[[ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO, ExchangeDocument, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 20:26:13.803 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument) in 195.9162ms
2025-05-04 20:26:13.804 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 20:26:13.805 +07:00 [INF] HTTP GET /api/Users responded 200 in 217.5018 ms
2025-05-04 20:26:13.807 +07:00 [DBG] Connection id "0HNCB1MASHLRS" completed keep alive response.
2025-05-04 20:26:13.810 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 20:26:13.812 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:13.814 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 20:26:13.815 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=50 - 200 null application/json; charset=utf-8 239.8037ms
2025-05-04 20:26:23.108 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=52 - null null
2025-05-04 20:26:23.114 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users'
2025-05-04 20:26:23.116 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)' with route pattern 'api/Users' is valid for the request path '/api/Users'
2025-05-04 20:26:23.120 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 20:26:23.122 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 20:26:23.128 +07:00 [DBG] Successfully validated the token.
2025-05-04 20:26:23.130 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 20:26:23.131 +07:00 [DBG] Authorization was successful.
2025-05-04 20:26:23.132 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 20:26:23.134 +07:00 [INF] Route matched with {action = "GetAll", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Int32, Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 20:26:23.137 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 20:26:23.138 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 20:26:23.141 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 20:26:23.144 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 20:26:23.146 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 20:26:23.150 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:26:23.152 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:26:23.156 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 20:26:23.159 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' using the name 'pageNumber' in request data ...
2025-05-04 20:26:23.162 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 20:26:23.165 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 20:26:23.167 +07:00 [DBG] Attempting to validate the bound parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 20:26:23.169 +07:00 [DBG] Done attempting to validate the bound parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 20:26:23.171 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 20:26:23.174 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' using the name 'pageSize' in request data ...
2025-05-04 20:26:23.177 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 20:26:23.179 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 20:26:23.180 +07:00 [DBG] Attempting to validate the bound parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 20:26:23.182 +07:00 [DBG] Done attempting to validate the bound parameter 'pageSize' of type 'System.Int32'.
2025-05-04 20:26:23.184 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 20:26:23.188 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 20:26:23.189 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 20:26:23.190 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 20:26:23.191 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 20:26:23.193 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 20:26:23.195 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument) in 45.6662ms
2025-05-04 20:26:23.197 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 20:26:23.198 +07:00 [INF] HTTP GET /api/Users responded 400 in 75.9110 ms
2025-05-04 20:26:23.200 +07:00 [DBG] Connection id "0HNCB1MASHLRS" completed keep alive response.
2025-05-04 20:26:23.201 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=52 - 400 null application/json; charset=utf-8 93.1548ms
2025-05-04 20:26:32.451 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=2&pageSize=50 - null null
2025-05-04 20:26:32.454 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users'
2025-05-04 20:26:32.455 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)' with route pattern 'api/Users' is valid for the request path '/api/Users'
2025-05-04 20:26:32.459 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 20:26:32.462 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 20:26:32.463 +07:00 [DBG] Successfully validated the token.
2025-05-04 20:26:32.467 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 20:26:32.486 +07:00 [DBG] Authorization was successful.
2025-05-04 20:26:32.487 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 20:26:32.489 +07:00 [INF] Route matched with {action = "GetAll", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Int32, Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 20:26:32.492 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 20:26:32.495 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 20:26:32.497 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 20:26:32.499 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 20:26:32.500 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 20:26:32.501 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:26:32.503 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:26:32.504 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 20:26:32.505 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' using the name 'pageNumber' in request data ...
2025-05-04 20:26:32.507 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 20:26:32.509 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 20:26:32.510 +07:00 [DBG] Attempting to validate the bound parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 20:26:32.511 +07:00 [DBG] Done attempting to validate the bound parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 20:26:32.512 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 20:26:32.513 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' using the name 'pageSize' in request data ...
2025-05-04 20:26:32.514 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 20:26:32.515 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 20:26:32.516 +07:00 [DBG] Attempting to validate the bound parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 20:26:32.517 +07:00 [DBG] Done attempting to validate the bound parameter 'pageSize' of type 'System.Int32'.
2025-05-04 20:26:32.519 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 20:26:32.521 +07:00 [DBG] Creating DbConnection.
2025-05-04 20:26:32.522 +07:00 [DBG] Created DbConnection. (1ms).
2025-05-04 20:26:32.523 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:32.525 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:32.526 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 20:26:32.527 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 20:26:32.528 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 20:26:32.529 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [users] AS [u]
2025-05-04 20:26:32.532 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [users] AS [u]
2025-05-04 20:26:32.534 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:32.536 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 1ms reading results.
2025-05-04 20:26:32.537 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:32.538 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 20:26:32.541 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .Include(u => u.Userprofile)
    .OrderBy(u => u.UserId)
    .Skip(__p_0)
    .Take(__p_0)'
2025-05-04 20:26:32.543 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-04 20:26:32.544 +07:00 [DBG] Including navigation: 'User.Userprofile'.
2025-05-04 20:26:32.551 +07:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<User>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
            1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
        SELECT u0.userId, u0.CreatedAt, u0.email, u0.fullName, u0.IsEmailVerified, u0.password, u0.PasswordResetToken, u0.phone, u0.ResetTokenExpires, u0.roleId, u0.UpdatedAt, r.roleId, r.roleName, u1.userprofileId, u1.address, u1.birth, u1.userId
        FROM 
        (
            SELECT u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt
            FROM users AS u
            ORDER BY u.userId ASC
            OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
        ) AS u0
        INNER JOIN roles AS r ON u0.roleId == r.roleId
        LEFT JOIN userprofiles AS u1 ON u0.userId == u1.userId
        ORDER BY u0.userId ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Required Index MaxLength(255), 2], [Property: User.FullName (string) Required MaxLength(255), 3], [Property: User.IsEmailVerified (bool) Required, 4], [Property: User.Password (string) Required MaxLength(255), 5], [Property: User.PasswordResetToken (string), 6], [Property: User.Phone (string) MaxLength(20), 7], [Property: User.ResetTokenExpires (DateTime?), 8], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 9], [Property: User.UpdatedAt (DateTime?), 10] }
            1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: Role.RoleName (string) Required Index MaxLength(50), 12] }
            2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Userprofile.Address (string) MaxLength(500), 14], [Property: Userprofile.Birth (DateTime?), 15], [Property: Userprofile.UserId (int) Required FK Index, 16] }
        SELECT u0.userId, u0.CreatedAt, u0.email, u0.fullName, u0.IsEmailVerified, u0.password, u0.PasswordResetToken, u0.phone, u0.ResetTokenExpires, u0.roleId, u0.UpdatedAt, r.roleId, r.roleName, u1.userprofileId, u1.address, u1.birth, u1.userId
        FROM 
        (
            SELECT u.userId, u.CreatedAt, u.email, u.fullName, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt
            FROM users AS u
            ORDER BY u.userId ASC
            OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
        ) AS u0
        INNER JOIN roles AS r ON u0.roleId == r.roleId
        LEFT JOIN userprofiles AS u1 ON u0.userId == u1.userId
        ORDER BY u0.userId ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        User entity;
        Role entity;
        Userprofile entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            User instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(User);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (User)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                        {
                            return 
                            {
                                User instance;
                                instance = new User();
                                instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                instance.<Email>k__BackingField = dataReader.GetString(2);
                                instance.<FullName>k__BackingField = dataReader.GetString(3);
                                instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(4);
                                instance.<Password>k__BackingField = dataReader.GetString(5);
                                instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                instance.<Phone>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(8) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(8);
                                instance.<RoleId>k__BackingField = dataReader.GetInt32(9);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(User)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        entity = 
        {
            MaterializationContext materializationContext2;
            IEntityType entityType2;
            Role instance2;
            InternalEntityEntry entry2;
            bool hasNullKey2;
            materializationContext2 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance2 = default(Role);
            entry2 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(11) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey2);
            !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
            {
                entityType2 = entry2.EntityType;
                return instance2 = (Role)entry2.Entity;
            } : 
            {
                ISnapshot shadowSnapshot2;
                shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                instance2 = switch (entityType2)
                {
                    case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                        {
                            return 
                            {
                                Role instance;
                                instance = new Role();
                                instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                instance.<RoleName>k__BackingField = dataReader.GetString(12);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext2.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Role)
                }
                ;
                entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType2, 
                    entity: instance2, 
                    snapshot: shadowSnapshot2);
                return instance2;
            } : default(void);
            return instance2;
        };
        entity = 
        {
            MaterializationContext materializationContext3;
            IEntityType entityType3;
            Userprofile instance3;
            InternalEntityEntry entry3;
            bool hasNullKey3;
            materializationContext3 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance3 = default(Userprofile);
            entry3 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Userprofile.UserprofileId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindPrimaryKey()], 
                keyValues: new object[]{ dataReader.IsDBNull(13) ? default(object) : (object)dataReader.GetInt32(13) }, 
                throwOnNullKey: False, 
                hasNullKey: hasNullKey3);
            !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
            {
                entityType3 = entry3.EntityType;
                return instance3 = (Userprofile)entry3.Entity;
            } : 
            {
                ISnapshot shadowSnapshot3;
                shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType3 = [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")];
                instance3 = switch (entityType3)
                {
                    case [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]: 
                        {
                            return 
                            {
                                Userprofile instance;
                                instance = new Userprofile();
                                instance.<UserprofileId>k__BackingField = dataReader.IsDBNull(13) ? default(int) : dataReader.GetInt32(13);
                                instance.<Address>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                instance.<Birth>k__BackingField = dataReader.IsDBNull(15) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(15);
                                instance.<UserId>k__BackingField = dataReader.IsDBNull(16) ? default(int) : dataReader.GetInt32(16);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext3.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Userprofile)
                }
                ;
                entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType3, 
                    entity: instance3, 
                    snapshot: shadowSnapshot3);
                return instance3;
            } : default(void);
            return instance3;
        };
        ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
            fixup: (namelessParameter{11}, namelessParameter{12}) => 
            {
                namelessParameter{11}.<Role>k__BackingField = namelessParameter{12};
                return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                    entity: namelessParameter{12}, 
                    value: namelessParameter{11}, 
                    forMaterialization: True);
            }, 
            trackingQuery: True);
        ShaperProcessingExpressionVisitor.IncludeReference<User, User, Userprofile>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: User.Userprofile (Userprofile) ToDependent Userprofile Inverse: User | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Userprofile")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Userprofile.User (User) ToPrincipal User Inverse: Userprofile | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindNavigation("User")], 
            fixup: (namelessParameter{16}, namelessParameter{17}) => 
            {
                namelessParameter{16}.<Userprofile>k__BackingField = namelessParameter{17};
                return namelessParameter{17}.<User>k__BackingField = namelessParameter{16};
            }, 
            trackingQuery: True);
        return entity;
    }, 
    contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-05-04 20:26:32.584 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:32.586 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:32.588 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 20:26:32.590 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-04 20:26:32.592 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-05-04 20:26:32.594 +07:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[userId], [u0].[CreatedAt], [u0].[email], [u0].[fullName], [u0].[IsEmailVerified], [u0].[password], [u0].[PasswordResetToken], [u0].[phone], [u0].[ResetTokenExpires], [u0].[roleId], [u0].[UpdatedAt], [r].[roleId], [r].[roleName], [u1].[userprofileId], [u1].[address], [u1].[birth], [u1].[userId]
FROM (
    SELECT [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
    FROM [users] AS [u]
    ORDER BY [u].[userId]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [u0]
INNER JOIN [roles] AS [r] ON [u0].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u1] ON [u0].[userId] = [u1].[userId]
ORDER BY [u0].[userId]
2025-05-04 20:26:32.601 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[userId], [u0].[CreatedAt], [u0].[email], [u0].[fullName], [u0].[IsEmailVerified], [u0].[password], [u0].[PasswordResetToken], [u0].[phone], [u0].[ResetTokenExpires], [u0].[roleId], [u0].[UpdatedAt], [r].[roleId], [r].[roleName], [u1].[userprofileId], [u1].[address], [u1].[birth], [u1].[userId]
FROM (
    SELECT [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
    FROM [users] AS [u]
    ORDER BY [u].[userId]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [u0]
INNER JOIN [roles] AS [r] ON [u0].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u1] ON [u0].[userId] = [u1].[userId]
ORDER BY [u0].[userId]
2025-05-04 20:26:32.606 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:32.608 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 2ms reading results.
2025-05-04 20:26:32.611 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:32.613 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (2ms).
2025-05-04 20:26:32.615 +07:00 [INF] Admin fetched users page 2 with size 50
2025-05-04 20:26:32.616 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 20:26:32.620 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 20:26:32.620 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 20:26:32.622 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 20:26:32.623 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 20:26:32.625 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.PagedResponseDTO`1[[ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO, ExchangeDocument, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 20:26:32.627 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument) in 125.8349ms
2025-05-04 20:26:32.629 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 20:26:32.630 +07:00 [INF] HTTP GET /api/Users responded 200 in 168.8362 ms
2025-05-04 20:26:32.632 +07:00 [DBG] Connection id "0HNCB1MASHLRS" completed keep alive response.
2025-05-04 20:26:32.634 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 20:26:32.635 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:32.636 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 20:26:32.637 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=2&pageSize=50 - 200 null application/json; charset=utf-8 186.6253ms
2025-05-04 20:26:37.555 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=50 - null null
2025-05-04 20:26:37.559 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users'
2025-05-04 20:26:37.561 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)' with route pattern 'api/Users' is valid for the request path '/api/Users'
2025-05-04 20:26:37.563 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 20:26:37.566 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 20:26:37.567 +07:00 [DBG] Successfully validated the token.
2025-05-04 20:26:37.569 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 20:26:37.574 +07:00 [DBG] Authorization was successful.
2025-05-04 20:26:37.575 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 20:26:37.577 +07:00 [INF] Route matched with {action = "GetAll", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Int32, Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 20:26:37.581 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 20:26:37.583 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 20:26:37.584 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 20:26:37.586 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 20:26:37.589 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 20:26:37.592 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:26:37.594 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:26:37.596 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 20:26:37.597 +07:00 [DBG] Attempting to bind parameter 'pageNumber' of type 'System.Int32' using the name 'pageNumber' in request data ...
2025-05-04 20:26:37.599 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 20:26:37.600 +07:00 [DBG] Done attempting to bind parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 20:26:37.602 +07:00 [DBG] Attempting to validate the bound parameter 'pageNumber' of type 'System.Int32' ...
2025-05-04 20:26:37.604 +07:00 [DBG] Done attempting to validate the bound parameter 'pageNumber' of type 'System.Int32'.
2025-05-04 20:26:37.606 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 20:26:37.607 +07:00 [DBG] Attempting to bind parameter 'pageSize' of type 'System.Int32' using the name 'pageSize' in request data ...
2025-05-04 20:26:37.611 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 20:26:37.613 +07:00 [DBG] Done attempting to bind parameter 'pageSize' of type 'System.Int32'.
2025-05-04 20:26:37.616 +07:00 [DBG] Attempting to validate the bound parameter 'pageSize' of type 'System.Int32' ...
2025-05-04 20:26:37.618 +07:00 [DBG] Done attempting to validate the bound parameter 'pageSize' of type 'System.Int32'.
2025-05-04 20:26:37.623 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 20:26:37.627 +07:00 [DBG] Creating DbConnection.
2025-05-04 20:26:37.628 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 20:26:37.631 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:37.634 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:37.637 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 20:26:37.639 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-04 20:26:37.641 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-05-04 20:26:37.645 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [users] AS [u]
2025-05-04 20:26:37.651 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [users] AS [u]
2025-05-04 20:26:37.655 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:37.657 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 2ms reading results.
2025-05-04 20:26:37.660 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:37.662 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 20:26:37.665 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:37.668 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:37.672 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 20:26:37.674 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-04 20:26:37.676 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-05-04 20:26:37.678 +07:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[userId], [u0].[CreatedAt], [u0].[email], [u0].[fullName], [u0].[IsEmailVerified], [u0].[password], [u0].[PasswordResetToken], [u0].[phone], [u0].[ResetTokenExpires], [u0].[roleId], [u0].[UpdatedAt], [r].[roleId], [r].[roleName], [u1].[userprofileId], [u1].[address], [u1].[birth], [u1].[userId]
FROM (
    SELECT [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
    FROM [users] AS [u]
    ORDER BY [u].[userId]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [roles] AS [r] ON [u0].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u1] ON [u0].[userId] = [u1].[userId]
ORDER BY [u0].[userId]
2025-05-04 20:26:37.685 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[userId], [u0].[CreatedAt], [u0].[email], [u0].[fullName], [u0].[IsEmailVerified], [u0].[password], [u0].[PasswordResetToken], [u0].[phone], [u0].[ResetTokenExpires], [u0].[roleId], [u0].[UpdatedAt], [r].[roleId], [r].[roleName], [u1].[userprofileId], [u1].[address], [u1].[birth], [u1].[userId]
FROM (
    SELECT [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
    FROM [users] AS [u]
    ORDER BY [u].[userId]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [roles] AS [r] ON [u0].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u1] ON [u0].[userId] = [u1].[userId]
ORDER BY [u0].[userId]
2025-05-04 20:26:37.691 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:26:37.693 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:26:37.695 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:26:37.697 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:26:37.700 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:26:37.701 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:26:37.702 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:26:37.705 +07:00 [DBG] The navigation 'User.Userprofile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:26:37.706 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Userprofile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:26:37.709 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:37.710 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 19ms reading results.
2025-05-04 20:26:37.712 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:37.713 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 20:26:37.715 +07:00 [INF] Admin fetched users page 1 with size 50
2025-05-04 20:26:37.716 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 20:26:37.718 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 20:26:37.719 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 20:26:37.720 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 20:26:37.721 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 20:26:37.723 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.PagedResponseDTO`1[[ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO, ExchangeDocument, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 20:26:37.724 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument) in 132.2055ms
2025-05-04 20:26:37.726 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetAll (ExchangeDocument)'
2025-05-04 20:26:37.727 +07:00 [INF] HTTP GET /api/Users responded 200 in 161.2072 ms
2025-05-04 20:26:37.729 +07:00 [DBG] Connection id "0HNCB1MASHLRS" completed keep alive response.
2025-05-04 20:26:37.730 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 20:26:37.731 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:37.732 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 20:26:37.734 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users?pageNumber=1&pageSize=50 - 200 null application/json; charset=utf-8 178.7324ms
2025-05-04 20:26:56.793 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/5 - null null
2025-05-04 20:26:56.799 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/5'
2025-05-04 20:26:56.802 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/5'
2025-05-04 20:26:56.805 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 20:26:56.808 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 20:26:56.811 +07:00 [DBG] Successfully validated the token.
2025-05-04 20:26:56.828 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 20:26:56.830 +07:00 [DBG] Authorization was successful.
2025-05-04 20:26:56.832 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 20:26:56.840 +07:00 [INF] Route matched with {action = "GetById", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 20:26:56.845 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 20:26:56.846 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 20:26:56.847 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 20:26:56.849 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 20:26:56.851 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 20:26:56.853 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:26:56.855 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:26:56.857 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 20:26:56.858 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 20:26:56.860 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 20:26:56.861 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 20:26:56.862 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 20:26:56.863 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 20:26:56.866 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 20:26:56.867 +07:00 [DBG] Creating DbConnection.
2025-05-04 20:26:56.868 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 20:26:56.869 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:56.872 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:56.873 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 20:26:56.874 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 20:26:56.875 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 20:26:56.876 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 20:26:56.881 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 20:26:56.883 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:56.884 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 1ms reading results.
2025-05-04 20:26:56.886 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:56.888 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 20:26:56.890 +07:00 [WRN] User not found for id 5
2025-05-04 20:26:56.890 +07:00 [WRN] GetById failed: User not found.
2025-05-04 20:26:56.891 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 20:26:56.893 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 20:26:56.894 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 20:26:56.894 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 20:26:56.895 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 20:26:56.896 +07:00 [INF] Executing NotFoundObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 20:26:56.897 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument) in 44.7744ms
2025-05-04 20:26:56.899 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 20:26:56.900 +07:00 [INF] HTTP GET /api/Users/5 responded 404 in 92.2397 ms
2025-05-04 20:26:56.901 +07:00 [DBG] Connection id "0HNCB1MASHLRS" completed keep alive response.
2025-05-04 20:26:56.903 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 20:26:56.905 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:26:56.906 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 20:26:56.908 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/5 - 404 null application/json; charset=utf-8 114.5393ms
2025-05-04 20:27:01.483 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/-9 - null null
2025-05-04 20:27:01.489 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/-9'
2025-05-04 20:27:01.490 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/-9'
2025-05-04 20:27:01.491 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 20:27:01.492 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 20:27:01.495 +07:00 [DBG] Successfully validated the token.
2025-05-04 20:27:01.498 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 20:27:01.500 +07:00 [DBG] Authorization was successful.
2025-05-04 20:27:01.501 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 20:27:01.502 +07:00 [INF] Route matched with {action = "GetById", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 20:27:01.506 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 20:27:01.507 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 20:27:01.509 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 20:27:01.511 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 20:27:01.512 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 20:27:01.513 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:27:01.514 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:27:01.516 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 20:27:01.518 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 20:27:01.520 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 20:27:01.522 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 20:27:01.523 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 20:27:01.524 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 20:27:01.525 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 20:27:01.527 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 20:27:01.528 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 20:27:01.528 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 20:27:01.529 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 20:27:01.530 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 20:27:01.531 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument) in 18.5544ms
2025-05-04 20:27:01.533 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 20:27:01.533 +07:00 [INF] HTTP GET /api/Users/-9 responded 400 in 41.4144 ms
2025-05-04 20:27:01.535 +07:00 [DBG] Connection id "0HNCB1MASHLRS" completed keep alive response.
2025-05-04 20:27:01.537 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/-9 - 400 null application/json; charset=utf-8 54.0121ms
2025-05-04 20:27:13.112 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/-9 - null null
2025-05-04 20:27:13.117 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/-9'
2025-05-04 20:27:13.118 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/-9'
2025-05-04 20:27:13.121 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 20:27:13.123 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 20:27:13.126 +07:00 [DBG] Successfully validated the token.
2025-05-04 20:27:13.129 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 20:27:13.130 +07:00 [DBG] Authorization was successful.
2025-05-04 20:27:13.131 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 20:27:13.133 +07:00 [INF] Route matched with {action = "GetById", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 20:27:13.136 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 20:27:13.139 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 20:27:13.140 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 20:27:13.142 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 20:27:13.144 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 20:27:13.145 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:27:13.147 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:27:13.148 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 20:27:13.150 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 20:27:13.152 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 20:27:13.155 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 20:27:13.157 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 20:27:13.158 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 20:27:13.160 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 20:27:13.164 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 20:27:13.164 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 20:27:13.166 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 20:27:13.167 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 20:27:13.169 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 20:27:13.171 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument) in 25.8642ms
2025-05-04 20:27:13.174 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 20:27:13.176 +07:00 [INF] HTTP GET /api/Users/-9 responded 400 in 53.2825 ms
2025-05-04 20:27:13.178 +07:00 [DBG] Connection id "0HNCB1MASHLRS" completed keep alive response.
2025-05-04 20:27:13.180 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/-9 - 400 null application/json; charset=utf-8 68.107ms
2025-05-04 20:27:39.639 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/1 - null null
2025-05-04 20:27:39.643 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1'
2025-05-04 20:27:39.645 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/1'
2025-05-04 20:27:39.648 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 20:27:39.651 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 20:27:39.652 +07:00 [DBG] Successfully validated the token.
2025-05-04 20:27:39.653 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 20:27:39.655 +07:00 [DBG] Authorization was successful.
2025-05-04 20:27:39.656 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 20:27:39.658 +07:00 [INF] Route matched with {action = "GetById", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 20:27:39.659 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 20:27:39.661 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 20:27:39.663 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 20:27:39.665 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 20:27:39.667 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 20:27:39.669 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:27:39.671 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:27:39.673 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 20:27:39.674 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 20:27:39.675 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 20:27:39.676 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 20:27:39.677 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 20:27:39.678 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 20:27:39.680 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 20:27:39.684 +07:00 [DBG] Creating DbConnection.
2025-05-04 20:27:39.685 +07:00 [DBG] Created DbConnection. (1ms).
2025-05-04 20:27:39.686 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:27:39.687 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:27:39.687 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 20:27:39.688 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 20:27:39.689 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 20:27:39.690 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 20:27:39.695 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 20:27:39.699 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:27:39.701 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:27:39.703 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:27:39.704 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:27:39.705 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 5ms reading results.
2025-05-04 20:27:39.706 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:27:39.707 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (0ms).
2025-05-04 20:27:39.708 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 20:27:39.710 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 20:27:39.710 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 20:27:39.711 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 20:27:39.711 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 20:27:39.712 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO'.
2025-05-04 20:27:39.714 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument) in 44.4414ms
2025-05-04 20:27:39.716 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 20:27:39.718 +07:00 [INF] HTTP GET /api/Users/1 responded 200 in 67.2197 ms
2025-05-04 20:27:39.719 +07:00 [DBG] Connection id "0HNCB1MASHLRS" completed keep alive response.
2025-05-04 20:27:39.720 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 20:27:39.721 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:27:39.722 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 20:27:39.723 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/1 - 200 null application/json; charset=utf-8 84.3153ms
2025-05-04 20:28:00.385 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/2 - null null
2025-05-04 20:28:00.390 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/2'
2025-05-04 20:28:00.394 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/2'
2025-05-04 20:28:00.395 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 20:28:00.397 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 20:28:00.398 +07:00 [DBG] Successfully validated the token.
2025-05-04 20:28:00.399 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 20:28:00.400 +07:00 [DBG] Authorization was successful.
2025-05-04 20:28:00.402 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 20:28:00.403 +07:00 [INF] Route matched with {action = "GetById", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 20:28:00.405 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 20:28:00.406 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 20:28:00.407 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 20:28:00.409 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 20:28:00.410 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 20:28:00.411 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:28:00.413 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:28:00.415 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 20:28:00.416 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 20:28:00.417 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 20:28:00.418 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 20:28:00.419 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 20:28:00.419 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 20:28:00.421 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 20:28:00.423 +07:00 [DBG] Creating DbConnection.
2025-05-04 20:28:00.423 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 20:28:00.424 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:28:00.425 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:28:00.426 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 20:28:00.427 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 20:28:00.428 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 20:28:00.430 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 20:28:00.436 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 20:28:00.438 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:28:00.439 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:28:00.440 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:28:00.441 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:28:00.442 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 3ms reading results.
2025-05-04 20:28:00.443 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:28:00.444 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 20:28:00.446 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 20:28:00.448 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 20:28:00.449 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 20:28:00.449 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 20:28:00.450 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 20:28:00.451 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO'.
2025-05-04 20:28:00.452 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument) in 40.9673ms
2025-05-04 20:28:00.453 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 20:28:00.454 +07:00 [INF] HTTP GET /api/Users/2 responded 200 in 57.2736 ms
2025-05-04 20:28:00.455 +07:00 [DBG] Connection id "0HNCB1MASHLRS" completed keep alive response.
2025-05-04 20:28:00.456 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 20:28:00.457 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:28:00.458 +07:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-05-04 20:28:00.459 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/2 - 200 null application/json; charset=utf-8 73.6525ms
2025-05-04 20:28:07.323 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/3 - null null
2025-05-04 20:28:07.331 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/3'
2025-05-04 20:28:07.336 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/3'
2025-05-04 20:28:07.338 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 20:28:07.339 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 20:28:07.340 +07:00 [DBG] Successfully validated the token.
2025-05-04 20:28:07.341 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 20:28:07.342 +07:00 [DBG] Authorization was successful.
2025-05-04 20:28:07.344 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 20:28:07.347 +07:00 [INF] Route matched with {action = "GetById", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 20:28:07.350 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 20:28:07.351 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 20:28:07.352 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 20:28:07.354 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 20:28:07.355 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 20:28:07.356 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:28:07.357 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:28:07.358 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 20:28:07.359 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 20:28:07.361 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 20:28:07.362 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 20:28:07.363 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 20:28:07.364 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 20:28:07.366 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 20:28:07.368 +07:00 [DBG] Creating DbConnection.
2025-05-04 20:28:07.368 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 20:28:07.369 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:28:07.370 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:28:07.371 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 20:28:07.372 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 20:28:07.372 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 20:28:07.373 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 20:28:07.376 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 20:28:07.380 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:28:07.382 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:28:07.383 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:28:07.384 +07:00 [DBG] The navigation 'User.Userprofile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:28:07.385 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Userprofile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:28:07.386 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:28:07.387 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 6ms reading results.
2025-05-04 20:28:07.388 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:28:07.389 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (0ms).
2025-05-04 20:28:07.390 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 20:28:07.392 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 20:28:07.392 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 20:28:07.393 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 20:28:07.394 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 20:28:07.397 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO'.
2025-05-04 20:28:07.398 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument) in 42.4445ms
2025-05-04 20:28:07.399 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 20:28:07.400 +07:00 [INF] HTTP GET /api/Users/3 responded 200 in 61.0697 ms
2025-05-04 20:28:07.401 +07:00 [DBG] Connection id "0HNCB1MASHLRS" completed keep alive response.
2025-05-04 20:28:07.402 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 20:28:07.403 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:28:07.404 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 20:28:07.405 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/3 - 200 null application/json; charset=utf-8 81.8486ms
2025-05-04 20:28:30.161 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/api/Users/2 - null null
2025-05-04 20:28:30.168 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/2'
2025-05-04 20:28:30.173 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/2'
2025-05-04 20:28:30.175 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 20:28:30.177 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 20:28:30.179 +07:00 [DBG] Successfully validated the token.
2025-05-04 20:28:30.181 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 20:28:30.184 +07:00 [DBG] Authorization was successful.
2025-05-04 20:28:30.184 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 20:28:30.185 +07:00 [INF] Route matched with {action = "GetById", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 20:28:30.187 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 20:28:30.188 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 20:28:30.189 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 20:28:30.190 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 20:28:30.191 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 20:28:30.194 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:28:30.195 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 20:28:30.196 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 20:28:30.197 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 20:28:30.198 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 20:28:30.199 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 20:28:30.199 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 20:28:30.200 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 20:28:30.202 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 20:28:30.203 +07:00 [DBG] Creating DbConnection.
2025-05-04 20:28:30.204 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 20:28:30.205 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:28:30.206 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:28:30.207 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 20:28:30.209 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-05-04 20:28:30.211 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-05-04 20:28:30.212 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 20:28:30.214 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[email], [u].[fullName], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[userId] = @__userId_0
2025-05-04 20:28:30.216 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:28:30.217 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:28:30.218 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 20:28:30.219 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:28:30.220 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 4ms reading results.
2025-05-04 20:28:30.221 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:28:30.222 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (0ms).
2025-05-04 20:28:30.224 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 20:28:30.227 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 20:28:30.228 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 20:28:30.228 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 20:28:30.229 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 20:28:30.230 +07:00 [INF] Executing OkObjectResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.UserProfileDTO'.
2025-05-04 20:28:30.231 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument) in 37.0182ms
2025-05-04 20:28:30.232 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.GetById (ExchangeDocument)'
2025-05-04 20:28:30.233 +07:00 [INF] HTTP GET /api/Users/2 responded 200 in 55.4531 ms
2025-05-04 20:28:30.234 +07:00 [DBG] Connection id "0HNCB1MASHLRS" completed keep alive response.
2025-05-04 20:28:30.235 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 20:28:30.235 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 20:28:30.237 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 20:28:30.238 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/api/Users/2 - 200 null application/json; charset=utf-8 76.7479ms
2025-05-04 20:30:41.667 +07:00 [DBG] Connection id "0HNCB1MASHLRS" disconnecting.
2025-05-04 20:30:41.673 +07:00 [DBG] Connection id "0HNCB1MASHLRS" stopped.
2025-05-04 20:30:41.677 +07:00 [DBG] Connection id "0HNCB1MASHLRS" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 20:37:39.077 +07:00 [INF] Application is shutting down...
2025-05-04 20:37:39.078 +07:00 [DBG] Hosting stopping
2025-05-04 20:37:39.089 +07:00 [DBG] Hosting stopped
2025-05-04 22:42:46.037 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-05-04 22:42:46.445 +07:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'Order'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 22:42:46.451 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'OrderDetail'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 22:42:46.453 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'Review'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 22:42:46.455 +07:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'Userprofile'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 22:42:46.563 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 22:42:47.161 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 22:43:32.276 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-05-04 22:43:32.752 +07:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'Order'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 22:43:32.756 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'OrderDetail'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 22:43:32.758 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'Review'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 22:43:32.760 +07:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'Userprofile'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 22:43:32.877 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 22:43:33.020 +07:00 [DBG] Creating DbConnection.
2025-05-04 22:43:33.062 +07:00 [DBG] Created DbConnection. (40ms).
2025-05-04 22:43:33.067 +07:00 [DBG] Migrating using database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:43:33.077 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:43:33.493 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:43:33.499 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-04 22:43:33.508 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (5ms).
2025-05-04 22:43:33.511 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (13ms).
2025-05-04 22:43:33.518 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-04 22:43:33.546 +07:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-04 22:43:33.550 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:43:33.563 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (6ms).
2025-05-04 22:43:33.565 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:43:33.568 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:43:33.570 +07:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-05-04 22:43:33.574 +07:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-05-04 22:43:33.576 +07:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-05-04 22:43:33.579 +07:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (5ms).
2025-05-04 22:43:33.580 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-05-04 22:43:33.607 +07:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-05-04 22:43:33.672 +07:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-05-04 22:43:33.677 +07:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-05-04 22:43:33.678 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-04 22:43:33.679 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-04 22:43:33.682 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (3ms).
2025-05-04 22:43:33.684 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-05-04 22:43:33.690 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-05-04 22:43:33.695 +07:00 [DBG] Committing transaction.
2025-05-04 22:43:33.698 +07:00 [DBG] Committed transaction.
2025-05-04 22:43:33.701 +07:00 [DBG] Disposing transaction.
2025-05-04 22:43:33.703 +07:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-05-04 22:43:33.705 +07:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-05-04 22:43:33.707 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-04 22:43:33.708 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-04 22:43:33.710 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (3ms).
2025-05-04 22:43:33.713 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-04 22:43:33.715 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-04 22:43:33.718 +07:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-05-04 22:43:33.719 +07:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-05-04 22:43:33.721 +07:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-05-04 22:43:33.722 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-04 22:43:33.727 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-04 22:43:33.730 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 22:43:33.731 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-04 22:43:33.732 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 22:43:33.735 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-04 22:43:33.750 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-04 22:43:33.755 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:43:33.758 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 3ms reading results.
2025-05-04 22:43:33.768 +07:00 [INF] Applying migration '20250504154247_SoftDeleteUser'.
2025-05-04 22:43:33.798 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-04 22:43:33.799 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-04 22:43:33.801 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-05-04 22:43:33.802 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [users] ADD [DeletedAt] datetime2 NULL;
2025-05-04 22:43:33.812 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [users] ADD [DeletedAt] datetime2 NULL;
2025-05-04 22:43:33.814 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-04 22:43:33.815 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-04 22:43:33.816 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-05-04 22:43:33.818 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [users] ADD [IsDeleted] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-04 22:43:33.830 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [users] ADD [IsDeleted] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-04 22:43:33.832 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-04 22:43:33.834 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-04 22:43:33.835 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-05-04 22:43:33.836 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250504154247_SoftDeleteUser', N'9.0.4');
2025-05-04 22:43:33.841 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250504154247_SoftDeleteUser', N'9.0.4');
2025-05-04 22:43:33.845 +07:00 [DBG] Committing transaction.
2025-05-04 22:43:33.846 +07:00 [DBG] Committed transaction.
2025-05-04 22:43:33.847 +07:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-05-04 22:43:33.848 +07:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-05-04 22:43:33.849 +07:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-05-04 22:43:33.851 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-05-04 22:43:33.860 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-05-04 22:43:33.862 +07:00 [DBG] Disposing transaction.
2025-05-04 22:43:33.863 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:43:33.865 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 22:43:33.869 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 22:43:33.872 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:43:33.878 +07:00 [DBG] Disposed connection to database '' on server '' (4ms).
2025-05-04 22:53:39.518 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-05-04 22:53:39.652 +07:00 [DBG] Hosting starting
2025-05-04 22:53:39.678 +07:00 [INF] User profile is available. Using 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-04 22:53:39.691 +07:00 [DBG] Reading data from file 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys\key-1a51a872-ea43-4350-815f-0422835a65dd.xml'.
2025-05-04 22:53:39.721 +07:00 [DBG] Found key {1a51a872-ea43-4350-815f-0422835a65dd}.
2025-05-04 22:53:39.734 +07:00 [DBG] Considering key {1a51a872-ea43-4350-815f-0422835a65dd} with expiration date 2025-07-05 19:31:04Z as default key.
2025-05-04 22:53:39.744 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 22:53:39.749 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-05-04 22:53:39.751 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 22:53:39.761 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-05-04 22:53:39.764 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-05-04 22:53:39.768 +07:00 [DBG] Using key {1a51a872-ea43-4350-815f-0422835a65dd} as the default key.
2025-05-04 22:53:39.773 +07:00 [DBG] Key ring with default key {1a51a872-ea43-4350-815f-0422835a65dd} was loaded during application startup.
2025-05-04 22:53:39.851 +07:00 [INF] Now listening on: http://localhost:5120
2025-05-04 22:53:39.852 +07:00 [DBG] Loaded hosting startup assembly ExchangeDocument
2025-05-04 22:53:39.853 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-04 22:53:39.854 +07:00 [INF] Hosting environment: Development
2025-05-04 22:53:39.856 +07:00 [INF] Content root path: D:\Gộp module Auth\ExchangeDocument(Tự làm Auth_User) - Đã xong 11 API của Module Auth_User\ExchangeDocument
2025-05-04 22:53:39.857 +07:00 [DBG] Hosting started
2025-05-04 22:54:10.933 +07:00 [DBG] Connection id "0HNCB4FKJF3F1" accepted.
2025-05-04 22:54:10.936 +07:00 [DBG] Connection id "0HNCB4FKJF3F1" started.
2025-05-04 22:54:10.937 +07:00 [DBG] Connection id "0HNCB4FKJF3F2" accepted.
2025-05-04 22:54:10.944 +07:00 [DBG] Connection id "0HNCB4FKJF3F2" started.
2025-05-04 22:54:11.984 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - null null
2025-05-04 22:54:11.992 +07:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-05-04 22:54:12.019 +07:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-05-04 22:54:12.022 +07:00 [DBG] Request did not match any endpoints
2025-05-04 22:54:12.266 +07:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 240.4326 ms
2025-05-04 22:54:12.269 +07:00 [DBG] Connection id "0HNCB4FKJF3F1" completed keep alive response.
2025-05-04 22:54:12.271 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 290.1391ms
2025-05-04 22:54:19.872 +07:00 [DBG] Connection id "0HNCB4FKJF3F2" received FIN.
2025-05-04 22:54:19.872 +07:00 [DBG] Connection id "0HNCB4FKJF3F1" received FIN.
2025-05-04 22:54:19.880 +07:00 [DBG] Connection id "0HNCB4FKJF3F2" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 22:54:19.880 +07:00 [DBG] Connection id "0HNCB4FKJF3F1" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 22:54:19.886 +07:00 [DBG] Connection id "0HNCB4FKJF3F2" disconnecting.
2025-05-04 22:54:19.887 +07:00 [DBG] Connection id "0HNCB4FKJF3F1" disconnecting.
2025-05-04 22:54:19.890 +07:00 [DBG] Connection id "0HNCB4FKJF3F2" stopped.
2025-05-04 22:54:19.890 +07:00 [DBG] Connection id "0HNCB4FKJF3F1" stopped.
2025-05-04 22:54:22.822 +07:00 [DBG] Connection id "0HNCB4FKJF3F3" accepted.
2025-05-04 22:54:22.825 +07:00 [DBG] Connection id "0HNCB4FKJF3F3" started.
2025-05-04 22:54:22.839 +07:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5120/api/Users/1 - null null
2025-05-04 22:54:22.875 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1'
2025-05-04 22:54:22.882 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/1'
2025-05-04 22:54:22.887 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 22:54:22.894 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 22:54:22.896 +07:00 [WRN] Failed to determine the https port for redirect.
2025-05-04 22:54:22.934 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 22:54:22.939 +07:00 [DBG] Policy authentication schemes  did not succeed
2025-05-04 22:54:22.942 +07:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-05-04 22:54:22.946 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-04 22:54:22.948 +07:00 [INF] HTTP DELETE /api/Users/1 responded 401 in 56.0132 ms
2025-05-04 22:54:22.952 +07:00 [DBG] Connection id "0HNCB4FKJF3F3" completed keep alive response.
2025-05-04 22:54:22.955 +07:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5120/api/Users/1 - 401 0 null 116.1511ms
2025-05-04 22:54:29.875 +07:00 [DBG] Connection id "0HNCB4FKJF3F3" received FIN.
2025-05-04 22:54:29.877 +07:00 [DBG] Connection id "0HNCB4FKJF3F3" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 22:54:29.879 +07:00 [DBG] Connection id "0HNCB4FKJF3F3" disconnecting.
2025-05-04 22:54:29.881 +07:00 [DBG] Connection id "0HNCB4FKJF3F3" stopped.
2025-05-04 22:54:33.281 +07:00 [DBG] Connection id "0HNCB4FKJF3F4" accepted.
2025-05-04 22:54:33.282 +07:00 [DBG] Connection id "0HNCB4FKJF3F4" started.
2025-05-04 22:54:33.286 +07:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5120/api/Users/-9 - null null
2025-05-04 22:54:33.291 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/-9'
2025-05-04 22:54:33.294 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/-9'
2025-05-04 22:54:33.298 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 22:54:33.302 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 22:54:33.307 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 22:54:33.311 +07:00 [DBG] Policy authentication schemes  did not succeed
2025-05-04 22:54:33.312 +07:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-05-04 22:54:33.313 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-04 22:54:33.314 +07:00 [INF] HTTP DELETE /api/Users/-9 responded 401 in 13.3087 ms
2025-05-04 22:54:33.316 +07:00 [DBG] Connection id "0HNCB4FKJF3F4" completed keep alive response.
2025-05-04 22:54:33.318 +07:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5120/api/Users/-9 - 401 0 null 32.7404ms
2025-05-04 22:54:33.611 +07:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5120/api/Users/-9 - null null
2025-05-04 22:54:33.616 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/-9'
2025-05-04 22:54:33.619 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/-9'
2025-05-04 22:54:33.621 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 22:54:33.623 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 22:54:33.624 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 22:54:33.625 +07:00 [DBG] Policy authentication schemes  did not succeed
2025-05-04 22:54:33.626 +07:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-05-04 22:54:33.628 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-04 22:54:33.629 +07:00 [INF] HTTP DELETE /api/Users/-9 responded 401 in 6.0588 ms
2025-05-04 22:54:33.631 +07:00 [DBG] Connection id "0HNCB4FKJF3F4" completed keep alive response.
2025-05-04 22:54:33.634 +07:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5120/api/Users/-9 - 401 0 null 21.9841ms
2025-05-04 22:54:39.887 +07:00 [DBG] Connection id "0HNCB4FKJF3F4" received FIN.
2025-05-04 22:54:39.890 +07:00 [DBG] Connection id "0HNCB4FKJF3F4" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 22:54:39.893 +07:00 [DBG] Connection id "0HNCB4FKJF3F4" disconnecting.
2025-05-04 22:54:39.897 +07:00 [DBG] Connection id "0HNCB4FKJF3F4" stopped.
2025-05-04 22:56:39.132 +07:00 [DBG] Connection id "0HNCB4FKJF3F5" accepted.
2025-05-04 22:56:39.136 +07:00 [DBG] Connection id "0HNCB4FKJF3F5" started.
2025-05-04 22:56:39.139 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 64
2025-05-04 22:56:39.144 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 22:56:39.146 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 22:56:39.148 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 22:56:39.149 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 22:56:39.150 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 22:56:39.156 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 22:56:39.189 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 22:56:39.197 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 22:56:39.201 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 22:56:39.206 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 22:56:39.208 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 22:56:39.209 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 22:56:39.211 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 22:56:39.312 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-05-04 22:56:39.335 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 22:56:39.340 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 22:56:39.342 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 22:56:39.344 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 22:56:39.367 +07:00 [DBG] Connection id "0HNCB4FKJF3F5", Request id "0HNCB4FKJF3F5:00000001": started reading request body.
2025-05-04 22:56:39.368 +07:00 [DBG] Connection id "0HNCB4FKJF3F5", Request id "0HNCB4FKJF3F5:00000001": done reading request body.
2025-05-04 22:56:39.379 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 22:56:39.380 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 22:56:39.382 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 22:56:39.384 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 22:56:39.392 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 22:56:39.800 +07:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'Order'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 22:56:39.804 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'OrderDetail'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 22:56:39.805 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'Review'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 22:56:39.806 +07:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'Userprofile'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 22:56:39.950 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 22:56:40.032 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .FirstOrDefault(u => u.Email == __email_0)'
2025-05-04 22:56:40.102 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-04 22:56:40.291 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.DeletedAt (DateTime?), 2], [Property: User.Email (string) Required Index MaxLength(255), 3], [Property: User.FullName (string) Required MaxLength(255), 4], [Property: User.IsDeleted (bool) Required, 5], [Property: User.IsEmailVerified (bool) Required, 6], [Property: User.Password (string) Required MaxLength(255), 7], [Property: User.PasswordResetToken (string), 8], [Property: User.Phone (string) MaxLength(20), 9], [Property: User.ResetTokenExpires (DateTime?), 10], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 11], [Property: User.UpdatedAt (DateTime?), 12] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Role.RoleName (string) Required Index MaxLength(50), 14] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.DeletedAt, u.email, u.fullName, u.IsDeleted, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE Not(u.IsDeleted) && (u.email == @__email_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.DeletedAt (DateTime?), 2], [Property: User.Email (string) Required Index MaxLength(255), 3], [Property: User.FullName (string) Required MaxLength(255), 4], [Property: User.IsDeleted (bool) Required, 5], [Property: User.IsEmailVerified (bool) Required, 6], [Property: User.Password (string) Required MaxLength(255), 7], [Property: User.PasswordResetToken (string), 8], [Property: User.Phone (string) MaxLength(20), 9], [Property: User.ResetTokenExpires (DateTime?), 10], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 11], [Property: User.UpdatedAt (DateTime?), 12] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Role.RoleName (string) Required Index MaxLength(50), 14] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.DeletedAt, u.email, u.fullName, u.IsDeleted, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE Not(u.IsDeleted) && (u.email == @__email_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            Role entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<DeletedAt>k__BackingField = dataReader.IsDBNull(2) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(2);
                                    instance.<Email>k__BackingField = dataReader.GetString(3);
                                    instance.<FullName>k__BackingField = dataReader.GetString(4);
                                    instance.<IsDeleted>k__BackingField = dataReader.GetBoolean(5);
                                    instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(6);
                                    instance.<Password>k__BackingField = dataReader.GetString(7);
                                    instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                    instance.<Phone>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                    instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(12) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(12);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                Role instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(Role);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(13) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (Role)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                            {
                                return 
                                {
                                    Role instance;
                                    instance = new Role();
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(13);
                                    instance.<RoleName>k__BackingField = dataReader.GetString(14);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Role)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
                fixup: (namelessParameter{8}, namelessParameter{9}) => 
                {
                    namelessParameter{8}.<Role>k__BackingField = namelessParameter{9};
                    return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                        entity: namelessParameter{9}, 
                        value: namelessParameter{8}, 
                        forMaterialization: True);
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-04 22:56:40.369 +07:00 [DBG] Creating DbConnection.
2025-05-04 22:56:40.391 +07:00 [DBG] Created DbConnection. (23ms).
2025-05-04 22:56:40.399 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:56:40.576 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:56:40.582 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 22:56:40.590 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2025-05-04 22:56:40.596 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (14ms).
2025-05-04 22:56:40.606 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-04 22:56:40.662 +07:00 [INF] Executed DbCommand (60ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-04 22:56:40.693 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 22:56:40.732 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 22:56:40.738 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 22:56:40.746 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:56:40.754 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 84ms reading results.
2025-05-04 22:56:40.758 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:56:40.763 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (4ms).
2025-05-04 22:56:41.018 +07:00 [WRN] Login failed: invalid password for nguyetnkhuyen@gmail.com
2025-05-04 22:56:41.023 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 22:56:41.025 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 22:56:41.026 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 22:56:41.027 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 22:56:41.028 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 22:56:41.031 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType4`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 22:56:41.054 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 1841.9395ms
2025-05-04 22:56:41.057 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 22:56:41.059 +07:00 [INF] HTTP POST /api/Auth/login responded 400 in 1910.3871 ms
2025-05-04 22:56:41.061 +07:00 [DBG] Connection id "0HNCB4FKJF3F5" completed keep alive response.
2025-05-04 22:56:41.065 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 22:56:41.069 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:56:41.072 +07:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-05-04 22:56:41.074 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 400 null application/json; charset=utf-8 1935.3813ms
2025-05-04 22:56:45.082 +07:00 [DBG] Connection id "0HNCB4FKJF3F5" received FIN.
2025-05-04 22:56:45.084 +07:00 [DBG] Connection id "0HNCB4FKJF3F5" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 22:56:45.090 +07:00 [DBG] Connection id "0HNCB4FKJF3F5" disconnecting.
2025-05-04 22:56:45.096 +07:00 [DBG] Connection id "0HNCB4FKJF3F5" stopped.
2025-05-04 22:57:07.723 +07:00 [DBG] Connection id "0HNCB4FKJF3F6" accepted.
2025-05-04 22:57:07.726 +07:00 [DBG] Connection id "0HNCB4FKJF3F6" started.
2025-05-04 22:57:07.728 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 72
2025-05-04 22:57:07.733 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 22:57:07.737 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 22:57:07.739 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 22:57:07.743 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 22:57:07.748 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 22:57:07.749 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 22:57:07.752 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 22:57:07.757 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 22:57:07.762 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 22:57:07.765 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 22:57:07.771 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 22:57:07.776 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 22:57:07.778 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 22:57:07.782 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 22:57:07.786 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 22:57:07.788 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 22:57:07.789 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 22:57:07.791 +07:00 [DBG] Connection id "0HNCB4FKJF3F6", Request id "0HNCB4FKJF3F6:00000001": started reading request body.
2025-05-04 22:57:07.792 +07:00 [DBG] Connection id "0HNCB4FKJF3F6", Request id "0HNCB4FKJF3F6:00000001": done reading request body.
2025-05-04 22:57:07.794 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 22:57:07.796 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 22:57:07.797 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 22:57:07.798 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 22:57:07.800 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 22:57:07.813 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 22:57:07.820 +07:00 [DBG] Creating DbConnection.
2025-05-04 22:57:07.821 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 22:57:07.823 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:57:07.824 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:57:07.825 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 22:57:07.826 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 22:57:07.827 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 22:57:07.829 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-04 22:57:07.838 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-04 22:57:07.841 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 22:57:07.842 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 22:57:07.843 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 22:57:07.846 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:57:07.847 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 6ms reading results.
2025-05-04 22:57:07.849 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:57:07.850 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 22:57:08.066 +07:00 [INF] User nguyetnkhuyen@gmail.com logged in successfully
2025-05-04 22:57:08.070 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 22:57:08.072 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 22:57:08.073 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 22:57:08.074 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 22:57:08.075 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 22:57:08.077 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType6`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 22:57:08.083 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 304.7531ms
2025-05-04 22:57:08.084 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 22:57:08.086 +07:00 [INF] HTTP POST /api/Auth/login responded 200 in 342.8886 ms
2025-05-04 22:57:08.087 +07:00 [DBG] Connection id "0HNCB4FKJF3F6" completed keep alive response.
2025-05-04 22:57:08.089 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 22:57:08.089 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:57:08.090 +07:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-05-04 22:57:08.092 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 200 null application/json; charset=utf-8 364.1115ms
2025-05-04 22:57:42.249 +07:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5120/api/Users/-9 - null null
2025-05-04 22:57:42.254 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/-9'
2025-05-04 22:57:42.256 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/-9'
2025-05-04 22:57:42.261 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 22:57:42.264 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 22:57:42.303 +07:00 [DBG] Successfully validated the token.
2025-05-04 22:57:42.314 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 22:57:42.321 +07:00 [DBG] Authorization was successful.
2025-05-04 22:57:42.323 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 22:57:42.331 +07:00 [INF] Route matched with {action = "Delete", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Delete(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 22:57:42.334 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 22:57:42.335 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 22:57:42.336 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 22:57:42.338 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 22:57:42.340 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 22:57:42.343 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 22:57:42.346 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 22:57:42.347 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 22:57:42.348 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 22:57:42.350 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 22:57:42.351 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 22:57:42.351 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 22:57:42.352 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 22:57:42.354 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 22:57:42.356 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 22:57:42.357 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 22:57:42.358 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 22:57:42.359 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 22:57:42.361 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 22:57:42.363 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument) in 20.4162ms
2025-05-04 22:57:42.364 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 22:57:42.366 +07:00 [INF] HTTP DELETE /api/Users/-9 responded 400 in 101.6074 ms
2025-05-04 22:57:42.367 +07:00 [DBG] Connection id "0HNCB4FKJF3F6" completed keep alive response.
2025-05-04 22:57:42.367 +07:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5120/api/Users/-9 - 400 null application/json; charset=utf-8 118.0733ms
2025-05-04 22:57:50.513 +07:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5120/api/Users/1 - null null
2025-05-04 22:57:50.521 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1'
2025-05-04 22:57:50.524 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/1'
2025-05-04 22:57:50.527 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 22:57:50.530 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 22:57:50.533 +07:00 [DBG] Successfully validated the token.
2025-05-04 22:57:50.534 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 22:57:50.536 +07:00 [DBG] Authorization was successful.
2025-05-04 22:57:50.537 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 22:57:50.538 +07:00 [INF] Route matched with {action = "Delete", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Delete(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 22:57:50.541 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 22:57:50.543 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 22:57:50.544 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 22:57:50.546 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 22:57:50.547 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 22:57:50.549 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 22:57:50.551 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 22:57:50.552 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 22:57:50.553 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 22:57:50.554 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 22:57:50.555 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 22:57:50.557 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 22:57:50.558 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 22:57:50.603 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 22:57:50.620 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "UserId") == __p_0)'
2025-05-04 22:57:50.628 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.DeletedAt (DateTime?), 2], [Property: User.Email (string) Required Index MaxLength(255), 3], [Property: User.FullName (string) Required MaxLength(255), 4], [Property: User.IsDeleted (bool) Required, 5], [Property: User.IsEmailVerified (bool) Required, 6], [Property: User.Password (string) Required MaxLength(255), 7], [Property: User.PasswordResetToken (string), 8], [Property: User.Phone (string) MaxLength(20), 9], [Property: User.ResetTokenExpires (DateTime?), 10], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 11], [Property: User.UpdatedAt (DateTime?), 12] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.DeletedAt, u.email, u.fullName, u.IsDeleted, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt
            FROM users AS u
            WHERE Not(u.IsDeleted) && (u.userId == @__p_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.DeletedAt (DateTime?), 2], [Property: User.Email (string) Required Index MaxLength(255), 3], [Property: User.FullName (string) Required MaxLength(255), 4], [Property: User.IsDeleted (bool) Required, 5], [Property: User.IsEmailVerified (bool) Required, 6], [Property: User.Password (string) Required MaxLength(255), 7], [Property: User.PasswordResetToken (string), 8], [Property: User.Phone (string) MaxLength(20), 9], [Property: User.ResetTokenExpires (DateTime?), 10], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 11], [Property: User.UpdatedAt (DateTime?), 12] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.DeletedAt, u.email, u.fullName, u.IsDeleted, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt
            FROM users AS u
            WHERE Not(u.IsDeleted) && (u.userId == @__p_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<DeletedAt>k__BackingField = dataReader.IsDBNull(2) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(2);
                                    instance.<Email>k__BackingField = dataReader.GetString(3);
                                    instance.<FullName>k__BackingField = dataReader.GetString(4);
                                    instance.<IsDeleted>k__BackingField = dataReader.GetBoolean(5);
                                    instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(6);
                                    instance.<Password>k__BackingField = dataReader.GetString(7);
                                    instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                    instance.<Phone>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                    instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(12) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(12);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-04 22:57:50.644 +07:00 [DBG] Creating DbConnection.
2025-05-04 22:57:50.646 +07:00 [DBG] Created DbConnection. (2ms).
2025-05-04 22:57:50.647 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:57:50.649 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:57:50.649 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 22:57:50.650 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 22:57:50.651 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 22:57:50.653 +07:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
FROM [users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[userId] = @__p_0
2025-05-04 22:57:50.659 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
FROM [users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[userId] = @__p_0
2025-05-04 22:57:50.662 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 22:57:50.663 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:57:50.664 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 2ms reading results.
2025-05-04 22:57:50.665 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:57:50.666 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 22:57:50.669 +07:00 [DBG] SaveChanges starting for 'ExchangeDocumentContext'.
2025-05-04 22:57:50.671 +07:00 [DBG] DetectChanges starting for 'ExchangeDocumentContext'.
2025-05-04 22:57:50.681 +07:00 [DBG] The unchanged property 'User.DeletedAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-04 22:57:50.686 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 22:57:50.692 +07:00 [DBG] The unchanged property 'User.IsDeleted' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-04 22:57:50.700 +07:00 [DBG] DetectChanges completed for 'ExchangeDocumentContext'.
2025-05-04 22:57:50.737 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:57:50.741 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:57:50.748 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 22:57:50.753 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2025-05-04 22:57:50.756 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (8ms).
2025-05-04 22:57:50.761 +07:00 [DBG] Executing DbCommand [Parameters=[@p2='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [users] SET [DeletedAt] = @p0, [IsDeleted] = @p1
OUTPUT 1
WHERE [userId] = @p2;
2025-05-04 22:57:50.770 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [users] SET [DeletedAt] = @p0, [IsDeleted] = @p1
OUTPUT 1
WHERE [userId] = @p2;
2025-05-04 22:57:50.778 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:57:50.781 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 6ms reading results.
2025-05-04 22:57:50.783 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:57:50.785 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 22:57:50.790 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 22:57:50.796 +07:00 [DBG] SaveChanges completed for 'ExchangeDocumentContext' with 1 entities written to the database.
2025-05-04 22:57:50.798 +07:00 [INF] User 1 soft-deleted by Admin 3
2025-05-04 22:57:50.799 +07:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-05-04 22:57:50.800 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument) in 250.5111ms
2025-05-04 22:57:50.801 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 22:57:50.802 +07:00 [INF] HTTP DELETE /api/Users/1 responded 204 in 272.5065 ms
2025-05-04 22:57:50.804 +07:00 [DBG] Connection id "0HNCB4FKJF3F6" completed keep alive response.
2025-05-04 22:57:50.806 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 22:57:50.807 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 22:57:50.811 +07:00 [DBG] Disposed connection to database '' on server '' (3ms).
2025-05-04 22:57:50.812 +07:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5120/api/Users/1 - 204 null null 298.8083ms
2025-05-04 23:00:01.072 +07:00 [DBG] Connection id "0HNCB4FKJF3F6" disconnecting.
2025-05-04 23:00:01.077 +07:00 [DBG] Connection id "0HNCB4FKJF3F6" stopped.
2025-05-04 23:00:01.082 +07:00 [DBG] Connection id "0HNCB4FKJF3F6" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 23:07:35.429 +07:00 [INF] Application is shutting down...
2025-05-04 23:07:35.430 +07:00 [DBG] Hosting stopping
2025-05-04 23:07:35.440 +07:00 [DBG] Hosting stopped
2025-05-04 23:07:40.312 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-05-04 23:07:40.402 +07:00 [DBG] Hosting starting
2025-05-04 23:07:40.416 +07:00 [INF] User profile is available. Using 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-04 23:07:40.426 +07:00 [DBG] Reading data from file 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys\key-1a51a872-ea43-4350-815f-0422835a65dd.xml'.
2025-05-04 23:07:40.437 +07:00 [DBG] Found key {1a51a872-ea43-4350-815f-0422835a65dd}.
2025-05-04 23:07:40.450 +07:00 [DBG] Considering key {1a51a872-ea43-4350-815f-0422835a65dd} with expiration date 2025-07-05 19:31:04Z as default key.
2025-05-04 23:07:40.456 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 23:07:40.461 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-05-04 23:07:40.465 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-04 23:07:40.472 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-05-04 23:07:40.475 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-05-04 23:07:40.477 +07:00 [DBG] Using key {1a51a872-ea43-4350-815f-0422835a65dd} as the default key.
2025-05-04 23:07:40.478 +07:00 [DBG] Key ring with default key {1a51a872-ea43-4350-815f-0422835a65dd} was loaded during application startup.
2025-05-04 23:07:40.521 +07:00 [INF] Now listening on: http://localhost:5120
2025-05-04 23:07:40.523 +07:00 [DBG] Loaded hosting startup assembly ExchangeDocument
2025-05-04 23:07:40.527 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-04 23:07:40.530 +07:00 [INF] Hosting environment: Development
2025-05-04 23:07:40.532 +07:00 [INF] Content root path: D:\Gộp module Auth\ExchangeDocument(Tự làm Auth_User) - Đã xong 11 API của Module Auth_User\ExchangeDocument
2025-05-04 23:07:40.535 +07:00 [DBG] Hosting started
2025-05-04 23:07:49.969 +07:00 [DBG] Connection id "0HNCB4N8MD7F1" accepted.
2025-05-04 23:07:49.974 +07:00 [DBG] Connection id "0HNCB4N8MD7F1" started.
2025-05-04 23:07:49.975 +07:00 [DBG] Connection id "0HNCB4N8MD7F2" accepted.
2025-05-04 23:07:49.983 +07:00 [DBG] Connection id "0HNCB4N8MD7F2" started.
2025-05-04 23:07:50.006 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/index.html - null null
2025-05-04 23:07:50.016 +07:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-05-04 23:07:50.032 +07:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-05-04 23:07:50.036 +07:00 [DBG] Request did not match any endpoints
2025-05-04 23:07:50.119 +07:00 [INF] HTTP GET /swagger/index.html responded 200 in 76.1568 ms
2025-05-04 23:07:50.128 +07:00 [DBG] Connection id "0HNCB4N8MD7F1" completed keep alive response.
2025-05-04 23:07:50.135 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/index.html - 200 null text/html;charset=utf-8 129.1894ms
2025-05-04 23:07:50.675 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - null null
2025-05-04 23:07:50.685 +07:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-05-04 23:07:50.687 +07:00 [DBG] Request did not match any endpoints
2025-05-04 23:07:50.860 +07:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 171.1130 ms
2025-05-04 23:07:50.862 +07:00 [DBG] Connection id "0HNCB4N8MD7F1" completed keep alive response.
2025-05-04 23:07:50.863 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 188.352ms
2025-05-04 23:08:56.324 +07:00 [DBG] Connection id "0HNCB4N8MD7F2" received FIN.
2025-05-04 23:08:56.324 +07:00 [DBG] Connection id "0HNCB4N8MD7F1" received FIN.
2025-05-04 23:08:56.328 +07:00 [DBG] Connection id "0HNCB4N8MD7F2" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 23:08:56.328 +07:00 [DBG] Connection id "0HNCB4N8MD7F1" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 23:08:56.331 +07:00 [DBG] Connection id "0HNCB4N8MD7F2" disconnecting.
2025-05-04 23:08:56.332 +07:00 [DBG] Connection id "0HNCB4N8MD7F1" disconnecting.
2025-05-04 23:08:56.334 +07:00 [DBG] Connection id "0HNCB4N8MD7F2" stopped.
2025-05-04 23:08:56.334 +07:00 [DBG] Connection id "0HNCB4N8MD7F1" stopped.
2025-05-04 23:09:29.522 +07:00 [DBG] Connection id "0HNCB4N8MD7F3" accepted.
2025-05-04 23:09:29.524 +07:00 [DBG] Connection id "0HNCB4N8MD7F3" started.
2025-05-04 23:09:29.526 +07:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5120/api/Users/-0 - null null
2025-05-04 23:09:29.536 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/-0'
2025-05-04 23:09:29.544 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/-0'
2025-05-04 23:09:29.547 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 23:09:29.551 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 23:09:29.554 +07:00 [WRN] Failed to determine the https port for redirect.
2025-05-04 23:09:29.580 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 23:09:29.587 +07:00 [DBG] Policy authentication schemes  did not succeed
2025-05-04 23:09:29.594 +07:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-05-04 23:09:29.602 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-04 23:09:29.608 +07:00 [INF] HTTP DELETE /api/Users/-0 responded 401 in 58.4048 ms
2025-05-04 23:09:29.613 +07:00 [DBG] Connection id "0HNCB4N8MD7F3" completed keep alive response.
2025-05-04 23:09:29.614 +07:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5120/api/Users/-0 - 401 0 null 87.4721ms
2025-05-04 23:09:31.390 +07:00 [DBG] Connection id "0HNCB4N8MD7F3" received FIN.
2025-05-04 23:09:31.393 +07:00 [DBG] Connection id "0HNCB4N8MD7F3" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 23:09:31.399 +07:00 [DBG] Connection id "0HNCB4N8MD7F3" disconnecting.
2025-05-04 23:09:31.404 +07:00 [DBG] Connection id "0HNCB4N8MD7F3" stopped.
2025-05-04 23:09:57.818 +07:00 [DBG] Connection id "0HNCB4N8MD7F4" accepted.
2025-05-04 23:09:57.822 +07:00 [DBG] Connection id "0HNCB4N8MD7F4" started.
2025-05-04 23:09:57.825 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 63
2025-05-04 23:09:57.832 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 23:09:57.837 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 23:09:57.842 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 23:09:57.846 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 23:09:57.852 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 23:09:57.857 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 23:09:57.877 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 23:09:57.887 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 23:09:57.892 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 23:09:57.893 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 23:09:57.895 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 23:09:57.896 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 23:09:57.900 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 23:09:57.959 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-05-04 23:09:57.979 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 23:09:57.986 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 23:09:57.991 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 23:09:57.993 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 23:09:58.007 +07:00 [DBG] Connection id "0HNCB4N8MD7F4", Request id "0HNCB4N8MD7F4:00000001": started reading request body.
2025-05-04 23:09:58.010 +07:00 [DBG] Connection id "0HNCB4N8MD7F4", Request id "0HNCB4N8MD7F4:00000001": done reading request body.
2025-05-04 23:09:58.022 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 23:09:58.025 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 23:09:58.026 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 23:09:58.028 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 23:09:58.035 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 23:09:58.372 +07:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'Order'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 23:09:58.376 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'OrderDetail'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 23:09:58.377 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'Review'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 23:09:58.380 +07:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'Userprofile'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-04 23:09:58.488 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 23:09:58.539 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .FirstOrDefault(u => u.Email == __email_0)'
2025-05-04 23:09:58.587 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-04 23:09:58.770 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.DeletedAt (DateTime?), 2], [Property: User.Email (string) Required Index MaxLength(255), 3], [Property: User.FullName (string) Required MaxLength(255), 4], [Property: User.IsDeleted (bool) Required, 5], [Property: User.IsEmailVerified (bool) Required, 6], [Property: User.Password (string) Required MaxLength(255), 7], [Property: User.PasswordResetToken (string), 8], [Property: User.Phone (string) MaxLength(20), 9], [Property: User.ResetTokenExpires (DateTime?), 10], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 11], [Property: User.UpdatedAt (DateTime?), 12] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Role.RoleName (string) Required Index MaxLength(50), 14] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.DeletedAt, u.email, u.fullName, u.IsDeleted, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE Not(u.IsDeleted) && (u.email == @__email_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.DeletedAt (DateTime?), 2], [Property: User.Email (string) Required Index MaxLength(255), 3], [Property: User.FullName (string) Required MaxLength(255), 4], [Property: User.IsDeleted (bool) Required, 5], [Property: User.IsEmailVerified (bool) Required, 6], [Property: User.Password (string) Required MaxLength(255), 7], [Property: User.PasswordResetToken (string), 8], [Property: User.Phone (string) MaxLength(20), 9], [Property: User.ResetTokenExpires (DateTime?), 10], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 11], [Property: User.UpdatedAt (DateTime?), 12] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Role.RoleName (string) Required Index MaxLength(50), 14] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.DeletedAt, u.email, u.fullName, u.IsDeleted, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE Not(u.IsDeleted) && (u.email == @__email_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            Role entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<DeletedAt>k__BackingField = dataReader.IsDBNull(2) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(2);
                                    instance.<Email>k__BackingField = dataReader.GetString(3);
                                    instance.<FullName>k__BackingField = dataReader.GetString(4);
                                    instance.<IsDeleted>k__BackingField = dataReader.GetBoolean(5);
                                    instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(6);
                                    instance.<Password>k__BackingField = dataReader.GetString(7);
                                    instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                    instance.<Phone>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                    instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(12) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(12);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                Role instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(Role);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(13) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (Role)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                            {
                                return 
                                {
                                    Role instance;
                                    instance = new Role();
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(13);
                                    instance.<RoleName>k__BackingField = dataReader.GetString(14);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Role)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
                fixup: (namelessParameter{8}, namelessParameter{9}) => 
                {
                    namelessParameter{8}.<Role>k__BackingField = namelessParameter{9};
                    return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                        entity: namelessParameter{9}, 
                        value: namelessParameter{8}, 
                        forMaterialization: True);
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-04 23:09:58.829 +07:00 [DBG] Creating DbConnection.
2025-05-04 23:09:58.844 +07:00 [DBG] Created DbConnection. (14ms).
2025-05-04 23:09:58.850 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:09:58.955 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:09:58.960 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 23:09:58.967 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2025-05-04 23:09:58.973 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (13ms).
2025-05-04 23:09:58.980 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-04 23:09:59.020 +07:00 [INF] Executed DbCommand (42ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-04 23:09:59.036 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:09:59.045 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 14ms reading results.
2025-05-04 23:09:59.050 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:09:59.056 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (6ms).
2025-05-04 23:09:59.058 +07:00 [WRN] Login failed: user haminhkhoa17@gmail.com not found
2025-05-04 23:09:59.061 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 23:09:59.065 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 23:09:59.066 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 23:09:59.067 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 23:09:59.068 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 23:09:59.070 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType4`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 23:09:59.084 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 1183.4282ms
2025-05-04 23:09:59.086 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 23:09:59.088 +07:00 [INF] HTTP POST /api/Auth/login responded 400 in 1242.0689 ms
2025-05-04 23:09:59.089 +07:00 [DBG] Connection id "0HNCB4N8MD7F4" completed keep alive response.
2025-05-04 23:09:59.091 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 23:09:59.095 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:09:59.098 +07:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-05-04 23:09:59.100 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 400 null application/json; charset=utf-8 1275.4609ms
2025-05-04 23:10:22.713 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 71
2025-05-04 23:10:22.719 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 23:10:22.723 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 23:10:22.725 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 23:10:22.726 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 23:10:22.728 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 23:10:22.730 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 23:10:22.732 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 23:10:22.739 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 23:10:22.743 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 23:10:22.745 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 23:10:22.748 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 23:10:22.754 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 23:10:22.758 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 23:10:22.761 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 23:10:22.765 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 23:10:22.771 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 23:10:22.773 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 23:10:22.774 +07:00 [DBG] Connection id "0HNCB4N8MD7F4", Request id "0HNCB4N8MD7F4:00000002": started reading request body.
2025-05-04 23:10:22.776 +07:00 [DBG] Connection id "0HNCB4N8MD7F4", Request id "0HNCB4N8MD7F4:00000002": done reading request body.
2025-05-04 23:10:22.778 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 23:10:22.779 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 23:10:22.781 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 23:10:22.782 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 23:10:22.784 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 23:10:22.795 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 23:10:22.801 +07:00 [DBG] Creating DbConnection.
2025-05-04 23:10:22.802 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 23:10:22.803 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:10:22.804 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:10:22.805 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 23:10:22.806 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 23:10:22.807 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 23:10:22.810 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-04 23:10:22.819 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-04 23:10:22.821 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:10:22.822 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 1ms reading results.
2025-05-04 23:10:22.823 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:10:22.824 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (0ms).
2025-05-04 23:10:22.826 +07:00 [WRN] Login failed: user haminhkhoa17@gmail.com not found
2025-05-04 23:10:22.828 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 23:10:22.831 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 23:10:22.832 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 23:10:22.833 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 23:10:22.834 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 23:10:22.835 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType4`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 23:10:22.836 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 78.5621ms
2025-05-04 23:10:22.837 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 23:10:22.838 +07:00 [INF] HTTP POST /api/Auth/login responded 400 in 111.6827 ms
2025-05-04 23:10:22.839 +07:00 [DBG] Connection id "0HNCB4N8MD7F4" completed keep alive response.
2025-05-04 23:10:22.841 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 23:10:22.842 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:10:22.844 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 23:10:22.845 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 400 null application/json; charset=utf-8 132.1649ms
2025-05-04 23:10:31.459 +07:00 [DBG] Connection id "0HNCB4N8MD7F4" received FIN.
2025-05-04 23:10:31.461 +07:00 [DBG] Connection id "0HNCB4N8MD7F4" disconnecting.
2025-05-04 23:10:31.462 +07:00 [DBG] Connection id "0HNCB4N8MD7F4" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 23:10:31.474 +07:00 [DBG] Connection id "0HNCB4N8MD7F4" stopped.
2025-05-04 23:10:41.738 +07:00 [DBG] Connection id "0HNCB4N8MD7F5" accepted.
2025-05-04 23:10:41.740 +07:00 [DBG] Connection id "0HNCB4N8MD7F5" started.
2025-05-04 23:10:41.743 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 72
2025-05-04 23:10:41.746 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-04 23:10:41.747 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-04 23:10:41.749 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 23:10:41.752 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 23:10:41.753 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-04 23:10:41.756 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 23:10:41.758 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-04 23:10:41.763 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 23:10:41.766 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 23:10:41.771 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 23:10:41.776 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 23:10:41.778 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 23:10:41.781 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 23:10:41.793 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-04 23:10:41.796 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 23:10:41.799 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-04 23:10:41.800 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-04 23:10:41.801 +07:00 [DBG] Connection id "0HNCB4N8MD7F5", Request id "0HNCB4N8MD7F5:00000001": started reading request body.
2025-05-04 23:10:41.802 +07:00 [DBG] Connection id "0HNCB4N8MD7F5", Request id "0HNCB4N8MD7F5:00000001": done reading request body.
2025-05-04 23:10:41.803 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-04 23:10:41.804 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 23:10:41.805 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 23:10:41.807 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-04 23:10:41.808 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-04 23:10:41.860 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 23:10:41.864 +07:00 [DBG] Creating DbConnection.
2025-05-04 23:10:41.864 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 23:10:41.865 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:10:41.866 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:10:41.867 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 23:10:41.868 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 23:10:41.869 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 23:10:41.869 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-04 23:10:41.876 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-04 23:10:41.901 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 23:10:41.937 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 23:10:41.945 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 23:10:41.950 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:10:41.953 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 73ms reading results.
2025-05-04 23:10:41.954 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:10:41.956 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 23:10:42.190 +07:00 [INF] User nguyetnkhuyen@gmail.com logged in successfully
2025-05-04 23:10:42.194 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 23:10:42.196 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 23:10:42.197 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 23:10:42.197 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 23:10:42.199 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 23:10:42.201 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType6`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 23:10:42.204 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 423.1492ms
2025-05-04 23:10:42.206 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-04 23:10:42.207 +07:00 [INF] HTTP POST /api/Auth/login responded 200 in 455.3082 ms
2025-05-04 23:10:42.210 +07:00 [DBG] Connection id "0HNCB4N8MD7F5" completed keep alive response.
2025-05-04 23:10:42.211 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 23:10:42.212 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:10:42.213 +07:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-05-04 23:10:42.214 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 200 null application/json; charset=utf-8 471.3399ms
2025-05-04 23:11:18.985 +07:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5120/api/Users/-0 - null null
2025-05-04 23:11:18.991 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/-0'
2025-05-04 23:11:18.994 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/-0'
2025-05-04 23:11:19.014 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 23:11:19.016 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 23:11:19.051 +07:00 [DBG] Successfully validated the token.
2025-05-04 23:11:19.056 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 23:11:19.061 +07:00 [DBG] Authorization was successful.
2025-05-04 23:11:19.062 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 23:11:19.072 +07:00 [INF] Route matched with {action = "Delete", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Delete(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 23:11:19.077 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 23:11:19.078 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 23:11:19.079 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 23:11:19.080 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 23:11:19.081 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 23:11:19.082 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 23:11:19.083 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 23:11:19.085 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 23:11:19.088 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 23:11:19.090 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 23:11:19.091 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 23:11:19.092 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 23:11:19.093 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 23:11:19.094 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 23:11:19.096 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 23:11:19.096 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 23:11:19.097 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 23:11:19.097 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 23:11:19.098 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 23:11:19.100 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument) in 17.9167ms
2025-05-04 23:11:19.102 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 23:11:19.105 +07:00 [INF] HTTP DELETE /api/Users/-0 responded 400 in 89.0475 ms
2025-05-04 23:11:19.106 +07:00 [DBG] Connection id "0HNCB4N8MD7F5" completed keep alive response.
2025-05-04 23:11:19.107 +07:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5120/api/Users/-0 - 400 null application/json; charset=utf-8 122.4233ms
2025-05-04 23:11:24.421 +07:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5120/api/Users/90 - null null
2025-05-04 23:11:24.425 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/90'
2025-05-04 23:11:24.429 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/90'
2025-05-04 23:11:24.434 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 23:11:24.438 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 23:11:24.444 +07:00 [DBG] Successfully validated the token.
2025-05-04 23:11:24.447 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 23:11:24.453 +07:00 [DBG] Authorization was successful.
2025-05-04 23:11:24.456 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 23:11:24.462 +07:00 [INF] Route matched with {action = "Delete", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Delete(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 23:11:24.467 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 23:11:24.470 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 23:11:24.473 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 23:11:24.475 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 23:11:24.476 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 23:11:24.477 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 23:11:24.479 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 23:11:24.481 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 23:11:24.482 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 23:11:24.483 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 23:11:24.485 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 23:11:24.486 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 23:11:24.487 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 23:11:24.491 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 23:11:24.498 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "UserId") == __p_0)'
2025-05-04 23:11:24.505 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.DeletedAt (DateTime?), 2], [Property: User.Email (string) Required Index MaxLength(255), 3], [Property: User.FullName (string) Required MaxLength(255), 4], [Property: User.IsDeleted (bool) Required, 5], [Property: User.IsEmailVerified (bool) Required, 6], [Property: User.Password (string) Required MaxLength(255), 7], [Property: User.PasswordResetToken (string), 8], [Property: User.Phone (string) MaxLength(20), 9], [Property: User.ResetTokenExpires (DateTime?), 10], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 11], [Property: User.UpdatedAt (DateTime?), 12] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.DeletedAt, u.email, u.fullName, u.IsDeleted, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt
            FROM users AS u
            WHERE Not(u.IsDeleted) && (u.userId == @__p_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.DeletedAt (DateTime?), 2], [Property: User.Email (string) Required Index MaxLength(255), 3], [Property: User.FullName (string) Required MaxLength(255), 4], [Property: User.IsDeleted (bool) Required, 5], [Property: User.IsEmailVerified (bool) Required, 6], [Property: User.Password (string) Required MaxLength(255), 7], [Property: User.PasswordResetToken (string), 8], [Property: User.Phone (string) MaxLength(20), 9], [Property: User.ResetTokenExpires (DateTime?), 10], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 11], [Property: User.UpdatedAt (DateTime?), 12] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.DeletedAt, u.email, u.fullName, u.IsDeleted, u.IsEmailVerified, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt
            FROM users AS u
            WHERE Not(u.IsDeleted) && (u.userId == @__p_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<DeletedAt>k__BackingField = dataReader.IsDBNull(2) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(2);
                                    instance.<Email>k__BackingField = dataReader.GetString(3);
                                    instance.<FullName>k__BackingField = dataReader.GetString(4);
                                    instance.<IsDeleted>k__BackingField = dataReader.GetBoolean(5);
                                    instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(6);
                                    instance.<Password>k__BackingField = dataReader.GetString(7);
                                    instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                    instance.<Phone>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                    instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(11);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(12) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(12);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-04 23:11:24.516 +07:00 [DBG] Creating DbConnection.
2025-05-04 23:11:24.517 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 23:11:24.518 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:11:24.519 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:11:24.520 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 23:11:24.521 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 23:11:24.523 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 23:11:24.524 +07:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
FROM [users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[userId] = @__p_0
2025-05-04 23:11:24.528 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
FROM [users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[userId] = @__p_0
2025-05-04 23:11:24.530 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:11:24.531 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 1ms reading results.
2025-05-04 23:11:24.532 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:11:24.534 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 23:11:24.536 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 23:11:24.538 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 23:11:24.581 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 23:11:24.583 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 23:11:24.585 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 23:11:24.588 +07:00 [INF] Executing NotFoundObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 23:11:24.604 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument) in 127.1232ms
2025-05-04 23:11:24.607 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 23:11:24.610 +07:00 [INF] HTTP DELETE /api/Users/90 responded 404 in 172.6611 ms
2025-05-04 23:11:24.616 +07:00 [DBG] Connection id "0HNCB4N8MD7F5" completed keep alive response.
2025-05-04 23:11:24.617 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 23:11:24.619 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:11:24.621 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 23:11:24.624 +07:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5120/api/Users/90 - 404 null application/json; charset=utf-8 202.709ms
2025-05-04 23:11:32.093 +07:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5120/api/Users/1 - null null
2025-05-04 23:11:32.099 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1'
2025-05-04 23:11:32.102 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/1'
2025-05-04 23:11:32.103 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 23:11:32.104 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 23:11:32.106 +07:00 [DBG] Successfully validated the token.
2025-05-04 23:11:32.108 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 23:11:32.109 +07:00 [DBG] Authorization was successful.
2025-05-04 23:11:32.111 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 23:11:32.112 +07:00 [INF] Route matched with {action = "Delete", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Delete(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 23:11:32.113 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 23:11:32.115 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 23:11:32.118 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 23:11:32.120 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 23:11:32.121 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 23:11:32.124 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 23:11:32.126 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 23:11:32.128 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 23:11:32.129 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 23:11:32.130 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 23:11:32.131 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 23:11:32.132 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 23:11:32.133 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 23:11:32.135 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 23:11:32.140 +07:00 [DBG] Creating DbConnection.
2025-05-04 23:11:32.140 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 23:11:32.141 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:11:32.142 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:11:32.143 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 23:11:32.144 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 23:11:32.145 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 23:11:32.146 +07:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
FROM [users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[userId] = @__p_0
2025-05-04 23:11:32.150 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
FROM [users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[userId] = @__p_0
2025-05-04 23:11:32.154 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:11:32.157 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 3ms reading results.
2025-05-04 23:11:32.159 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:11:32.160 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (0ms).
2025-05-04 23:11:32.161 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 23:11:32.162 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 23:11:32.163 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 23:11:32.164 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 23:11:32.164 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 23:11:32.165 +07:00 [INF] Executing NotFoundObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 23:11:32.167 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument) in 43.1288ms
2025-05-04 23:11:32.169 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 23:11:32.171 +07:00 [INF] HTTP DELETE /api/Users/1 responded 404 in 66.2554 ms
2025-05-04 23:11:32.172 +07:00 [DBG] Connection id "0HNCB4N8MD7F5" completed keep alive response.
2025-05-04 23:11:32.173 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 23:11:32.173 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:11:32.174 +07:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-05-04 23:11:32.175 +07:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5120/api/Users/1 - 404 null application/json; charset=utf-8 82.4971ms
2025-05-04 23:11:36.590 +07:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5120/api/Users/1 - null null
2025-05-04 23:11:36.595 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1'
2025-05-04 23:11:36.598 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/1'
2025-05-04 23:11:36.601 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 23:11:36.602 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 23:11:36.611 +07:00 [DBG] Successfully validated the token.
2025-05-04 23:11:36.615 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 23:11:36.616 +07:00 [DBG] Authorization was successful.
2025-05-04 23:11:36.618 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 23:11:36.620 +07:00 [INF] Route matched with {action = "Delete", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Delete(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 23:11:36.626 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 23:11:36.628 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 23:11:36.629 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 23:11:36.631 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 23:11:36.633 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 23:11:36.635 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 23:11:36.638 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 23:11:36.640 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 23:11:36.641 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 23:11:36.642 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 23:11:36.643 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 23:11:36.644 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 23:11:36.645 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 23:11:36.646 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 23:11:36.649 +07:00 [DBG] Creating DbConnection.
2025-05-04 23:11:36.650 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-04 23:11:36.651 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:11:36.654 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:11:36.656 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 23:11:36.657 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-04 23:11:36.658 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-04 23:11:36.659 +07:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
FROM [users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[userId] = @__p_0
2025-05-04 23:11:36.663 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
FROM [users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[userId] = @__p_0
2025-05-04 23:11:36.665 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:11:36.667 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 1ms reading results.
2025-05-04 23:11:36.669 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:11:36.670 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 23:11:36.672 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 23:11:36.674 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 23:11:36.674 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 23:11:36.675 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 23:11:36.675 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 23:11:36.676 +07:00 [INF] Executing NotFoundObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 23:11:36.678 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument) in 42.3238ms
2025-05-04 23:11:36.679 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 23:11:36.680 +07:00 [INF] HTTP DELETE /api/Users/1 responded 404 in 77.7774 ms
2025-05-04 23:11:36.681 +07:00 [DBG] Connection id "0HNCB4N8MD7F5" completed keep alive response.
2025-05-04 23:11:36.685 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 23:11:36.686 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:11:36.687 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 23:11:36.689 +07:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5120/api/Users/1 - 404 null application/json; charset=utf-8 98.9626ms
2025-05-04 23:11:41.532 +07:00 [DBG] Connection id "0HNCB4N8MD7F5" received FIN.
2025-05-04 23:11:41.538 +07:00 [DBG] Connection id "0HNCB4N8MD7F5" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 23:11:41.544 +07:00 [DBG] Connection id "0HNCB4N8MD7F5" disconnecting.
2025-05-04 23:11:41.548 +07:00 [DBG] Connection id "0HNCB4N8MD7F5" stopped.
2025-05-04 23:11:48.565 +07:00 [DBG] Connection id "0HNCB4N8MD7F6" accepted.
2025-05-04 23:11:48.568 +07:00 [DBG] Connection id "0HNCB4N8MD7F6" started.
2025-05-04 23:11:48.571 +07:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5120/api/Users/1 - null null
2025-05-04 23:11:48.575 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1'
2025-05-04 23:11:48.577 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/1'
2025-05-04 23:11:48.579 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 23:11:48.580 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 23:11:48.583 +07:00 [DBG] Successfully validated the token.
2025-05-04 23:11:48.586 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 23:11:48.589 +07:00 [DBG] Authorization was successful.
2025-05-04 23:11:48.592 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 23:11:48.594 +07:00 [INF] Route matched with {action = "Delete", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Delete(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 23:11:48.597 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 23:11:48.599 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 23:11:48.601 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 23:11:48.603 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 23:11:48.604 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 23:11:48.605 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 23:11:48.607 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 23:11:48.608 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 23:11:48.609 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 23:11:48.610 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 23:11:48.611 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 23:11:48.612 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 23:11:48.613 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 23:11:48.616 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 23:11:48.619 +07:00 [DBG] Creating DbConnection.
2025-05-04 23:11:48.620 +07:00 [DBG] Created DbConnection. (1ms).
2025-05-04 23:11:48.621 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:11:48.622 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:11:48.623 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 23:11:48.624 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 23:11:48.625 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 23:11:48.626 +07:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
FROM [users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[userId] = @__p_0
2025-05-04 23:11:48.630 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
FROM [users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[userId] = @__p_0
2025-05-04 23:11:48.634 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:11:48.635 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 1ms reading results.
2025-05-04 23:11:48.637 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:11:48.638 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 23:11:48.639 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 23:11:48.641 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 23:11:48.641 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 23:11:48.642 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 23:11:48.642 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 23:11:48.643 +07:00 [INF] Executing NotFoundObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 23:11:48.644 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument) in 39.0322ms
2025-05-04 23:11:48.646 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 23:11:48.647 +07:00 [INF] HTTP DELETE /api/Users/1 responded 404 in 67.0687 ms
2025-05-04 23:11:48.649 +07:00 [DBG] Connection id "0HNCB4N8MD7F6" completed keep alive response.
2025-05-04 23:11:48.650 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 23:11:48.652 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:11:48.653 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 23:11:48.654 +07:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5120/api/Users/1 - 404 null application/json; charset=utf-8 83.3516ms
2025-05-04 23:12:26.806 +07:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5120/api/Users/3 - null null
2025-05-04 23:12:26.809 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/3'
2025-05-04 23:12:26.812 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/3'
2025-05-04 23:12:26.815 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 23:12:26.834 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 23:12:26.837 +07:00 [DBG] Successfully validated the token.
2025-05-04 23:12:26.845 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 23:12:26.847 +07:00 [DBG] Authorization was successful.
2025-05-04 23:12:26.849 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 23:12:26.853 +07:00 [INF] Route matched with {action = "Delete", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Delete(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 23:12:26.857 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 23:12:26.858 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 23:12:26.859 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 23:12:26.863 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 23:12:26.866 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 23:12:26.867 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 23:12:26.868 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 23:12:26.869 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 23:12:26.870 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 23:12:26.871 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 23:12:26.872 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 23:12:26.872 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 23:12:26.873 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 23:12:26.874 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-04 23:12:26.876 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-04 23:12:26.878 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-04 23:12:26.879 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-04 23:12:26.880 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-04 23:12:26.881 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 23:12:26.882 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument) in 14.7582ms
2025-05-04 23:12:26.883 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 23:12:26.884 +07:00 [INF] HTTP DELETE /api/Users/3 responded 400 in 49.9168 ms
2025-05-04 23:12:26.885 +07:00 [DBG] Connection id "0HNCB4N8MD7F6" completed keep alive response.
2025-05-04 23:12:26.886 +07:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5120/api/Users/3 - 400 null application/json; charset=utf-8 79.776ms
2025-05-04 23:12:44.650 +07:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5120/api/Users/2 - null null
2025-05-04 23:12:44.654 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/2'
2025-05-04 23:12:44.656 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/2'
2025-05-04 23:12:44.659 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 23:12:44.663 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-04 23:12:44.665 +07:00 [DBG] Successfully validated the token.
2025-05-04 23:12:44.667 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-04 23:12:44.670 +07:00 [DBG] Authorization was successful.
2025-05-04 23:12:44.672 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 23:12:44.676 +07:00 [INF] Route matched with {action = "Delete", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Delete(Int32) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-04 23:12:44.680 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-04 23:12:44.684 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-04 23:12:44.686 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-04 23:12:44.688 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-04 23:12:44.690 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-04 23:12:44.692 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 23:12:44.696 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-04 23:12:44.699 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-04 23:12:44.700 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-04 23:12:44.701 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 23:12:44.702 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-04 23:12:44.703 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-04 23:12:44.704 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-04 23:12:44.705 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-04 23:12:44.708 +07:00 [DBG] Creating DbConnection.
2025-05-04 23:12:44.709 +07:00 [DBG] Created DbConnection. (1ms).
2025-05-04 23:12:44.711 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:12:44.713 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:12:44.714 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 23:12:44.714 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 23:12:44.715 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 23:12:44.716 +07:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
FROM [users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[userId] = @__p_0
2025-05-04 23:12:44.720 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt]
FROM [users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[userId] = @__p_0
2025-05-04 23:12:44.722 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 23:12:44.723 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:12:44.725 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 3ms reading results.
2025-05-04 23:12:44.727 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:12:44.728 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 23:12:44.732 +07:00 [DBG] SaveChanges starting for 'ExchangeDocumentContext'.
2025-05-04 23:12:44.734 +07:00 [DBG] DetectChanges starting for 'ExchangeDocumentContext'.
2025-05-04 23:12:44.745 +07:00 [DBG] The unchanged property 'User.DeletedAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-04 23:12:44.750 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 23:12:44.754 +07:00 [DBG] The unchanged property 'User.IsDeleted' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-04 23:12:44.762 +07:00 [DBG] DetectChanges completed for 'ExchangeDocumentContext'.
2025-05-04 23:12:44.799 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:12:44.800 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:12:44.803 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-04 23:12:44.803 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-04 23:12:44.805 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-04 23:12:44.805 +07:00 [DBG] Executing DbCommand [Parameters=[@p2='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [users] SET [DeletedAt] = @p0, [IsDeleted] = @p1
OUTPUT 1
WHERE [userId] = @p2;
2025-05-04 23:12:44.815 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [users] SET [DeletedAt] = @p0, [IsDeleted] = @p1
OUTPUT 1
WHERE [userId] = @p2;
2025-05-04 23:12:44.820 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:12:44.821 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 4ms reading results.
2025-05-04 23:12:44.823 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:12:44.825 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-04 23:12:44.830 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-04 23:12:44.833 +07:00 [DBG] SaveChanges completed for 'ExchangeDocumentContext' with 1 entities written to the database.
2025-05-04 23:12:44.834 +07:00 [INF] User 2 soft-deleted by Admin 3
2025-05-04 23:12:44.835 +07:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-05-04 23:12:44.836 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument) in 143.3865ms
2025-05-04 23:12:44.837 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Delete (ExchangeDocument)'
2025-05-04 23:12:44.837 +07:00 [INF] HTTP DELETE /api/Users/2 responded 204 in 174.4219 ms
2025-05-04 23:12:44.839 +07:00 [DBG] Connection id "0HNCB4N8MD7F6" completed keep alive response.
2025-05-04 23:12:44.840 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-04 23:12:44.841 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-04 23:12:44.843 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-04 23:12:44.844 +07:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5120/api/Users/2 - 204 null null 193.7467ms
2025-05-04 23:13:01.619 +07:00 [DBG] Connection id "0HNCB4N8MD7F6" received FIN.
2025-05-04 23:13:01.622 +07:00 [DBG] Connection id "0HNCB4N8MD7F6" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-04 23:13:01.625 +07:00 [DBG] Connection id "0HNCB4N8MD7F6" disconnecting.
2025-05-04 23:13:01.625 +07:00 [DBG] Connection id "0HNCB4N8MD7F6" stopped.
