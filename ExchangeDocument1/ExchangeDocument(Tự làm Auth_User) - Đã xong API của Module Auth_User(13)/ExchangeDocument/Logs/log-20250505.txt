2025-05-05 13:48:43.300 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-05-05 13:48:43.824 +07:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'Order'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 13:48:43.832 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'OrderDetail'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 13:48:43.839 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'Review'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 13:48:43.848 +07:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'Userprofile'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 13:48:44.036 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-05 13:48:44.774 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-05 13:49:16.583 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-05-05 13:49:17.157 +07:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'Order'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 13:49:17.161 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'OrderDetail'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 13:49:17.163 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'Review'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 13:49:17.165 +07:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'Userprofile'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 13:49:17.347 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-05 13:49:17.553 +07:00 [DBG] Creating DbConnection.
2025-05-05 13:49:17.614 +07:00 [DBG] Created DbConnection. (61ms).
2025-05-05 13:49:17.618 +07:00 [DBG] Migrating using database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 13:49:17.630 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 13:49:17.855 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 13:49:17.863 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 13:49:17.871 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (7ms).
2025-05-05 13:49:17.876 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (15ms).
2025-05-05 13:49:17.889 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-05 13:49:17.934 +07:00 [INF] Executed DbCommand (42ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-05 13:49:17.944 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 13:49:17.966 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (16ms).
2025-05-05 13:49:17.975 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 13:49:17.979 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 13:49:17.986 +07:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-05-05 13:49:17.993 +07:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-05-05 13:49:17.996 +07:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-05-05 13:49:17.998 +07:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (5ms).
2025-05-05 13:49:18.002 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-05-05 13:49:18.048 +07:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-05-05 13:49:18.148 +07:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-05-05 13:49:18.156 +07:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-05-05 13:49:18.159 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 13:49:18.161 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (2ms).
2025-05-05 13:49:18.165 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (5ms).
2025-05-05 13:49:18.167 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-05-05 13:49:18.180 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-05-05 13:49:18.188 +07:00 [DBG] Committing transaction.
2025-05-05 13:49:18.196 +07:00 [DBG] Committed transaction.
2025-05-05 13:49:18.200 +07:00 [DBG] Disposing transaction.
2025-05-05 13:49:18.205 +07:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-05-05 13:49:18.209 +07:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-05-05 13:49:18.214 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 13:49:18.216 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (2ms).
2025-05-05 13:49:18.219 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (5ms).
2025-05-05 13:49:18.221 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-05 13:49:18.225 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-05 13:49:18.230 +07:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-05-05 13:49:18.232 +07:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-05-05 13:49:18.234 +07:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (4ms).
2025-05-05 13:49:18.238 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-05 13:49:18.243 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-05 13:49:18.249 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 13:49:18.251 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-05-05 13:49:18.254 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2025-05-05 13:49:18.257 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-05 13:49:18.267 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-05 13:49:18.276 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 13:49:18.281 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 6ms reading results.
2025-05-05 13:49:18.295 +07:00 [INF] Applying migration '20250505064844_AddIsLockedToUser'.
2025-05-05 13:49:18.338 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 13:49:18.341 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (2ms).
2025-05-05 13:49:18.344 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (5ms).
2025-05-05 13:49:18.347 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [users] ADD [IsLocked] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-05 13:49:18.376 +07:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [users] ADD [IsLocked] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-05 13:49:18.380 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 13:49:18.382 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 13:49:18.383 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-05-05 13:49:18.384 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250505064844_AddIsLockedToUser', N'9.0.4');
2025-05-05 13:49:18.389 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250505064844_AddIsLockedToUser', N'9.0.4');
2025-05-05 13:49:18.395 +07:00 [DBG] Committing transaction.
2025-05-05 13:49:18.398 +07:00 [DBG] Committed transaction.
2025-05-05 13:49:18.400 +07:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-05-05 13:49:18.402 +07:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-05-05 13:49:18.405 +07:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (4ms).
2025-05-05 13:49:18.407 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-05-05 13:49:18.414 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-05-05 13:49:18.419 +07:00 [DBG] Disposing transaction.
2025-05-05 13:49:18.421 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 13:49:18.424 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (3ms).
2025-05-05 13:49:18.431 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-05 13:49:18.439 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 13:49:18.444 +07:00 [DBG] Disposed connection to database '' on server '' (6ms).
2025-05-05 13:49:55.028 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-05-05 13:49:55.176 +07:00 [DBG] Hosting starting
2025-05-05 13:49:55.203 +07:00 [INF] User profile is available. Using 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-05 13:49:55.224 +07:00 [DBG] Reading data from file 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys\key-1a51a872-ea43-4350-815f-0422835a65dd.xml'.
2025-05-05 13:49:55.248 +07:00 [DBG] Found key {1a51a872-ea43-4350-815f-0422835a65dd}.
2025-05-05 13:49:55.268 +07:00 [DBG] Considering key {1a51a872-ea43-4350-815f-0422835a65dd} with expiration date 2025-07-05 19:31:04Z as default key.
2025-05-05 13:49:55.276 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-05 13:49:55.282 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-05-05 13:49:55.286 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-05 13:49:55.294 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-05-05 13:49:55.298 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-05-05 13:49:55.301 +07:00 [DBG] Using key {1a51a872-ea43-4350-815f-0422835a65dd} as the default key.
2025-05-05 13:49:55.304 +07:00 [DBG] Key ring with default key {1a51a872-ea43-4350-815f-0422835a65dd} was loaded during application startup.
2025-05-05 13:49:55.391 +07:00 [INF] Now listening on: http://localhost:5120
2025-05-05 13:49:55.393 +07:00 [DBG] Loaded hosting startup assembly ExchangeDocument
2025-05-05 13:49:55.394 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-05 13:49:55.396 +07:00 [INF] Hosting environment: Development
2025-05-05 13:49:55.397 +07:00 [INF] Content root path: D:\Gộp module Auth\ExchangeDocument(Tự làm Auth_User) - Đã xong 12 API của Module Auth_User\ExchangeDocument
2025-05-05 13:49:55.398 +07:00 [DBG] Hosting started
2025-05-05 13:50:22.366 +07:00 [DBG] Connection id "0HNCBK4DNPUGQ" accepted.
2025-05-05 13:50:22.373 +07:00 [DBG] Connection id "0HNCBK4DNPUGQ" started.
2025-05-05 13:50:22.373 +07:00 [DBG] Connection id "0HNCBK4DNPUGR" accepted.
2025-05-05 13:50:22.383 +07:00 [DBG] Connection id "0HNCBK4DNPUGR" started.
2025-05-05 13:50:22.480 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/index.html - null null
2025-05-05 13:50:22.494 +07:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-05-05 13:50:22.543 +07:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-05-05 13:50:22.547 +07:00 [DBG] Request did not match any endpoints
2025-05-05 13:50:22.794 +07:00 [INF] HTTP GET /swagger/index.html responded 200 in 234.9120 ms
2025-05-05 13:50:22.805 +07:00 [DBG] Connection id "0HNCBK4DNPUGQ" completed keep alive response.
2025-05-05 13:50:22.813 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/index.html - 200 null text/html;charset=utf-8 336.0854ms
2025-05-05 13:50:24.454 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - null null
2025-05-05 13:50:24.461 +07:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-05-05 13:50:24.465 +07:00 [DBG] Request did not match any endpoints
2025-05-05 13:50:24.912 +07:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 444.6459 ms
2025-05-05 13:50:24.917 +07:00 [DBG] Connection id "0HNCBK4DNPUGQ" completed keep alive response.
2025-05-05 13:50:24.920 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 465.8164ms
2025-05-05 13:51:32.956 +07:00 [DBG] Connection id "0HNCBK4DNPUGR" received FIN.
2025-05-05 13:51:32.956 +07:00 [DBG] Connection id "0HNCBK4DNPUGQ" received FIN.
2025-05-05 13:51:32.961 +07:00 [DBG] Connection id "0HNCBK4DNPUGQ" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-05 13:51:32.961 +07:00 [DBG] Connection id "0HNCBK4DNPUGR" disconnecting.
2025-05-05 13:51:32.968 +07:00 [DBG] Connection id "0HNCBK4DNPUGQ" disconnecting.
2025-05-05 13:51:32.969 +07:00 [DBG] Connection id "0HNCBK4DNPUGR" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-05 13:51:32.972 +07:00 [DBG] Connection id "0HNCBK4DNPUGQ" stopped.
2025-05-05 13:51:32.982 +07:00 [DBG] Connection id "0HNCBK4DNPUGR" stopped.
2025-05-05 14:00:25.259 +07:00 [DBG] Connection id "0HNCBK4DNPUGS" accepted.
2025-05-05 14:00:25.262 +07:00 [DBG] Connection id "0HNCBK4DNPUGS" started.
2025-05-05 14:00:25.264 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/-9 - application/json 82
2025-05-05 14:00:25.286 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/-9'
2025-05-05 14:00:25.293 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/-9'
2025-05-05 14:00:25.296 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)'
2025-05-05 14:00:25.301 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 14:00:25.303 +07:00 [WRN] Failed to determine the https port for redirect.
2025-05-05 14:00:25.333 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-05 14:00:25.339 +07:00 [DBG] Policy authentication schemes  did not succeed
2025-05-05 14:00:25.342 +07:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-05-05 14:00:25.345 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-05 14:00:25.346 +07:00 [INF] HTTP PUT /api/Users/-9 responded 401 in 45.6738 ms
2025-05-05 14:00:25.347 +07:00 [DBG] Connection id "0HNCBK4DNPUGS" completed keep alive response.
2025-05-05 14:00:25.348 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/-9 - 401 0 null 84.5468ms
2025-05-05 14:00:25.352 +07:00 [DBG] Connection id "0HNCBK4DNPUGS", Request id "0HNCBK4DNPUGS:00000001": started reading request body.
2025-05-05 14:00:25.353 +07:00 [DBG] Connection id "0HNCBK4DNPUGS", Request id "0HNCBK4DNPUGS:00000001": done reading request body.
2025-05-05 14:01:19.513 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5120/api/Auth/login - application/json 72
2025-05-05 14:01:19.517 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-05 14:01:19.519 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-05 14:01:19.521 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-05 14:01:19.523 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 14:01:19.527 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-05 14:01:19.531 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-05 14:01:19.558 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-05 14:01:19.562 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-05 14:01:19.564 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-05 14:01:19.566 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-05 14:01:19.569 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-05 14:01:19.570 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-05 14:01:19.572 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-05 14:01:19.625 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-05-05 14:01:19.640 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-05 14:01:19.647 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-05 14:01:19.651 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-05 14:01:19.653 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-05 14:01:19.664 +07:00 [DBG] Connection id "0HNCBK4DNPUGS", Request id "0HNCBK4DNPUGS:00000002": started reading request body.
2025-05-05 14:01:19.666 +07:00 [DBG] Connection id "0HNCBK4DNPUGS", Request id "0HNCBK4DNPUGS:00000002": done reading request body.
2025-05-05 14:01:19.674 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-05 14:01:19.676 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-05 14:01:19.678 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-05 14:01:19.679 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-05 14:01:19.686 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-05 14:01:20.000 +07:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'Order'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 14:01:20.002 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'OrderDetail'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 14:01:20.003 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'Review'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 14:01:20.005 +07:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'Userprofile'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 14:01:20.102 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-05 14:01:20.164 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .FirstOrDefault(u => u.Email == __email_0)'
2025-05-05 14:01:20.212 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-05 14:01:20.411 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.DeletedAt (DateTime?), 2], [Property: User.Email (string) Required Index MaxLength(255), 3], [Property: User.FullName (string) Required MaxLength(255), 4], [Property: User.IsDeleted (bool) Required, 5], [Property: User.IsEmailVerified (bool) Required, 6], [Property: User.IsLocked (bool) Required, 7], [Property: User.Password (string) Required MaxLength(255), 8], [Property: User.PasswordResetToken (string), 9], [Property: User.Phone (string) MaxLength(20), 10], [Property: User.ResetTokenExpires (DateTime?), 11], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 12], [Property: User.UpdatedAt (DateTime?), 13] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 14], [Property: Role.RoleName (string) Required Index MaxLength(50), 15] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.DeletedAt, u.email, u.fullName, u.IsDeleted, u.IsEmailVerified, u.IsLocked, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE Not(u.IsDeleted) && (u.email == @__email_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.DeletedAt (DateTime?), 2], [Property: User.Email (string) Required Index MaxLength(255), 3], [Property: User.FullName (string) Required MaxLength(255), 4], [Property: User.IsDeleted (bool) Required, 5], [Property: User.IsEmailVerified (bool) Required, 6], [Property: User.IsLocked (bool) Required, 7], [Property: User.Password (string) Required MaxLength(255), 8], [Property: User.PasswordResetToken (string), 9], [Property: User.Phone (string) MaxLength(20), 10], [Property: User.ResetTokenExpires (DateTime?), 11], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 12], [Property: User.UpdatedAt (DateTime?), 13] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 14], [Property: Role.RoleName (string) Required Index MaxLength(50), 15] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.DeletedAt, u.email, u.fullName, u.IsDeleted, u.IsEmailVerified, u.IsLocked, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE Not(u.IsDeleted) && (u.email == @__email_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            Role entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<DeletedAt>k__BackingField = dataReader.IsDBNull(2) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(2);
                                    instance.<Email>k__BackingField = dataReader.GetString(3);
                                    instance.<FullName>k__BackingField = dataReader.GetString(4);
                                    instance.<IsDeleted>k__BackingField = dataReader.GetBoolean(5);
                                    instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(6);
                                    instance.<IsLocked>k__BackingField = dataReader.GetBoolean(7);
                                    instance.<Password>k__BackingField = dataReader.GetString(8);
                                    instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                    instance.<Phone>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                    instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(11);
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(12);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(13) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(13);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                Role instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(Role);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(14) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (Role)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                            {
                                return 
                                {
                                    Role instance;
                                    instance = new Role();
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(14);
                                    instance.<RoleName>k__BackingField = dataReader.GetString(15);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Role)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
                fixup: (namelessParameter{8}, namelessParameter{9}) => 
                {
                    namelessParameter{8}.<Role>k__BackingField = namelessParameter{9};
                    return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                        entity: namelessParameter{9}, 
                        value: namelessParameter{8}, 
                        forMaterialization: True);
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-05 14:01:20.467 +07:00 [DBG] Creating DbConnection.
2025-05-05 14:01:20.479 +07:00 [DBG] Created DbConnection. (11ms).
2025-05-05 14:01:20.483 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:01:20.585 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:01:20.588 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 14:01:20.593 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-05-05 14:01:20.599 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (11ms).
2025-05-05 14:01:20.605 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-05 14:01:20.643 +07:00 [INF] Executed DbCommand (38ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-05 14:01:20.670 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 14:01:20.706 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 14:01:20.710 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 14:01:20.719 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:01:20.725 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 76ms reading results.
2025-05-05 14:01:20.729 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:01:20.734 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (4ms).
2025-05-05 14:01:20.976 +07:00 [INF] User nguyetnkhuyen@gmail.com logged in successfully
2025-05-05 14:01:20.980 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-05 14:01:20.985 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-05 14:01:20.986 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-05 14:01:20.987 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-05 14:01:20.989 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-05 14:01:20.992 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType6`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-05 14:01:21.006 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 1433.0015ms
2025-05-05 14:01:21.008 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-05 14:01:21.010 +07:00 [INF] HTTP POST /api/Auth/login responded 200 in 1487.4482 ms
2025-05-05 14:01:21.011 +07:00 [DBG] Connection id "0HNCBK4DNPUGS" completed keep alive response.
2025-05-05 14:01:21.015 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-05 14:01:21.019 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:01:21.022 +07:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-05-05 14:01:21.024 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5120/api/Auth/login - 200 null application/json; charset=utf-8 1511.4761ms
2025-05-05 14:01:41.757 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/-9 - application/json 82
2025-05-05 14:01:41.761 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/-9'
2025-05-05 14:01:41.762 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/-9'
2025-05-05 14:01:41.764 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)'
2025-05-05 14:01:41.767 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 14:01:41.810 +07:00 [DBG] Successfully validated the token.
2025-05-05 14:01:41.817 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-05 14:01:41.820 +07:00 [DBG] Authorization was successful.
2025-05-05 14:01:41.821 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)'
2025-05-05 14:01:41.825 +07:00 [INF] Route matched with {action = "Update", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Int32, ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-05 14:01:41.828 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-05 14:01:41.830 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-05 14:01:41.831 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-05 14:01:41.833 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-05 14:01:41.835 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-05 14:01:41.836 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-05 14:01:41.838 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-05 14:01:41.840 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-05 14:01:41.842 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-05 14:01:41.843 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-05 14:01:41.845 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-05 14:01:41.847 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-05 14:01:41.848 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-05 14:01:41.849 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO' ...
2025-05-05 14:01:41.850 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO' using the name '' in request data ...
2025-05-05 14:01:41.851 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-05 14:01:41.854 +07:00 [DBG] Connection id "0HNCBK4DNPUGS", Request id "0HNCBK4DNPUGS:00000003": started reading request body.
2025-05-05 14:01:41.855 +07:00 [DBG] Connection id "0HNCBK4DNPUGS", Request id "0HNCBK4DNPUGS:00000003": done reading request body.
2025-05-05 14:01:41.858 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'
2025-05-05 14:01:41.859 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'.
2025-05-05 14:01:41.861 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'.
2025-05-05 14:01:41.863 +07:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO' ...
2025-05-05 14:01:41.866 +07:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'.
2025-05-05 14:01:41.867 +07:00 [DBG] The request has model state errors, returning an error response.
2025-05-05 14:01:41.868 +07:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2025-05-05 14:01:41.870 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-05 14:01:41.872 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-05 14:01:41.874 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-05-05 14:01:41.878 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-05-05 14:01:41.880 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-05 14:01:41.903 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument) in 66.7436ms
2025-05-05 14:01:41.905 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)'
2025-05-05 14:01:41.906 +07:00 [INF] HTTP PUT /api/Users/-9 responded 400 in 139.6639 ms
2025-05-05 14:01:41.908 +07:00 [DBG] Connection id "0HNCBK4DNPUGS" completed keep alive response.
2025-05-05 14:01:41.909 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/-9 - 400 null application/problem+json; charset=utf-8 151.9119ms
2025-05-05 14:01:55.902 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/-9 - application/json 86
2025-05-05 14:01:55.905 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/-9'
2025-05-05 14:01:55.907 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/-9'
2025-05-05 14:01:55.908 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)'
2025-05-05 14:01:55.910 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 14:01:55.917 +07:00 [DBG] Successfully validated the token.
2025-05-05 14:01:55.919 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-05 14:01:55.921 +07:00 [DBG] Authorization was successful.
2025-05-05 14:01:55.922 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)'
2025-05-05 14:01:55.923 +07:00 [INF] Route matched with {action = "Update", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Int32, ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-05 14:01:55.925 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-05 14:01:55.927 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-05 14:01:55.929 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-05 14:01:55.930 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-05 14:01:55.931 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-05 14:01:55.933 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-05 14:01:55.935 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-05 14:01:55.937 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-05 14:01:55.938 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-05 14:01:55.939 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-05 14:01:55.940 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-05 14:01:55.941 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-05 14:01:55.942 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-05 14:01:55.944 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO' ...
2025-05-05 14:01:55.946 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO' using the name '' in request data ...
2025-05-05 14:01:55.947 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-05 14:01:55.948 +07:00 [DBG] Connection id "0HNCBK4DNPUGS", Request id "0HNCBK4DNPUGS:00000004": started reading request body.
2025-05-05 14:01:55.949 +07:00 [DBG] Connection id "0HNCBK4DNPUGS", Request id "0HNCBK4DNPUGS:00000004": done reading request body.
2025-05-05 14:01:55.950 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'
2025-05-05 14:01:55.951 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'.
2025-05-05 14:01:55.952 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'.
2025-05-05 14:01:55.952 +07:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO' ...
2025-05-05 14:01:55.954 +07:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'.
2025-05-05 14:01:55.956 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-05 14:01:55.958 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-05 14:01:55.959 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-05 14:01:55.960 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-05 14:01:55.961 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-05 14:01:55.962 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-05 14:01:55.964 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument) in 31.3332ms
2025-05-05 14:01:55.965 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)'
2025-05-05 14:01:55.966 +07:00 [INF] HTTP PUT /api/Users/-9 responded 400 in 56.2751 ms
2025-05-05 14:01:55.967 +07:00 [DBG] Connection id "0HNCBK4DNPUGS" completed keep alive response.
2025-05-05 14:01:55.968 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/-9 - 400 null application/json; charset=utf-8 66.4993ms
2025-05-05 14:02:09.356 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/1 - application/json 86
2025-05-05 14:02:09.360 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1'
2025-05-05 14:02:09.362 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/1'
2025-05-05 14:02:09.365 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)'
2025-05-05 14:02:09.367 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 14:02:09.368 +07:00 [DBG] Successfully validated the token.
2025-05-05 14:02:09.369 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-05 14:02:09.371 +07:00 [DBG] Authorization was successful.
2025-05-05 14:02:09.371 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)'
2025-05-05 14:02:09.373 +07:00 [INF] Route matched with {action = "Update", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Int32, ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-05 14:02:09.376 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-05 14:02:09.378 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-05 14:02:09.381 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-05 14:02:09.382 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-05 14:02:09.383 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-05 14:02:09.385 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-05 14:02:09.388 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-05 14:02:09.389 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-05 14:02:09.391 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-05 14:02:09.392 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-05 14:02:09.394 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-05 14:02:09.395 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-05 14:02:09.396 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-05 14:02:09.397 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO' ...
2025-05-05 14:02:09.398 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO' using the name '' in request data ...
2025-05-05 14:02:09.399 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-05 14:02:09.401 +07:00 [DBG] Connection id "0HNCBK4DNPUGS", Request id "0HNCBK4DNPUGS:00000005": started reading request body.
2025-05-05 14:02:09.402 +07:00 [DBG] Connection id "0HNCBK4DNPUGS", Request id "0HNCBK4DNPUGS:00000005": done reading request body.
2025-05-05 14:02:09.403 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'
2025-05-05 14:02:09.404 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'.
2025-05-05 14:02:09.404 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'.
2025-05-05 14:02:09.405 +07:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO' ...
2025-05-05 14:02:09.407 +07:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'.
2025-05-05 14:02:09.419 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-05 14:02:09.423 +07:00 [DBG] Compiling query expression: 
'DbSet<Role>()
    .Any(r => r.RoleId == __roleId_0)'
2025-05-05 14:02:09.431 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: SingleQueryingEnumerable.Create<bool>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM roles AS r
                WHERE r.roleId == @__roleId_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM roles AS r
                WHERE r.roleId == @__roleId_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            bool? value1;
            value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
            return (bool)value1;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-05 14:02:09.443 +07:00 [DBG] Creating DbConnection.
2025-05-05 14:02:09.445 +07:00 [DBG] Created DbConnection. (1ms).
2025-05-05 14:02:09.446 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:02:09.448 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:02:09.449 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 14:02:09.450 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-05 14:02:09.451 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-05 14:02:09.452 +07:00 [DBG] Executing DbCommand [Parameters=[@__roleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [roles] AS [r]
        WHERE [r].[roleId] = @__roleId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-05 14:02:09.460 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__roleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [roles] AS [r]
        WHERE [r].[roleId] = @__roleId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-05 14:02:09.463 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:02:09.465 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 2ms reading results.
2025-05-05 14:02:09.466 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:02:09.468 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-05 14:02:09.470 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-05 14:02:09.472 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-05 14:02:09.473 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-05 14:02:09.474 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-05 14:02:09.475 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-05 14:02:09.476 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-05 14:02:09.478 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument) in 93.4949ms
2025-05-05 14:02:09.480 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)'
2025-05-05 14:02:09.481 +07:00 [INF] HTTP PUT /api/Users/1 responded 400 in 114.4585 ms
2025-05-05 14:02:09.482 +07:00 [DBG] Connection id "0HNCBK4DNPUGS" completed keep alive response.
2025-05-05 14:02:09.483 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-05 14:02:09.484 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:02:09.486 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-05 14:02:09.487 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/1 - 400 null application/json; charset=utf-8 131.1044ms
2025-05-05 14:02:22.517 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/1 - application/json 86
2025-05-05 14:02:22.519 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1'
2025-05-05 14:02:22.521 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/1'
2025-05-05 14:02:22.524 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)'
2025-05-05 14:02:22.526 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 14:02:22.527 +07:00 [DBG] Successfully validated the token.
2025-05-05 14:02:22.528 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-05 14:02:22.535 +07:00 [DBG] Authorization was successful.
2025-05-05 14:02:22.537 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)'
2025-05-05 14:02:22.540 +07:00 [INF] Route matched with {action = "Update", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Int32, ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-05 14:02:22.543 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-05 14:02:22.544 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-05 14:02:22.546 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-05 14:02:22.548 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-05 14:02:22.549 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-05 14:02:22.550 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-05 14:02:22.551 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-05 14:02:22.552 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-05 14:02:22.553 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-05 14:02:22.555 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-05 14:02:22.556 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-05 14:02:22.557 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-05 14:02:22.558 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-05 14:02:22.559 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO' ...
2025-05-05 14:02:22.560 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO' using the name '' in request data ...
2025-05-05 14:02:22.561 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-05 14:02:22.562 +07:00 [DBG] Connection id "0HNCBK4DNPUGS", Request id "0HNCBK4DNPUGS:00000006": started reading request body.
2025-05-05 14:02:22.563 +07:00 [DBG] Connection id "0HNCBK4DNPUGS", Request id "0HNCBK4DNPUGS:00000006": done reading request body.
2025-05-05 14:02:22.564 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'
2025-05-05 14:02:22.565 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'.
2025-05-05 14:02:22.565 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'.
2025-05-05 14:02:22.566 +07:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO' ...
2025-05-05 14:02:22.567 +07:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'.
2025-05-05 14:02:22.608 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-05 14:02:22.614 +07:00 [DBG] Creating DbConnection.
2025-05-05 14:02:22.615 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-05 14:02:22.616 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:02:22.618 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:02:22.619 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 14:02:22.619 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-05 14:02:22.620 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-05 14:02:22.622 +07:00 [DBG] Executing DbCommand [Parameters=[@__roleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [roles] AS [r]
        WHERE [r].[roleId] = @__roleId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-05 14:02:22.625 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__roleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [roles] AS [r]
        WHERE [r].[roleId] = @__roleId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-05 14:02:22.628 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:02:22.629 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 1ms reading results.
2025-05-05 14:02:22.631 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:02:22.632 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (0ms).
2025-05-05 14:02:22.634 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .Include(u => u.Userprofile)
    .FirstOrDefault(u => u.UserId == __userId_0)'
2025-05-05 14:02:22.636 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-05 14:02:22.639 +07:00 [DBG] Including navigation: 'User.Userprofile'.
2025-05-05 14:02:22.650 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.DeletedAt (DateTime?), 2], [Property: User.Email (string) Required Index MaxLength(255), 3], [Property: User.FullName (string) Required MaxLength(255), 4], [Property: User.IsDeleted (bool) Required, 5], [Property: User.IsEmailVerified (bool) Required, 6], [Property: User.IsLocked (bool) Required, 7], [Property: User.Password (string) Required MaxLength(255), 8], [Property: User.PasswordResetToken (string), 9], [Property: User.Phone (string) MaxLength(20), 10], [Property: User.ResetTokenExpires (DateTime?), 11], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 12], [Property: User.UpdatedAt (DateTime?), 13] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 14], [Property: Role.RoleName (string) Required Index MaxLength(50), 15] }
                2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 16], [Property: Userprofile.Address (string) MaxLength(500), 17], [Property: Userprofile.Birth (DateTime?), 18], [Property: Userprofile.UserId (int) Required FK Index, 19] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.DeletedAt, u.email, u.fullName, u.IsDeleted, u.IsEmailVerified, u.IsLocked, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName, u0.userprofileId, u0.address, u0.birth, u0.userId
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            LEFT JOIN userprofiles AS u0 ON u.userId == u0.userId
            WHERE Not(u.IsDeleted) && (u.userId == @__userId_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.DeletedAt (DateTime?), 2], [Property: User.Email (string) Required Index MaxLength(255), 3], [Property: User.FullName (string) Required MaxLength(255), 4], [Property: User.IsDeleted (bool) Required, 5], [Property: User.IsEmailVerified (bool) Required, 6], [Property: User.IsLocked (bool) Required, 7], [Property: User.Password (string) Required MaxLength(255), 8], [Property: User.PasswordResetToken (string), 9], [Property: User.Phone (string) MaxLength(20), 10], [Property: User.ResetTokenExpires (DateTime?), 11], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 12], [Property: User.UpdatedAt (DateTime?), 13] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 14], [Property: Role.RoleName (string) Required Index MaxLength(50), 15] }
                2 -> Dictionary<IProperty, int> { [Property: Userprofile.UserprofileId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 16], [Property: Userprofile.Address (string) MaxLength(500), 17], [Property: Userprofile.Birth (DateTime?), 18], [Property: Userprofile.UserId (int) Required FK Index, 19] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.DeletedAt, u.email, u.fullName, u.IsDeleted, u.IsEmailVerified, u.IsLocked, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName, u0.userprofileId, u0.address, u0.birth, u0.userId
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            LEFT JOIN userprofiles AS u0 ON u.userId == u0.userId
            WHERE Not(u.IsDeleted) && (u.userId == @__userId_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            Role entity;
            Userprofile entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<DeletedAt>k__BackingField = dataReader.IsDBNull(2) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(2);
                                    instance.<Email>k__BackingField = dataReader.GetString(3);
                                    instance.<FullName>k__BackingField = dataReader.GetString(4);
                                    instance.<IsDeleted>k__BackingField = dataReader.GetBoolean(5);
                                    instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(6);
                                    instance.<IsLocked>k__BackingField = dataReader.GetBoolean(7);
                                    instance.<Password>k__BackingField = dataReader.GetString(8);
                                    instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                    instance.<Phone>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                    instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(11);
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(12);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(13) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(13);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                Role instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(Role);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(14) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (Role)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                            {
                                return 
                                {
                                    Role instance;
                                    instance = new Role();
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(14);
                                    instance.<RoleName>k__BackingField = dataReader.GetString(15);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Role)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            entity = 
            {
                MaterializationContext materializationContext3;
                IEntityType entityType3;
                Userprofile instance3;
                InternalEntityEntry entry3;
                bool hasNullKey3;
                materializationContext3 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance3 = default(Userprofile);
                entry3 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Userprofile.UserprofileId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(16) ? default(object) : (object)dataReader.GetInt32(16) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey3);
                !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
                {
                    entityType3 = entry3.EntityType;
                    return instance3 = (Userprofile)entry3.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot3;
                    shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType3 = [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")];
                    instance3 = switch (entityType3)
                    {
                        case [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]: 
                            {
                                return 
                                {
                                    Userprofile instance;
                                    instance = new Userprofile();
                                    instance.<UserprofileId>k__BackingField = dataReader.IsDBNull(16) ? default(int) : dataReader.GetInt32(16);
                                    instance.<Address>k__BackingField = dataReader.IsDBNull(17) ? default(string) : dataReader.GetString(17);
                                    instance.<Birth>k__BackingField = dataReader.IsDBNull(18) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(18);
                                    instance.<UserId>k__BackingField = dataReader.IsDBNull(19) ? default(int) : dataReader.GetInt32(19);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext3.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Userprofile | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Userprofile)
                    }
                    ;
                    entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType3, 
                        entity: instance3, 
                        snapshot: shadowSnapshot3);
                    return instance3;
                } : default(void);
                return instance3;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
                fixup: (namelessParameter{11}, namelessParameter{12}) => 
                {
                    namelessParameter{11}.<Role>k__BackingField = namelessParameter{12};
                    return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                        entity: namelessParameter{12}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                }, 
                trackingQuery: True);
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Userprofile>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Userprofile (Userprofile) ToDependent Userprofile Inverse: User | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Userprofile")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Userprofile.User (User) ToPrincipal User Inverse: Userprofile | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Userprofile").FindNavigation("User")], 
                fixup: (namelessParameter{16}, namelessParameter{17}) => 
                {
                    namelessParameter{16}.<Userprofile>k__BackingField = namelessParameter{17};
                    return namelessParameter{17}.<User>k__BackingField = namelessParameter{16};
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-05 14:02:22.676 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:02:22.677 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:02:22.678 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 14:02:22.679 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-05 14:02:22.680 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-05 14:02:22.681 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[userId] = @__userId_0
2025-05-05 14:02:22.687 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[userId] = @__userId_0
2025-05-05 14:02:22.690 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:02:22.691 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 1ms reading results.
2025-05-05 14:02:22.692 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:02:22.693 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (0ms).
2025-05-05 14:02:22.694 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-05 14:02:22.696 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-05 14:02:22.697 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-05 14:02:22.698 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-05 14:02:22.698 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-05 14:02:22.699 +07:00 [INF] Executing NotFoundObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-05 14:02:22.701 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument) in 150.5274ms
2025-05-05 14:02:22.702 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)'
2025-05-05 14:02:22.703 +07:00 [INF] HTTP PUT /api/Users/1 responded 404 in 177.0373 ms
2025-05-05 14:02:22.704 +07:00 [DBG] Connection id "0HNCBK4DNPUGS" completed keep alive response.
2025-05-05 14:02:22.705 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-05 14:02:22.706 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:02:22.707 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-05 14:02:22.708 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/1 - 404 null application/json; charset=utf-8 191.4953ms
2025-05-05 14:02:55.982 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/3 - application/json 86
2025-05-05 14:02:55.985 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/3'
2025-05-05 14:02:55.986 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/3'
2025-05-05 14:02:55.988 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)'
2025-05-05 14:02:55.989 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 14:02:55.990 +07:00 [DBG] Successfully validated the token.
2025-05-05 14:02:55.991 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-05 14:02:56.010 +07:00 [DBG] Authorization was successful.
2025-05-05 14:02:56.012 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)'
2025-05-05 14:02:56.015 +07:00 [INF] Route matched with {action = "Update", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Int32, ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-05 14:02:56.018 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-05 14:02:56.020 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-05 14:02:56.021 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-05 14:02:56.024 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-05 14:02:56.025 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-05 14:02:56.026 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-05 14:02:56.028 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-05 14:02:56.029 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-05 14:02:56.030 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-05 14:02:56.032 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-05 14:02:56.033 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-05 14:02:56.034 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-05 14:02:56.035 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-05 14:02:56.036 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO' ...
2025-05-05 14:02:56.037 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO' using the name '' in request data ...
2025-05-05 14:02:56.039 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-05 14:02:56.040 +07:00 [DBG] Connection id "0HNCBK4DNPUGS", Request id "0HNCBK4DNPUGS:00000007": started reading request body.
2025-05-05 14:02:56.040 +07:00 [DBG] Connection id "0HNCBK4DNPUGS", Request id "0HNCBK4DNPUGS:00000007": done reading request body.
2025-05-05 14:02:56.041 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'
2025-05-05 14:02:56.042 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'.
2025-05-05 14:02:56.043 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'.
2025-05-05 14:02:56.044 +07:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO' ...
2025-05-05 14:02:56.045 +07:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'.
2025-05-05 14:02:56.046 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-05 14:02:56.048 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-05 14:02:56.049 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-05 14:02:56.049 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-05 14:02:56.050 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-05 14:02:56.051 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-05 14:02:56.053 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument) in 26.4665ms
2025-05-05 14:02:56.054 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)'
2025-05-05 14:02:56.055 +07:00 [INF] HTTP PUT /api/Users/3 responded 400 in 65.9396 ms
2025-05-05 14:02:56.056 +07:00 [DBG] Connection id "0HNCBK4DNPUGS" completed keep alive response.
2025-05-05 14:02:56.057 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/3 - 400 null application/json; charset=utf-8 74.8426ms
2025-05-05 14:03:50.104 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5120/api/Users/1 - application/json 86
2025-05-05 14:03:50.108 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1'
2025-05-05 14:03:50.109 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)' with route pattern 'api/Users/{userId}' is valid for the request path '/api/Users/1'
2025-05-05 14:03:50.111 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)'
2025-05-05 14:03:50.113 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 14:03:50.114 +07:00 [DBG] Successfully validated the token.
2025-05-05 14:03:50.115 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-05 14:03:50.118 +07:00 [DBG] Authorization was successful.
2025-05-05 14:03:50.119 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)'
2025-05-05 14:03:50.121 +07:00 [INF] Route matched with {action = "Update", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Int32, ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO) on controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument).
2025-05-05 14:03:50.124 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-05 14:03:50.125 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-05 14:03:50.126 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-05 14:03:50.128 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-05 14:03:50.130 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-05 14:03:50.133 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-05 14:03:50.135 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.UsersController (ExchangeDocument)
2025-05-05 14:03:50.137 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' ...
2025-05-05 14:03:50.138 +07:00 [DBG] Attempting to bind parameter 'userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-05-05 14:03:50.140 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-05 14:03:50.141 +07:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.Int32'.
2025-05-05 14:03:50.142 +07:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.Int32' ...
2025-05-05 14:03:50.143 +07:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.Int32'.
2025-05-05 14:03:50.143 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO' ...
2025-05-05 14:03:50.145 +07:00 [DBG] Attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO' using the name '' in request data ...
2025-05-05 14:03:50.147 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-05 14:03:50.148 +07:00 [DBG] Connection id "0HNCBK4DNPUGS", Request id "0HNCBK4DNPUGS:00000008": started reading request body.
2025-05-05 14:03:50.149 +07:00 [DBG] Connection id "0HNCBK4DNPUGS", Request id "0HNCBK4DNPUGS:00000008": done reading request body.
2025-05-05 14:03:50.151 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'
2025-05-05 14:03:50.152 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'.
2025-05-05 14:03:50.153 +07:00 [DBG] Done attempting to bind parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'.
2025-05-05 14:03:50.154 +07:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO' ...
2025-05-05 14:03:50.155 +07:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'ExchangeDocument.BusinessLayer.DTOs.AdminUpdateUserDTO'.
2025-05-05 14:03:50.157 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-05 14:03:50.159 +07:00 [DBG] Creating DbConnection.
2025-05-05 14:03:50.159 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-05 14:03:50.161 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:03:50.162 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:03:50.164 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 14:03:50.165 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-05 14:03:50.166 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-05 14:03:50.167 +07:00 [DBG] Executing DbCommand [Parameters=[@__roleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [roles] AS [r]
        WHERE [r].[roleId] = @__roleId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-05 14:03:50.171 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__roleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [roles] AS [r]
        WHERE [r].[roleId] = @__roleId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-05 14:03:50.173 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:03:50.174 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 1ms reading results.
2025-05-05 14:03:50.175 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:03:50.176 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (0ms).
2025-05-05 14:03:50.179 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:03:50.180 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:03:50.181 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 14:03:50.182 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-05 14:03:50.183 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-05 14:03:50.185 +07:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[userId] = @__userId_0
2025-05-05 14:03:50.190 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName], [u0].[userprofileId], [u0].[address], [u0].[birth], [u0].[userId]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
LEFT JOIN [userprofiles] AS [u0] ON [u].[userId] = [u0].[userId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[userId] = @__userId_0
2025-05-05 14:03:50.192 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 14:03:50.194 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 14:03:50.196 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 14:03:50.199 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:03:50.201 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 8ms reading results.
2025-05-05 14:03:50.202 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:03:50.203 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-05 14:03:50.206 +07:00 [DBG] SaveChanges starting for 'ExchangeDocumentContext'.
2025-05-05 14:03:50.209 +07:00 [DBG] DetectChanges starting for 'ExchangeDocumentContext'.
2025-05-05 14:03:50.219 +07:00 [DBG] The unchanged property 'User.FullName' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-05 14:03:50.224 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 14:03:50.229 +07:00 [DBG] The unchanged property 'User.IsLocked' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-05 14:03:50.232 +07:00 [DBG] The unchanged property 'User.Phone' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-05 14:03:50.234 +07:00 [DBG] The unchanged property 'User.UpdatedAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-05 14:03:50.238 +07:00 [DBG] DetectChanges completed for 'ExchangeDocumentContext'.
2025-05-05 14:03:50.269 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:03:50.271 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:03:50.273 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 14:03:50.274 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-05 14:03:50.276 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-05 14:03:50.277 +07:00 [DBG] Executing DbCommand [Parameters=[@p4='?' (DbType = Int32), @p0='?' (Size = 255), @p1='?' (DbType = Boolean), @p2='?' (Size = 20), @p3='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [users] SET [fullName] = @p0, [IsLocked] = @p1, [phone] = @p2, [UpdatedAt] = @p3
OUTPUT 1
WHERE [userId] = @p4;
2025-05-05 14:03:50.283 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@p4='?' (DbType = Int32), @p0='?' (Size = 255), @p1='?' (DbType = Boolean), @p2='?' (Size = 20), @p3='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [users] SET [fullName] = @p0, [IsLocked] = @p1, [phone] = @p2, [UpdatedAt] = @p3
OUTPUT 1
WHERE [userId] = @p4;
2025-05-05 14:03:50.289 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:03:50.290 +07:00 [DBG] A data reader for 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' is being disposed after spending 4ms reading results.
2025-05-05 14:03:50.292 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:03:50.294 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER' (1ms).
2025-05-05 14:03:50.299 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 14:03:50.302 +07:00 [DBG] SaveChanges completed for 'ExchangeDocumentContext' with 1 entities written to the database.
2025-05-05 14:03:50.304 +07:00 [INF] Admin 3 updated user 1: RoleId=2, IsLocked=true
2025-05-05 14:03:50.305 +07:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-05-05 14:03:50.306 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument) in 173.7178ms
2025-05-05 14:03:50.308 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.UsersController.Update (ExchangeDocument)'
2025-05-05 14:03:50.309 +07:00 [INF] HTTP PUT /api/Users/1 responded 204 in 196.2119 ms
2025-05-05 14:03:50.310 +07:00 [DBG] Connection id "0HNCBK4DNPUGS" completed keep alive response.
2025-05-05 14:03:50.312 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-05 14:03:50.314 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 14:03:50.315 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-05 14:03:50.316 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5120/api/Users/1 - 204 null null 212.6811ms
2025-05-05 14:06:00.627 +07:00 [DBG] Connection id "0HNCBK4DNPUGS" disconnecting.
2025-05-05 14:06:00.630 +07:00 [DBG] Connection id "0HNCBK4DNPUGS" stopped.
2025-05-05 14:06:00.631 +07:00 [DBG] Connection id "0HNCBK4DNPUGS" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-05 14:35:08.224 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-05-05 14:35:08.311 +07:00 [DBG] Hosting starting
2025-05-05 14:35:08.326 +07:00 [INF] User profile is available. Using 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-05 14:35:08.339 +07:00 [DBG] Reading data from file 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys\key-1a51a872-ea43-4350-815f-0422835a65dd.xml'.
2025-05-05 14:35:08.349 +07:00 [DBG] Found key {1a51a872-ea43-4350-815f-0422835a65dd}.
2025-05-05 14:35:08.360 +07:00 [DBG] Considering key {1a51a872-ea43-4350-815f-0422835a65dd} with expiration date 2025-07-05 19:31:04Z as default key.
2025-05-05 14:35:08.366 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-05 14:35:08.373 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-05-05 14:35:08.376 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-05 14:35:08.385 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-05-05 14:35:08.390 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-05-05 14:35:08.393 +07:00 [DBG] Using key {1a51a872-ea43-4350-815f-0422835a65dd} as the default key.
2025-05-05 14:35:08.396 +07:00 [DBG] Key ring with default key {1a51a872-ea43-4350-815f-0422835a65dd} was loaded during application startup.
2025-05-05 14:35:08.447 +07:00 [INF] Now listening on: http://localhost:5120
2025-05-05 14:35:08.449 +07:00 [DBG] Loaded hosting startup assembly ExchangeDocument
2025-05-05 14:35:08.450 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-05 14:35:08.451 +07:00 [INF] Hosting environment: Development
2025-05-05 14:35:08.452 +07:00 [INF] Content root path: D:\Gộp module Auth\ExchangeDocument(Tự làm Auth_User) - Đã xong 12 API của Module Auth_User\ExchangeDocument
2025-05-05 14:35:08.453 +07:00 [DBG] Hosting started
2025-05-05 14:35:24.252 +07:00 [DBG] Connection id "0HNCBKTIV0B12" accepted.
2025-05-05 14:35:24.255 +07:00 [DBG] Connection id "0HNCBKTIV0B12" started.
2025-05-05 14:35:24.255 +07:00 [DBG] Connection id "0HNCBKTIV0B13" accepted.
2025-05-05 14:35:24.259 +07:00 [DBG] Connection id "0HNCBKTIV0B13" started.
2025-05-05 14:35:24.285 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/index.html - null null
2025-05-05 14:35:24.293 +07:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-05-05 14:35:24.308 +07:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-05-05 14:35:24.310 +07:00 [DBG] Request did not match any endpoints
2025-05-05 14:35:24.383 +07:00 [INF] HTTP GET /swagger/index.html responded 200 in 69.5172 ms
2025-05-05 14:35:24.388 +07:00 [DBG] Connection id "0HNCBKTIV0B12" completed keep alive response.
2025-05-05 14:35:24.392 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/index.html - 200 null text/html;charset=utf-8 108.8224ms
2025-05-05 14:35:25.165 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - null null
2025-05-05 14:35:25.170 +07:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-05-05 14:35:25.172 +07:00 [DBG] Request did not match any endpoints
2025-05-05 14:35:25.331 +07:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 157.9600 ms
2025-05-05 14:35:25.334 +07:00 [DBG] Connection id "0HNCBKTIV0B12" completed keep alive response.
2025-05-05 14:35:25.337 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 171.3318ms
2025-05-05 14:35:53.704 +07:00 [DBG] Connection id "0HNCBKTIV0B13" received FIN.
2025-05-05 14:35:53.704 +07:00 [DBG] Connection id "0HNCBKTIV0B12" received FIN.
2025-05-05 14:35:53.707 +07:00 [DBG] Connection id "0HNCBKTIV0B12" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-05 14:35:53.707 +07:00 [DBG] Connection id "0HNCBKTIV0B13" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-05 14:35:53.709 +07:00 [DBG] Connection id "0HNCBKTIV0B12" disconnecting.
2025-05-05 14:35:53.710 +07:00 [DBG] Connection id "0HNCBKTIV0B13" disconnecting.
2025-05-05 14:35:53.713 +07:00 [DBG] Connection id "0HNCBKTIV0B13" stopped.
2025-05-05 14:35:53.713 +07:00 [DBG] Connection id "0HNCBKTIV0B12" stopped.
2025-05-05 14:36:29.619 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-05-05 14:36:29.705 +07:00 [DBG] Hosting starting
2025-05-05 14:36:29.718 +07:00 [INF] User profile is available. Using 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-05 14:36:29.731 +07:00 [DBG] Reading data from file 'C:\Users\KHOA\AppData\Local\ASP.NET\DataProtection-Keys\key-1a51a872-ea43-4350-815f-0422835a65dd.xml'.
2025-05-05 14:36:29.737 +07:00 [DBG] Found key {1a51a872-ea43-4350-815f-0422835a65dd}.
2025-05-05 14:36:29.745 +07:00 [DBG] Considering key {1a51a872-ea43-4350-815f-0422835a65dd} with expiration date 2025-07-05 19:31:04Z as default key.
2025-05-05 14:36:29.748 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-05 14:36:29.751 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-05-05 14:36:29.754 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-05 14:36:29.759 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-05-05 14:36:29.761 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-05-05 14:36:29.763 +07:00 [DBG] Using key {1a51a872-ea43-4350-815f-0422835a65dd} as the default key.
2025-05-05 14:36:29.765 +07:00 [DBG] Key ring with default key {1a51a872-ea43-4350-815f-0422835a65dd} was loaded during application startup.
2025-05-05 14:36:29.802 +07:00 [INF] Now listening on: http://localhost:5120
2025-05-05 14:36:29.806 +07:00 [DBG] Loaded hosting startup assembly ExchangeDocument
2025-05-05 14:36:29.807 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-05 14:36:29.807 +07:00 [INF] Hosting environment: Development
2025-05-05 14:36:29.808 +07:00 [INF] Content root path: D:\Gộp module Auth\ExchangeDocument(Tự làm Auth_User) - Đã xong 12 API của Module Auth_User\ExchangeDocument
2025-05-05 14:36:29.809 +07:00 [DBG] Hosting started
2025-05-05 14:36:36.186 +07:00 [INF] Application is shutting down...
2025-05-05 14:36:36.187 +07:00 [DBG] Hosting stopping
2025-05-05 14:36:36.195 +07:00 [DBG] Hosting stopped
2025-05-05 14:50:15.333 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-05-05 14:50:15.458 +07:00 [DBG] Hosting starting
2025-05-05 14:50:15.511 +07:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-05 14:50:15.524 +07:00 [DBG] Reading data from file 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys\key-8e54759c-7598-473f-bbce-4776bafbcb5b.xml'.
2025-05-05 14:50:15.559 +07:00 [DBG] Found key {8e54759c-7598-473f-bbce-4776bafbcb5b}.
2025-05-05 14:50:15.574 +07:00 [DBG] Considering key {8e54759c-7598-473f-bbce-4776bafbcb5b} with expiration date 2025-05-30 02:50:26Z as default key.
2025-05-05 14:50:15.580 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-05 14:50:15.582 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-05-05 14:50:15.585 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-05 14:50:15.590 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-05-05 14:50:15.592 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-05-05 14:50:15.594 +07:00 [DBG] Using key {8e54759c-7598-473f-bbce-4776bafbcb5b} as the default key.
2025-05-05 14:50:15.596 +07:00 [DBG] Key ring with default key {8e54759c-7598-473f-bbce-4776bafbcb5b} was loaded during application startup.
2025-05-05 14:50:15.888 +07:00 [INF] Now listening on: https://localhost:7011
2025-05-05 14:50:15.890 +07:00 [INF] Now listening on: http://localhost:5120
2025-05-05 14:50:15.891 +07:00 [DBG] Loaded hosting startup assembly ExchangeDocument
2025-05-05 14:50:15.891 +07:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-05-05 14:50:15.892 +07:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-05-05 14:50:15.892 +07:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-05-05 14:50:15.913 +07:00 [DBG] Connection id "0HNCBL5SMHI3O" accepted.
2025-05-05 14:50:15.914 +07:00 [DBG] Connection id "0HNCBL5SMHI3O" started.
2025-05-05 14:50:15.919 +07:00 [DBG] Connection id "0HNCBL5SMHI3P" accepted.
2025-05-05 14:50:15.920 +07:00 [DBG] Connection id "0HNCBL5SMHI3P" started.
2025-05-05 14:50:15.953 +07:00 [DBG] Connection id "0HNCBL5SMHI3P" received FIN.
2025-05-05 14:50:15.953 +07:00 [DBG] Connection id "0HNCBL5SMHI3O" received FIN.
2025-05-05 14:50:15.968 +07:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-05-05 14:50:15.968 +07:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-05-05 14:50:16.016 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-05 14:50:16.018 +07:00 [INF] Hosting environment: Development
2025-05-05 14:50:16.025 +07:00 [INF] Content root path: D:\Dowload\ExchangeDocument(Tự làm Auth_User)\ExchangeDocument(Tự làm Auth_User) - Đã xong API của Module Auth_User(13)\ExchangeDocument
2025-05-05 14:50:16.026 +07:00 [DBG] Connection id "0HNCBL5SMHI3P" stopped.
2025-05-05 14:50:16.026 +07:00 [DBG] Connection id "0HNCBL5SMHI3O" stopped.
2025-05-05 14:50:16.027 +07:00 [DBG] Hosting started
2025-05-05 14:50:16.030 +07:00 [DBG] Connection id "0HNCBL5SMHI3O" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-05 14:50:16.030 +07:00 [DBG] Connection id "0HNCBL5SMHI3P" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-05 14:50:17.247 +07:00 [DBG] Connection id "0HNCBL5SMHI3Q" accepted.
2025-05-05 14:50:17.249 +07:00 [DBG] Connection id "0HNCBL5SMHI3Q" started.
2025-05-05 14:50:17.250 +07:00 [DBG] Connection id "0HNCBL5SMHI3R" accepted.
2025-05-05 14:50:17.252 +07:00 [DBG] Connection id "0HNCBL5SMHI3R" started.
2025-05-05 14:50:17.282 +07:00 [DBG] Connection id "0HNCBL5SMHI3Q" received FIN.
2025-05-05 14:50:17.293 +07:00 [DBG] Connection 0HNCBL5SMHI3R established using the following protocol: "Tls13"
2025-05-05 14:50:17.293 +07:00 [DBG] Connection 0HNCBL5SMHI3Q established using the following protocol: "Tls13"
2025-05-05 14:50:17.334 +07:00 [DBG] Connection id "0HNCBL5SMHI3Q" is closed. The last processed stream ID was 0.
2025-05-05 14:50:17.338 +07:00 [DBG] Connection id "0HNCBL5SMHI3Q" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-05 14:50:17.345 +07:00 [DBG] The connection queue processing loop for 0HNCBL5SMHI3Q completed.
2025-05-05 14:50:17.348 +07:00 [DBG] Connection id "0HNCBL5SMHI3Q" stopped.
2025-05-05 14:50:17.388 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7011/swagger - null null
2025-05-05 14:50:17.553 +07:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-05-05 14:50:17.589 +07:00 [DBG] No candidates found for the request path '/swagger'
2025-05-05 14:50:17.592 +07:00 [DBG] Request did not match any endpoints
2025-05-05 14:50:17.601 +07:00 [INF] HTTP GET /swagger responded 301 in 4.8423 ms
2025-05-05 14:50:17.622 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7011/swagger - 301 0 null 247.4731ms
2025-05-05 14:50:17.630 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7011/swagger/index.html - null null
2025-05-05 14:50:17.644 +07:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-05-05 14:50:17.646 +07:00 [DBG] Request did not match any endpoints
2025-05-05 14:50:17.707 +07:00 [DBG] Response markup is scheduled to include Browser Link script injection.
2025-05-05 14:50:17.709 +07:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2025-05-05 14:50:17.721 +07:00 [INF] HTTP GET /swagger/index.html responded 200 in 67.4622 ms
2025-05-05 14:50:17.723 +07:00 [DBG] Response markup was updated to include Browser Link script injection.
2025-05-05 14:50:17.724 +07:00 [DBG] Response markup was updated to include browser refresh script injection.
2025-05-05 14:50:17.725 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7011/swagger/index.html - 200 null text/html;charset=utf-8 96.353ms
2025-05-05 14:50:17.730 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7011/swagger/swagger-ui.css - null null
2025-05-05 14:50:17.730 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7011/swagger/swagger-ui-bundle.js - null null
2025-05-05 14:50:17.731 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7011/_framework/aspnetcore-browser-refresh.js - null null
2025-05-05 14:50:17.741 +07:00 [DBG] No candidates found for the request path '/swagger/swagger-ui-bundle.js'
2025-05-05 14:50:17.730 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7011/swagger/swagger-ui-standalone-preset.js - null null
2025-05-05 14:50:17.748 +07:00 [DBG] Request did not match any endpoints
2025-05-05 14:50:17.750 +07:00 [DBG] No candidates found for the request path '/swagger/swagger-ui-standalone-preset.js'
2025-05-05 14:50:17.739 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7011/_vs/browserLink - null null
2025-05-05 14:50:17.733 +07:00 [DBG] No candidates found for the request path '/swagger/swagger-ui.css'
2025-05-05 14:50:17.757 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7011/_framework/aspnetcore-browser-refresh.js - 200 13768 application/javascript; charset=utf-8 26.8487ms
2025-05-05 14:50:17.758 +07:00 [DBG] Request did not match any endpoints
2025-05-05 14:50:17.761 +07:00 [DBG] Request did not match any endpoints
2025-05-05 14:50:17.786 +07:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-05-05 14:50:17.786 +07:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2025-05-05 14:50:17.790 +07:00 [INF] HTTP GET /swagger/swagger-ui-standalone-preset.js responded 200 in 25.8604 ms
2025-05-05 14:50:17.790 +07:00 [INF] HTTP GET /swagger/swagger-ui.css responded 200 in 22.6881 ms
2025-05-05 14:50:17.793 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7011/swagger/swagger-ui-standalone-preset.js - 200 230280 text/javascript 62.4579ms
2025-05-05 14:50:17.794 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7011/swagger/swagger-ui.css - 200 152034 text/css 64.1657ms
2025-05-05 14:50:17.830 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7011/_vs/browserLink - 200 null text/javascript; charset=UTF-8 91.7515ms
2025-05-05 14:50:17.851 +07:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-05-05 14:50:17.853 +07:00 [INF] HTTP GET /swagger/swagger-ui-bundle.js responded 200 in 96.0090 ms
2025-05-05 14:50:17.855 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7011/swagger/swagger-ui-bundle.js - 200 1456926 text/javascript 124.6723ms
2025-05-05 14:50:18.263 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7011/swagger/v1/swagger.json - null null
2025-05-05 14:50:18.266 +07:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-05-05 14:50:18.267 +07:00 [DBG] Request did not match any endpoints
2025-05-05 14:50:18.292 +07:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 24.8964 ms
2025-05-05 14:50:18.294 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7011/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 31.045ms
2025-05-05 14:50:18.327 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7011/swagger/favicon-32x32.png - null null
2025-05-05 14:50:18.330 +07:00 [DBG] No candidates found for the request path '/swagger/favicon-32x32.png'
2025-05-05 14:50:18.332 +07:00 [DBG] Request did not match any endpoints
2025-05-05 14:50:18.334 +07:00 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2025-05-05 14:50:18.336 +07:00 [INF] HTTP GET /swagger/favicon-32x32.png responded 200 in 2.4079 ms
2025-05-05 14:50:18.338 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7011/swagger/favicon-32x32.png - 200 628 image/png 12.2935ms
2025-05-05 14:50:20.842 +07:00 [DBG] Connection id "0HNCBL5SMHI3R" received FIN.
2025-05-05 14:50:20.844 +07:00 [DBG] Connection id "0HNCBL5SMHI3R" is closed. The last processed stream ID was 17.
2025-05-05 14:50:20.844 +07:00 [DBG] The connection queue processing loop for 0HNCBL5SMHI3R completed.
2025-05-05 14:50:20.845 +07:00 [DBG] Connection id "0HNCBL5SMHI3R" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-05 14:50:20.860 +07:00 [DBG] Connection id "0HNCBL5SMHI3R" stopped.
2025-05-05 15:04:00.227 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-05-05 15:04:00.594 +07:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'Order'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 15:04:00.597 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'OrderDetail'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 15:04:00.598 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'Review'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 15:04:00.599 +07:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'Userprofile'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 15:04:00.685 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-05 15:04:00.804 +07:00 [DBG] Creating DbConnection.
2025-05-05 15:04:00.837 +07:00 [DBG] Created DbConnection. (31ms).
2025-05-05 15:04:00.841 +07:00 [DBG] Migrating using database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 15:04:00.847 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 15:04:17.578 +07:00 [DBG] An error occurred using the connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 15:04:17.594 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-05 15:04:17.598 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'DESKTOP-6HCA7KG\KHOA_SQLSERVER'.
2025-05-05 15:04:17.602 +07:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-05-05 15:09:37.050 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-05-05 15:09:37.391 +07:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'Order'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 15:09:37.394 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'OrderDetail'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 15:09:37.395 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'Review'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 15:09:37.396 +07:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'Userprofile'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 15:09:37.504 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-05 15:09:37.620 +07:00 [DBG] Creating DbConnection.
2025-05-05 15:09:37.640 +07:00 [DBG] Created DbConnection. (18ms).
2025-05-05 15:09:37.643 +07:00 [DBG] Migrating using database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:09:37.647 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:09:37.773 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:09:37.777 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:37.783 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (4ms).
2025-05-05 15:09:37.786 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (9ms).
2025-05-05 15:09:37.791 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-05 15:09:37.809 +07:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-05 15:09:37.812 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:09:37.818 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'MINHKHAI' (3ms).
2025-05-05 15:09:37.819 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:09:37.820 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:09:37.822 +07:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-05-05 15:09:37.824 +07:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-05-05 15:09:37.825 +07:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-05-05 15:09:37.826 +07:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-05-05 15:09:37.827 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-05-05 15:09:37.868 +07:00 [INF] Executed DbCommand (42ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-05-05 15:09:37.906 +07:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-05-05 15:09:37.911 +07:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-05-05 15:09:37.912 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:37.913 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:37.914 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-05-05 15:09:37.915 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-05-05 15:09:37.931 +07:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-05-05 15:09:37.935 +07:00 [DBG] Committing transaction.
2025-05-05 15:09:37.937 +07:00 [DBG] Committed transaction.
2025-05-05 15:09:37.939 +07:00 [DBG] Disposing transaction.
2025-05-05 15:09:37.941 +07:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-05-05 15:09:37.942 +07:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-05-05 15:09:37.943 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:37.944 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:37.944 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:37.945 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-05 15:09:37.947 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-05 15:09:37.948 +07:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-05-05 15:09:37.949 +07:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-05-05 15:09:37.950 +07:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-05-05 15:09:37.951 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-05 15:09:37.952 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-05 15:09:37.954 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 15:09:37.955 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-05 15:09:37.956 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-05 15:09:37.957 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-05 15:09:37.966 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-05 15:09:37.968 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:09:37.970 +07:00 [DBG] A data reader for 'exchangedocument' on server 'MINHKHAI' is being disposed after spending 2ms reading results.
2025-05-05 15:09:37.976 +07:00 [INF] Applying migration '20250426072331_InitialCreate'.
2025-05-05 15:09:37.985 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:37.986 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:37.987 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:37.988 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250426072331_InitialCreate', N'9.0.4');
2025-05-05 15:09:37.992 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250426072331_InitialCreate', N'9.0.4');
2025-05-05 15:09:37.994 +07:00 [INF] Applying migration '20250426072701_DocumentDefaultsAndNullablePrice'.
2025-05-05 15:09:38.000 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:38.001 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:38.002 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:38.003 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250426072701_DocumentDefaultsAndNullablePrice', N'9.0.4');
2025-05-05 15:09:38.004 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250426072701_DocumentDefaultsAndNullablePrice', N'9.0.4');
2025-05-05 15:09:38.006 +07:00 [INF] Applying migration '20250427153539_ForceSchemaSync'.
2025-05-05 15:09:38.012 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:38.013 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:38.014 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:38.015 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250427153539_ForceSchemaSync', N'9.0.4');
2025-05-05 15:09:38.017 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250427153539_ForceSchemaSync', N'9.0.4');
2025-05-05 15:09:38.018 +07:00 [INF] Applying migration '20250427200250_AddSoftDeleteToDocument'.
2025-05-05 15:09:38.031 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:38.032 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:38.033 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:38.034 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [document] ADD [DeletedAt] datetime2 NULL;
2025-05-05 15:09:38.049 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [document] ADD [DeletedAt] datetime2 NULL;
2025-05-05 15:09:38.050 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:38.051 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:38.052 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:38.053 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [document] ADD [IsDeleted] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-05 15:09:38.058 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [document] ADD [IsDeleted] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-05 15:09:38.059 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:38.060 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:38.061 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:38.062 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250427200250_AddSoftDeleteToDocument', N'9.0.4');
2025-05-05 15:09:38.063 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250427200250_AddSoftDeleteToDocument', N'9.0.4');
2025-05-05 15:09:38.065 +07:00 [INF] Applying migration '20250429080236_SplitStatusToDocumentStatus'.
2025-05-05 15:09:38.088 +07:00 [DBG] Executing 5 update commands as a batch.
2025-05-05 15:09:38.094 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:38.095 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:38.096 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:38.097 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var sysname;
SELECT @var = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[document]') AND [c].[name] = N'status');
IF @var IS NOT NULL EXEC(N'ALTER TABLE [document] DROP CONSTRAINT [' + @var + '];');
ALTER TABLE [document] DROP COLUMN [status];
2025-05-05 15:09:38.172 +07:00 [INF] Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var sysname;
SELECT @var = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[document]') AND [c].[name] = N'status');
IF @var IS NOT NULL EXEC(N'ALTER TABLE [document] DROP CONSTRAINT [' + @var + '];');
ALTER TABLE [document] DROP COLUMN [status];
2025-05-05 15:09:38.174 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:38.175 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:38.176 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:38.177 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [document] ADD [statusId] int NOT NULL DEFAULT 1;
2025-05-05 15:09:38.179 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [document] ADD [statusId] int NOT NULL DEFAULT 1;
2025-05-05 15:09:38.180 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:38.181 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:38.182 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:38.183 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [documentStatus] (
    [documentStatusId] int NOT NULL IDENTITY,
    [statusCode] nvarchar(50) NOT NULL,
    [statusName] nvarchar(50) NOT NULL,
    CONSTRAINT [PK_DocumentStatus] PRIMARY KEY ([documentStatusId])
);
2025-05-05 15:09:38.186 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [documentStatus] (
    [documentStatusId] int NOT NULL IDENTITY,
    [statusCode] nvarchar(50) NOT NULL,
    [statusName] nvarchar(50) NOT NULL,
    CONSTRAINT [PK_DocumentStatus] PRIMARY KEY ([documentStatusId])
);
2025-05-05 15:09:38.187 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:38.188 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:38.189 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:38.190 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'documentStatusId', N'statusCode', N'statusName') AND [object_id] = OBJECT_ID(N'[documentStatus]'))
    SET IDENTITY_INSERT [documentStatus] ON;
INSERT INTO [documentStatus] ([documentStatusId], [statusCode], [statusName])
VALUES (1, N'InStock', N'In Stock'),
(2, N'Listed', N'Listed'),
(3, N'PendingSale', N'Pending Sale'),
(4, N'Sold', N'Sold'),
(5, N'Cancelled', N'Cancelled');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'documentStatusId', N'statusCode', N'statusName') AND [object_id] = OBJECT_ID(N'[documentStatus]'))
    SET IDENTITY_INSERT [documentStatus] OFF;
2025-05-05 15:09:38.207 +07:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'documentStatusId', N'statusCode', N'statusName') AND [object_id] = OBJECT_ID(N'[documentStatus]'))
    SET IDENTITY_INSERT [documentStatus] ON;
INSERT INTO [documentStatus] ([documentStatusId], [statusCode], [statusName])
VALUES (1, N'InStock', N'In Stock'),
(2, N'Listed', N'Listed'),
(3, N'PendingSale', N'Pending Sale'),
(4, N'Sold', N'Sold'),
(5, N'Cancelled', N'Cancelled');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'documentStatusId', N'statusCode', N'statusName') AND [object_id] = OBJECT_ID(N'[documentStatus]'))
    SET IDENTITY_INSERT [documentStatus] OFF;
2025-05-05 15:09:38.209 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:38.210 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:38.211 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:38.212 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_document_statusId] ON [document] ([statusId]);
2025-05-05 15:09:38.216 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_document_statusId] ON [document] ([statusId]);
2025-05-05 15:09:38.219 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:38.219 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:38.220 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:38.221 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [document] ADD CONSTRAINT [FK_Document_DocumentStatus] FOREIGN KEY ([statusId]) REFERENCES [documentStatus] ([documentStatusId]);
2025-05-05 15:09:38.224 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [document] ADD CONSTRAINT [FK_Document_DocumentStatus] FOREIGN KEY ([statusId]) REFERENCES [documentStatus] ([documentStatusId]);
2025-05-05 15:09:38.226 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:38.227 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:38.227 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:38.228 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250429080236_SplitStatusToDocumentStatus', N'9.0.4');
2025-05-05 15:09:38.230 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250429080236_SplitStatusToDocumentStatus', N'9.0.4');
2025-05-05 15:09:38.232 +07:00 [INF] Applying migration '20250502043203_AddAuthFieldsToUser'.
2025-05-05 15:09:38.246 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:38.247 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:38.248 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:38.249 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [users] ADD [CreatedAt] datetime2 NOT NULL DEFAULT '0001-01-01T00:00:00.0000000';
2025-05-05 15:09:38.263 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [users] ADD [CreatedAt] datetime2 NOT NULL DEFAULT '0001-01-01T00:00:00.0000000';
2025-05-05 15:09:38.265 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:38.266 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:38.267 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-05-05 15:09:38.268 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [users] ADD [IsEmailVerified] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-05 15:09:38.272 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [users] ADD [IsEmailVerified] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-05 15:09:38.274 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:38.275 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:38.276 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-05-05 15:09:38.277 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [users] ADD [PasswordResetToken] nvarchar(max) NULL;
2025-05-05 15:09:38.281 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [users] ADD [PasswordResetToken] nvarchar(max) NULL;
2025-05-05 15:09:38.282 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:38.283 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:38.283 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:38.284 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [users] ADD [ResetTokenExpires] datetime2 NULL;
2025-05-05 15:09:38.286 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [users] ADD [ResetTokenExpires] datetime2 NULL;
2025-05-05 15:09:38.288 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:38.289 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:38.289 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:38.290 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [users] ADD [UpdatedAt] datetime2 NULL;
2025-05-05 15:09:38.292 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [users] ADD [UpdatedAt] datetime2 NULL;
2025-05-05 15:09:38.294 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:38.295 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:38.296 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:38.297 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250502043203_AddAuthFieldsToUser', N'9.0.4');
2025-05-05 15:09:38.298 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250502043203_AddAuthFieldsToUser', N'9.0.4');
2025-05-05 15:09:38.299 +07:00 [INF] Applying migration '20250504154247_SoftDeleteUser'.
2025-05-05 15:09:38.312 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:38.313 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:38.314 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:38.315 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [users] ADD [DeletedAt] datetime2 NULL;
2025-05-05 15:09:38.317 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [users] ADD [DeletedAt] datetime2 NULL;
2025-05-05 15:09:38.318 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:38.319 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:38.320 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:38.320 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [users] ADD [IsDeleted] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-05 15:09:38.324 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [users] ADD [IsDeleted] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-05 15:09:38.325 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:38.326 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:38.327 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:38.328 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250504154247_SoftDeleteUser', N'9.0.4');
2025-05-05 15:09:38.329 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250504154247_SoftDeleteUser', N'9.0.4');
2025-05-05 15:09:38.331 +07:00 [INF] Applying migration '20250505064844_AddIsLockedToUser'.
2025-05-05 15:09:38.341 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:38.342 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:38.343 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:38.344 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [users] ADD [IsLocked] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-05 15:09:38.350 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [users] ADD [IsLocked] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-05 15:09:38.352 +07:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-05-05 15:09:38.352 +07:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-05-05 15:09:38.353 +07:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-05-05 15:09:38.354 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250505064844_AddIsLockedToUser', N'9.0.4');
2025-05-05 15:09:38.356 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250505064844_AddIsLockedToUser', N'9.0.4');
2025-05-05 15:09:38.358 +07:00 [DBG] Committing transaction.
2025-05-05 15:09:38.360 +07:00 [DBG] Committed transaction.
2025-05-05 15:09:38.360 +07:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-05-05 15:09:38.362 +07:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-05-05 15:09:38.363 +07:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-05-05 15:09:38.364 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-05-05 15:09:38.369 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-05-05 15:09:38.371 +07:00 [DBG] Disposing transaction.
2025-05-05 15:09:38.371 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:09:38.372 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'MINHKHAI' (1ms).
2025-05-05 15:09:38.374 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-05 15:09:38.376 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:09:38.377 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-05 15:10:43.351 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-05-05 15:10:43.432 +07:00 [DBG] Hosting starting
2025-05-05 15:10:43.445 +07:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-05 15:10:43.454 +07:00 [DBG] Reading data from file 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys\key-8e54759c-7598-473f-bbce-4776bafbcb5b.xml'.
2025-05-05 15:10:43.467 +07:00 [DBG] Found key {8e54759c-7598-473f-bbce-4776bafbcb5b}.
2025-05-05 15:10:43.475 +07:00 [DBG] Considering key {8e54759c-7598-473f-bbce-4776bafbcb5b} with expiration date 2025-05-30 02:50:26Z as default key.
2025-05-05 15:10:43.478 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-05 15:10:43.481 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-05-05 15:10:43.483 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-05 15:10:43.487 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-05-05 15:10:43.489 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-05-05 15:10:43.491 +07:00 [DBG] Using key {8e54759c-7598-473f-bbce-4776bafbcb5b} as the default key.
2025-05-05 15:10:43.492 +07:00 [DBG] Key ring with default key {8e54759c-7598-473f-bbce-4776bafbcb5b} was loaded during application startup.
2025-05-05 15:10:43.535 +07:00 [INF] Now listening on: http://localhost:5120
2025-05-05 15:10:43.536 +07:00 [DBG] Loaded hosting startup assembly ExchangeDocument
2025-05-05 15:10:43.536 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-05 15:10:43.537 +07:00 [INF] Hosting environment: Development
2025-05-05 15:10:43.538 +07:00 [INF] Content root path: D:\Dowload\ExchangeDocument(Tự làm Auth_User)\ExchangeDocument(Tự làm Auth_User) - Đã xong API của Module Auth_User(13)\ExchangeDocument
2025-05-05 15:10:43.539 +07:00 [DBG] Hosting started
2025-05-05 15:10:53.405 +07:00 [DBG] Connection id "0HNCBLHDG6AHK" accepted.
2025-05-05 15:10:53.407 +07:00 [DBG] Connection id "0HNCBLHDG6AHK" started.
2025-05-05 15:10:53.411 +07:00 [DBG] Connection id "0HNCBLHDG6AHL" accepted.
2025-05-05 15:10:53.413 +07:00 [DBG] Connection id "0HNCBLHDG6AHL" started.
2025-05-05 15:10:53.440 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/ - null null
2025-05-05 15:10:53.446 +07:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-05-05 15:10:53.460 +07:00 [DBG] No candidates found for the request path '/'
2025-05-05 15:10:53.462 +07:00 [DBG] Request did not match any endpoints
2025-05-05 15:10:53.473 +07:00 [DBG] The request path  does not match the path filter
2025-05-05 15:10:53.474 +07:00 [WRN] Failed to determine the https port for redirect.
2025-05-05 15:10:53.502 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-05 15:10:53.506 +07:00 [INF] HTTP GET / responded 404 in 41.4224 ms
2025-05-05 15:10:53.512 +07:00 [DBG] Connection id "0HNCBLHDG6AHL" completed keep alive response.
2025-05-05 15:10:53.515 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/ - 404 0 null 75.7137ms
2025-05-05 15:10:53.520 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5120/, Response status code: 404
2025-05-05 15:11:18.118 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5120/ - null null
2025-05-05 15:11:18.120 +07:00 [DBG] No candidates found for the request path '/'
2025-05-05 15:11:18.122 +07:00 [DBG] Request did not match any endpoints
2025-05-05 15:11:18.124 +07:00 [DBG] The request path  does not match the path filter
2025-05-05 15:11:18.126 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-05 15:11:18.128 +07:00 [INF] HTTP GET / responded 404 in 5.5280 ms
2025-05-05 15:11:18.131 +07:00 [DBG] Connection id "0HNCBLHDG6AHL" completed keep alive response.
2025-05-05 15:11:18.138 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5120/ - 404 0 null 19.995ms
2025-05-05 15:11:18.143 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5120/, Response status code: 404
2025-05-05 15:13:04.641 +07:00 [DBG] Connection id "0HNCBLHDG6AHK" disconnecting.
2025-05-05 15:13:04.652 +07:00 [DBG] Connection id "0HNCBLHDG6AHK" stopped.
2025-05-05 15:13:04.656 +07:00 [DBG] Connection id "0HNCBLHDG6AHK" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-05 15:13:29.812 +07:00 [DBG] Connection id "0HNCBLHDG6AHL" disconnecting.
2025-05-05 15:13:29.813 +07:00 [DBG] Connection id "0HNCBLHDG6AHL" stopped.
2025-05-05 15:13:29.814 +07:00 [DBG] Connection id "0HNCBLHDG6AHL" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-05 15:14:41.536 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-05-05 15:14:41.612 +07:00 [DBG] Hosting starting
2025-05-05 15:14:41.623 +07:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-05 15:14:41.631 +07:00 [DBG] Reading data from file 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys\key-8e54759c-7598-473f-bbce-4776bafbcb5b.xml'.
2025-05-05 15:14:41.655 +07:00 [DBG] Found key {8e54759c-7598-473f-bbce-4776bafbcb5b}.
2025-05-05 15:14:41.664 +07:00 [DBG] Considering key {8e54759c-7598-473f-bbce-4776bafbcb5b} with expiration date 2025-05-30 02:50:26Z as default key.
2025-05-05 15:14:41.667 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-05 15:14:41.671 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-05-05 15:14:41.673 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-05 15:14:41.677 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-05-05 15:14:41.679 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-05-05 15:14:41.680 +07:00 [DBG] Using key {8e54759c-7598-473f-bbce-4776bafbcb5b} as the default key.
2025-05-05 15:14:41.682 +07:00 [DBG] Key ring with default key {8e54759c-7598-473f-bbce-4776bafbcb5b} was loaded during application startup.
2025-05-05 15:14:41.713 +07:00 [INF] Now listening on: http://localhost:5041
2025-05-05 15:14:41.714 +07:00 [DBG] Loaded hosting startup assembly ExchangeDocument
2025-05-05 15:14:41.716 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-05 15:14:41.717 +07:00 [INF] Hosting environment: Development
2025-05-05 15:14:41.718 +07:00 [INF] Content root path: D:\Dowload\ExchangeDocument(Tự làm Auth_User)\ExchangeDocument(Tự làm Auth_User) - Đã xong API của Module Auth_User(13)\ExchangeDocument
2025-05-05 15:14:41.721 +07:00 [DBG] Hosting started
2025-05-05 15:14:45.436 +07:00 [DBG] Connection id "0HNCBLJIL0HP0" accepted.
2025-05-05 15:14:45.438 +07:00 [DBG] Connection id "0HNCBLJIL0HP0" started.
2025-05-05 15:14:45.438 +07:00 [DBG] Connection id "0HNCBLJIL0HP1" accepted.
2025-05-05 15:14:45.440 +07:00 [DBG] Connection id "0HNCBLJIL0HP1" started.
2025-05-05 15:14:45.463 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5041/ - null null
2025-05-05 15:14:45.467 +07:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-05-05 15:14:45.479 +07:00 [DBG] No candidates found for the request path '/'
2025-05-05 15:14:45.480 +07:00 [DBG] Request did not match any endpoints
2025-05-05 15:14:45.493 +07:00 [DBG] The request path  does not match the path filter
2025-05-05 15:14:45.496 +07:00 [WRN] Failed to determine the https port for redirect.
2025-05-05 15:14:45.526 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-05 15:14:45.530 +07:00 [INF] HTTP GET / responded 404 in 46.7020 ms
2025-05-05 15:14:45.535 +07:00 [DBG] Connection id "0HNCBLJIL0HP0" completed keep alive response.
2025-05-05 15:14:45.537 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5041/ - 404 0 null 75.6082ms
2025-05-05 15:14:45.551 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5041/, Response status code: 404
2025-05-05 15:14:47.789 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5041/swagger/index.html - null null
2025-05-05 15:14:47.794 +07:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-05-05 15:14:47.795 +07:00 [DBG] Request did not match any endpoints
2025-05-05 15:14:47.856 +07:00 [INF] HTTP GET /swagger/index.html responded 200 in 57.2707 ms
2025-05-05 15:14:47.858 +07:00 [DBG] Connection id "0HNCBLJIL0HP0" completed keep alive response.
2025-05-05 15:14:47.860 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5041/swagger/index.html - 200 null text/html;charset=utf-8 70.111ms
2025-05-05 15:14:48.270 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5041/swagger/v1/swagger.json - null null
2025-05-05 15:14:48.274 +07:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-05-05 15:14:48.275 +07:00 [DBG] Request did not match any endpoints
2025-05-05 15:14:48.396 +07:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 119.7218 ms
2025-05-05 15:14:48.398 +07:00 [DBG] Connection id "0HNCBLJIL0HP0" completed keep alive response.
2025-05-05 15:14:48.398 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5041/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 127.9255ms
2025-05-05 15:16:18.847 +07:00 [DBG] Connection id "0HNCBLJIL0HP1" received FIN.
2025-05-05 15:16:18.848 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5041/api/Auth/register - application/json 131
2025-05-05 15:16:18.851 +07:00 [DBG] Connection id "0HNCBLJIL0HP1" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-05 15:16:18.853 +07:00 [DBG] Connection id "0HNCBLJIL0HP1" disconnecting.
2025-05-05 15:16:18.855 +07:00 [DBG] Connection id "0HNCBLJIL0HP1" stopped.
2025-05-05 15:16:18.855 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/register'
2025-05-05 15:16:18.859 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Register (ExchangeDocument)' with route pattern 'api/Auth/register' is valid for the request path '/api/Auth/register'
2025-05-05 15:16:18.863 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Register (ExchangeDocument)'
2025-05-05 15:16:18.864 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 15:16:18.866 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-05 15:16:18.868 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Register (ExchangeDocument)'
2025-05-05 15:16:18.891 +07:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(ExchangeDocument.BusinessLayer.DTOs.Auth.RegisterRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-05 15:16:18.893 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-05 15:16:18.896 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-05 15:16:18.899 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-05 15:16:18.901 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-05 15:16:18.902 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-05 15:16:18.904 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-05 15:16:18.961 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-05-05 15:16:18.981 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-05 15:16:18.985 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.RegisterRequestDTO' ...
2025-05-05 15:16:18.987 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.RegisterRequestDTO' using the name '' in request data ...
2025-05-05 15:16:18.988 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-05 15:16:19.002 +07:00 [DBG] Connection id "0HNCBLJIL0HP0", Request id "0HNCBLJIL0HP0:00000004": started reading request body.
2025-05-05 15:16:19.003 +07:00 [DBG] Connection id "0HNCBLJIL0HP0", Request id "0HNCBLJIL0HP0:00000004": done reading request body.
2025-05-05 15:16:19.013 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.RegisterRequestDTO'
2025-05-05 15:16:19.014 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.RegisterRequestDTO'.
2025-05-05 15:16:19.015 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.RegisterRequestDTO'.
2025-05-05 15:16:19.016 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.RegisterRequestDTO' ...
2025-05-05 15:16:19.022 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.RegisterRequestDTO'.
2025-05-05 15:16:19.024 +07:00 [DBG] The request has model state errors, returning an error response.
2025-05-05 15:16:19.025 +07:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2025-05-05 15:16:19.027 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-05 15:16:19.029 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-05 15:16:19.030 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-05-05 15:16:19.032 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-05-05 15:16:19.033 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-05 15:16:19.057 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Register (ExchangeDocument) in 151.8911ms
2025-05-05 15:16:19.058 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Register (ExchangeDocument)'
2025-05-05 15:16:19.058 +07:00 [INF] HTTP POST /api/Auth/register responded 400 in 194.0257 ms
2025-05-05 15:16:19.059 +07:00 [DBG] Connection id "0HNCBLJIL0HP0" completed keep alive response.
2025-05-05 15:16:19.061 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5041/api/Auth/register - 400 null application/problem+json; charset=utf-8 213.375ms
2025-05-05 15:16:35.599 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5041/api/Auth/register - application/json 131
2025-05-05 15:16:35.610 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/register'
2025-05-05 15:16:35.613 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Register (ExchangeDocument)' with route pattern 'api/Auth/register' is valid for the request path '/api/Auth/register'
2025-05-05 15:16:35.616 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Register (ExchangeDocument)'
2025-05-05 15:16:35.620 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 15:16:35.623 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-05 15:16:35.624 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Register (ExchangeDocument)'
2025-05-05 15:16:35.626 +07:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(ExchangeDocument.BusinessLayer.DTOs.Auth.RegisterRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-05 15:16:35.628 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-05 15:16:35.629 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-05 15:16:35.630 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-05 15:16:35.634 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-05 15:16:35.637 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-05 15:16:35.638 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-05 15:16:35.644 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-05 15:16:35.645 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.RegisterRequestDTO' ...
2025-05-05 15:16:35.647 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.RegisterRequestDTO' using the name '' in request data ...
2025-05-05 15:16:35.648 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-05 15:16:35.649 +07:00 [DBG] Connection id "0HNCBLJIL0HP0", Request id "0HNCBLJIL0HP0:00000005": started reading request body.
2025-05-05 15:16:35.650 +07:00 [DBG] Connection id "0HNCBLJIL0HP0", Request id "0HNCBLJIL0HP0:00000005": done reading request body.
2025-05-05 15:16:35.651 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.RegisterRequestDTO'
2025-05-05 15:16:35.652 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.RegisterRequestDTO'.
2025-05-05 15:16:35.653 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.RegisterRequestDTO'.
2025-05-05 15:16:35.654 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.RegisterRequestDTO' ...
2025-05-05 15:16:35.656 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.RegisterRequestDTO'.
2025-05-05 15:16:36.000 +07:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'Order'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 15:16:36.002 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'OrderDetail'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 15:16:36.003 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'Review'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 15:16:36.004 +07:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'Userprofile'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 15:16:36.121 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-05 15:16:36.169 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .FirstOrDefault(u => u.Email == __email_0)'
2025-05-05 15:16:36.215 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-05 15:16:36.377 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.DeletedAt (DateTime?), 2], [Property: User.Email (string) Required Index MaxLength(255), 3], [Property: User.FullName (string) Required MaxLength(255), 4], [Property: User.IsDeleted (bool) Required, 5], [Property: User.IsEmailVerified (bool) Required, 6], [Property: User.IsLocked (bool) Required, 7], [Property: User.Password (string) Required MaxLength(255), 8], [Property: User.PasswordResetToken (string), 9], [Property: User.Phone (string) MaxLength(20), 10], [Property: User.ResetTokenExpires (DateTime?), 11], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 12], [Property: User.UpdatedAt (DateTime?), 13] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 14], [Property: Role.RoleName (string) Required Index MaxLength(50), 15] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.DeletedAt, u.email, u.fullName, u.IsDeleted, u.IsEmailVerified, u.IsLocked, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE Not(u.IsDeleted) && (u.email == @__email_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.DeletedAt (DateTime?), 2], [Property: User.Email (string) Required Index MaxLength(255), 3], [Property: User.FullName (string) Required MaxLength(255), 4], [Property: User.IsDeleted (bool) Required, 5], [Property: User.IsEmailVerified (bool) Required, 6], [Property: User.IsLocked (bool) Required, 7], [Property: User.Password (string) Required MaxLength(255), 8], [Property: User.PasswordResetToken (string), 9], [Property: User.Phone (string) MaxLength(20), 10], [Property: User.ResetTokenExpires (DateTime?), 11], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 12], [Property: User.UpdatedAt (DateTime?), 13] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 14], [Property: Role.RoleName (string) Required Index MaxLength(50), 15] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.DeletedAt, u.email, u.fullName, u.IsDeleted, u.IsEmailVerified, u.IsLocked, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE Not(u.IsDeleted) && (u.email == @__email_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            Role entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<DeletedAt>k__BackingField = dataReader.IsDBNull(2) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(2);
                                    instance.<Email>k__BackingField = dataReader.GetString(3);
                                    instance.<FullName>k__BackingField = dataReader.GetString(4);
                                    instance.<IsDeleted>k__BackingField = dataReader.GetBoolean(5);
                                    instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(6);
                                    instance.<IsLocked>k__BackingField = dataReader.GetBoolean(7);
                                    instance.<Password>k__BackingField = dataReader.GetString(8);
                                    instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                    instance.<Phone>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                    instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(11);
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(12);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(13) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(13);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                Role instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(Role);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(14) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (Role)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                            {
                                return 
                                {
                                    Role instance;
                                    instance = new Role();
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(14);
                                    instance.<RoleName>k__BackingField = dataReader.GetString(15);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Role)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
                fixup: (namelessParameter{8}, namelessParameter{9}) => 
                {
                    namelessParameter{8}.<Role>k__BackingField = namelessParameter{9};
                    return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                        entity: namelessParameter{9}, 
                        value: namelessParameter{8}, 
                        forMaterialization: True);
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-05 15:16:36.414 +07:00 [DBG] Creating DbConnection.
2025-05-05 15:16:36.429 +07:00 [DBG] Created DbConnection. (13ms).
2025-05-05 15:16:36.432 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:16:36.523 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:16:36.525 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 15:16:36.530 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-05-05 15:16:36.536 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (10ms).
2025-05-05 15:16:36.542 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-05 15:16:36.582 +07:00 [INF] Executed DbCommand (41ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-05 15:16:36.610 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:16:36.648 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:16:36.653 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:16:36.660 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:16:36.667 +07:00 [DBG] A data reader for 'exchangedocument' on server 'MINHKHAI' is being disposed after spending 79ms reading results.
2025-05-05 15:16:36.671 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:16:36.675 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'MINHKHAI' (4ms).
2025-05-05 15:16:36.880 +07:00 [INF] Generated OTP for khaile.03042005@gmail.com
2025-05-05 15:16:40.384 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-05 15:16:40.391 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-05 15:16:40.392 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-05 15:16:40.393 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-05 15:16:40.394 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-05 15:16:40.395 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType5`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-05 15:16:40.402 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Register (ExchangeDocument) in 4763.5907ms
2025-05-05 15:16:40.405 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Register (ExchangeDocument)'
2025-05-05 15:16:40.407 +07:00 [INF] HTTP POST /api/Auth/register responded 200 in 4786.9525 ms
2025-05-05 15:16:40.408 +07:00 [DBG] Connection id "0HNCBLJIL0HP0" completed keep alive response.
2025-05-05 15:16:40.410 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-05 15:16:40.414 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:16:40.415 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-05 15:16:40.417 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5041/api/Auth/register - 200 null application/json; charset=utf-8 4817.5483ms
2025-05-05 15:17:00.204 +07:00 [DBG] Connection id "0HNCBLJIL0HP2" received FIN.
2025-05-05 15:17:00.205 +07:00 [DBG] Connection id "0HNCBLJIL0HP2" accepted.
2025-05-05 15:17:00.206 +07:00 [DBG] Connection id "0HNCBLJIL0HP2" started.
2025-05-05 15:17:00.207 +07:00 [DBG] Connection id "0HNCBLJIL0HP2" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-05 15:17:00.209 +07:00 [DBG] Connection id "0HNCBLJIL0HP2" disconnecting.
2025-05-05 15:17:00.210 +07:00 [DBG] Connection id "0HNCBLJIL0HP2" stopped.
2025-05-05 15:17:00.417 +07:00 [DBG] Connection id "0HNCBLJIL0HP3" accepted.
2025-05-05 15:17:00.418 +07:00 [DBG] Connection id "0HNCBLJIL0HP3" started.
2025-05-05 15:17:00.433 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5041/swagger/index.html - null null
2025-05-05 15:17:00.437 +07:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-05-05 15:17:00.439 +07:00 [DBG] Request did not match any endpoints
2025-05-05 15:17:00.442 +07:00 [INF] HTTP GET /swagger/index.html responded 200 in 0.6842 ms
2025-05-05 15:17:00.462 +07:00 [DBG] Connection id "0HNCBLJIL0HP0" completed keep alive response.
2025-05-05 15:17:00.466 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5041/swagger/index.html - 200 null text/html;charset=utf-8 32.2571ms
2025-05-05 15:17:00.867 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5041/swagger/v1/swagger.json - null null
2025-05-05 15:17:00.871 +07:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-05-05 15:17:00.880 +07:00 [DBG] Request did not match any endpoints
2025-05-05 15:17:00.909 +07:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 27.8739 ms
2025-05-05 15:17:00.911 +07:00 [DBG] Connection id "0HNCBLJIL0HP0" completed keep alive response.
2025-05-05 15:17:00.915 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5041/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 48.4575ms
2025-05-05 15:17:22.408 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5041/swagger/v1/swagger.json - null null
2025-05-05 15:17:22.410 +07:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-05-05 15:17:22.411 +07:00 [DBG] Request did not match any endpoints
2025-05-05 15:17:22.421 +07:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 9.5613 ms
2025-05-05 15:17:22.422 +07:00 [DBG] Connection id "0HNCBLJIL0HP0" completed keep alive response.
2025-05-05 15:17:22.423 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5041/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 15.2857ms
2025-05-05 15:17:42.489 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5041/swagger/v1/swagger.json - null null
2025-05-05 15:17:42.491 +07:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-05-05 15:17:42.492 +07:00 [DBG] Request did not match any endpoints
2025-05-05 15:17:42.504 +07:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 11.1644 ms
2025-05-05 15:17:42.505 +07:00 [DBG] Connection id "0HNCBLJIL0HP0" completed keep alive response.
2025-05-05 15:17:42.508 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5041/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 18.0468ms
2025-05-05 15:18:18.011 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5041/api/Auth/verify-otp - application/json 61
2025-05-05 15:18:18.012 +07:00 [DBG] Connection id "0HNCBLJIL0HP3" received FIN.
2025-05-05 15:18:18.016 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/verify-otp'
2025-05-05 15:18:18.017 +07:00 [DBG] Connection id "0HNCBLJIL0HP3" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-05 15:18:18.018 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.VerifyOtp (ExchangeDocument)' with route pattern 'api/Auth/verify-otp' is valid for the request path '/api/Auth/verify-otp'
2025-05-05 15:18:18.021 +07:00 [DBG] Connection id "0HNCBLJIL0HP3" disconnecting.
2025-05-05 15:18:18.023 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.VerifyOtp (ExchangeDocument)'
2025-05-05 15:18:18.024 +07:00 [DBG] Connection id "0HNCBLJIL0HP3" stopped.
2025-05-05 15:18:18.025 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 15:18:18.027 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-05 15:18:18.028 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.VerifyOtp (ExchangeDocument)'
2025-05-05 15:18:18.032 +07:00 [INF] Route matched with {action = "VerifyOtp", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] VerifyOtp(ExchangeDocument.BusinessLayer.DTOs.Auth.VerifyOtpRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-05 15:18:18.035 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-05 15:18:18.037 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-05 15:18:18.038 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-05 15:18:18.040 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-05 15:18:18.041 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-05 15:18:18.042 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-05 15:18:18.048 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-05 15:18:18.049 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.VerifyOtpRequestDTO' ...
2025-05-05 15:18:18.050 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.VerifyOtpRequestDTO' using the name '' in request data ...
2025-05-05 15:18:18.051 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-05 15:18:18.052 +07:00 [DBG] Connection id "0HNCBLJIL0HP0", Request id "0HNCBLJIL0HP0:0000000A": started reading request body.
2025-05-05 15:18:18.053 +07:00 [DBG] Connection id "0HNCBLJIL0HP0", Request id "0HNCBLJIL0HP0:0000000A": done reading request body.
2025-05-05 15:18:18.056 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.VerifyOtpRequestDTO'
2025-05-05 15:18:18.056 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.VerifyOtpRequestDTO'.
2025-05-05 15:18:18.057 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.VerifyOtpRequestDTO'.
2025-05-05 15:18:18.058 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.VerifyOtpRequestDTO' ...
2025-05-05 15:18:18.060 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.VerifyOtpRequestDTO'.
2025-05-05 15:18:18.070 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-05 15:18:18.074 +07:00 [DBG] Creating DbConnection.
2025-05-05 15:18:18.080 +07:00 [DBG] Created DbConnection. (6ms).
2025-05-05 15:18:18.083 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:18:18.089 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:18:18.090 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 15:18:18.091 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-05 15:18:18.093 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-05 15:18:18.094 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-05 15:18:18.100 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-05 15:18:18.102 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:18:18.103 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:18:18.104 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:18:18.105 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:18:18.106 +07:00 [DBG] A data reader for 'exchangedocument' on server 'MINHKHAI' is being disposed after spending 4ms reading results.
2025-05-05 15:18:18.108 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:18:18.109 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'MINHKHAI' (1ms).
2025-05-05 15:18:18.113 +07:00 [DBG] SaveChanges starting for 'ExchangeDocumentContext'.
2025-05-05 15:18:18.115 +07:00 [DBG] DetectChanges starting for 'ExchangeDocumentContext'.
2025-05-05 15:18:18.126 +07:00 [DBG] The unchanged property 'User.IsEmailVerified' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-05 15:18:18.132 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:18:18.135 +07:00 [DBG] The unchanged property 'User.UpdatedAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-05 15:18:18.141 +07:00 [DBG] DetectChanges completed for 'ExchangeDocumentContext'.
2025-05-05 15:18:18.182 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:18:18.183 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:18:18.188 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 15:18:18.190 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-05 15:18:18.191 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-05 15:18:18.193 +07:00 [DBG] Executing DbCommand [Parameters=[@p2='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [users] SET [IsEmailVerified] = @p0, [UpdatedAt] = @p1
OUTPUT 1
WHERE [userId] = @p2;
2025-05-05 15:18:18.200 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [users] SET [IsEmailVerified] = @p0, [UpdatedAt] = @p1
OUTPUT 1
WHERE [userId] = @p2;
2025-05-05 15:18:18.205 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:18:18.206 +07:00 [DBG] A data reader for 'exchangedocument' on server 'MINHKHAI' is being disposed after spending 4ms reading results.
2025-05-05 15:18:18.211 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:18:18.213 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'MINHKHAI' (1ms).
2025-05-05 15:18:18.218 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:18:18.220 +07:00 [DBG] SaveChanges completed for 'ExchangeDocumentContext' with 1 entities written to the database.
2025-05-05 15:18:18.221 +07:00 [INF] User khaile.03042005@gmail.com verified successfully
2025-05-05 15:18:18.222 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-05 15:18:18.224 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-05 15:18:18.224 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-05 15:18:18.225 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-05 15:18:18.225 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-05 15:18:18.226 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType5`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-05 15:18:18.227 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.VerifyOtp (ExchangeDocument) in 184.8775ms
2025-05-05 15:18:18.229 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.VerifyOtp (ExchangeDocument)'
2025-05-05 15:18:18.230 +07:00 [INF] HTTP POST /api/Auth/verify-otp responded 200 in 204.9886 ms
2025-05-05 15:18:18.231 +07:00 [DBG] Connection id "0HNCBLJIL0HP0" completed keep alive response.
2025-05-05 15:18:18.232 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-05 15:18:18.233 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:18:18.234 +07:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-05-05 15:18:18.236 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5041/api/Auth/verify-otp - 200 null application/json; charset=utf-8 224.3267ms
2025-05-05 15:20:28.865 +07:00 [DBG] Connection id "0HNCBLJIL0HP0" disconnecting.
2025-05-05 15:20:28.866 +07:00 [DBG] Connection id "0HNCBLJIL0HP0" stopped.
2025-05-05 15:20:28.867 +07:00 [DBG] Connection id "0HNCBLJIL0HP0" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-05 15:20:49.651 +07:00 [DBG] Connection id "0HNCBLJIL0HP4" accepted.
2025-05-05 15:20:49.653 +07:00 [DBG] Connection id "0HNCBLJIL0HP4" started.
2025-05-05 15:20:49.663 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5041/api/Auth/login - application/json 68
2025-05-05 15:20:49.667 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-05 15:20:49.671 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-05 15:20:49.673 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-05 15:20:49.674 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 15:20:49.675 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-05 15:20:49.676 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-05 15:20:49.679 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-05 15:20:49.681 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-05 15:20:49.682 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-05 15:20:49.683 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-05 15:20:49.684 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-05 15:20:49.685 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-05 15:20:49.686 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-05 15:20:49.688 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-05 15:20:49.689 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-05 15:20:49.690 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-05 15:20:49.691 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-05 15:20:49.693 +07:00 [DBG] Connection id "0HNCBLJIL0HP4", Request id "0HNCBLJIL0HP4:00000001": started reading request body.
2025-05-05 15:20:49.694 +07:00 [DBG] Connection id "0HNCBLJIL0HP4", Request id "0HNCBLJIL0HP4:00000001": done reading request body.
2025-05-05 15:20:49.695 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-05 15:20:49.696 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-05 15:20:49.697 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-05 15:20:49.698 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-05 15:20:49.700 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-05 15:20:49.764 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-05 15:20:49.767 +07:00 [DBG] Creating DbConnection.
2025-05-05 15:20:49.767 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-05 15:20:49.768 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:20:49.769 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:20:49.770 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 15:20:49.771 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-05 15:20:49.774 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-05-05 15:20:49.775 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-05 15:20:49.781 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-05 15:20:49.783 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:20:49.785 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:20:49.786 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:20:49.787 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:20:49.787 +07:00 [DBG] A data reader for 'exchangedocument' on server 'MINHKHAI' is being disposed after spending 4ms reading results.
2025-05-05 15:20:49.788 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:20:49.789 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'MINHKHAI' (0ms).
2025-05-05 15:20:49.791 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 104.4237ms
2025-05-05 15:20:49.792 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-05 15:20:49.793 +07:00 [ERR] An unhandled exception has occurred while executing the request.
BCrypt.Net.SaltParseException: Invalid salt version
   at BCrypt.Net.BCrypt.HashPassword(String inputKey, String salt, Boolean enhancedEntropy, HashType hashType) in I:\bcrypt.net\src\BCrypt.Net\BCrypt.cs:line 621
   at BCrypt.Net.BCrypt.Verify(String text, String hash, Boolean enhancedEntropy, HashType hashType) in I:\bcrypt.net\src\BCrypt.Net\BCrypt.cs:line 811
   at ExchangeDocument.BusinessLayer.Services.AuthService.LoginAsync(LoginRequestDTO request) in D:\Dowload\ExchangeDocument(Tự làm Auth_User)\ExchangeDocument(Tự làm Auth_User) - Đã xong API của Module Auth_User(13)\ExchangeDocument\BusinessLayer\Services\AuthService.cs:line 118
   at ExchangeDocument.PresentationLayer.Controllers.AuthController.Login(LoginRequestDTO request) in D:\Dowload\ExchangeDocument(Tự làm Auth_User)\ExchangeDocument(Tự làm Auth_User) - Đã xong API của Module Auth_User(13)\ExchangeDocument\PresentationLayer\Controllers\AuthController.cs:line 60
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-05 15:20:49.884 +07:00 [ERR] HTTP POST /api/Auth/login responded 500 in 209.9048 ms
2025-05-05 15:20:49.885 +07:00 [DBG] Connection id "0HNCBLJIL0HP4" completed keep alive response.
2025-05-05 15:20:49.886 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-05 15:20:49.886 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:20:49.887 +07:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-05-05 15:20:49.888 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5041/api/Auth/login - 500 null text/plain; charset=utf-8 225.2004ms
2025-05-05 15:22:08.022 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5041/api/Auth/forgot-password - application/json 42
2025-05-05 15:22:08.025 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/forgot-password'
2025-05-05 15:22:08.026 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.ForgotPassword (ExchangeDocument)' with route pattern 'api/Auth/forgot-password' is valid for the request path '/api/Auth/forgot-password'
2025-05-05 15:22:08.027 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.ForgotPassword (ExchangeDocument)'
2025-05-05 15:22:08.028 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 15:22:08.032 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-05 15:22:08.033 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.ForgotPassword (ExchangeDocument)'
2025-05-05 15:22:08.036 +07:00 [INF] Route matched with {action = "ForgotPassword", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ForgotPassword(ExchangeDocument.BusinessLayer.DTOs.Auth.ForgotPasswordRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-05 15:22:08.038 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-05 15:22:08.039 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-05 15:22:08.042 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-05 15:22:08.043 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-05 15:22:08.044 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-05 15:22:08.045 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-05 15:22:08.046 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-05 15:22:08.048 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.ForgotPasswordRequestDTO' ...
2025-05-05 15:22:08.049 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.ForgotPasswordRequestDTO' using the name '' in request data ...
2025-05-05 15:22:08.050 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-05 15:22:08.051 +07:00 [DBG] Connection id "0HNCBLJIL0HP4", Request id "0HNCBLJIL0HP4:00000002": started reading request body.
2025-05-05 15:22:08.052 +07:00 [DBG] Connection id "0HNCBLJIL0HP4", Request id "0HNCBLJIL0HP4:00000002": done reading request body.
2025-05-05 15:22:08.053 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.ForgotPasswordRequestDTO'
2025-05-05 15:22:08.055 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.ForgotPasswordRequestDTO'.
2025-05-05 15:22:08.056 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.ForgotPasswordRequestDTO'.
2025-05-05 15:22:08.056 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.ForgotPasswordRequestDTO' ...
2025-05-05 15:22:08.058 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.ForgotPasswordRequestDTO'.
2025-05-05 15:22:08.063 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-05 15:22:08.065 +07:00 [DBG] Creating DbConnection.
2025-05-05 15:22:08.065 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-05 15:22:08.066 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:22:08.067 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:22:08.068 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 15:22:08.069 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-05 15:22:08.070 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-05 15:22:08.071 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-05 15:22:08.076 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-05 15:22:08.078 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:22:08.079 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:22:08.080 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:22:08.080 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:22:08.082 +07:00 [DBG] A data reader for 'exchangedocument' on server 'MINHKHAI' is being disposed after spending 4ms reading results.
2025-05-05 15:22:08.083 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:22:08.084 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'MINHKHAI' (0ms).
2025-05-05 15:22:08.085 +07:00 [DBG] SaveChanges starting for 'ExchangeDocumentContext'.
2025-05-05 15:22:08.086 +07:00 [DBG] DetectChanges starting for 'ExchangeDocumentContext'.
2025-05-05 15:22:08.086 +07:00 [DBG] The unchanged property 'User.PasswordResetToken' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-05 15:22:08.087 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:22:08.089 +07:00 [DBG] The unchanged property 'User.ResetTokenExpires' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-05 15:22:08.091 +07:00 [DBG] DetectChanges completed for 'ExchangeDocumentContext'.
2025-05-05 15:22:08.092 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:22:08.093 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:22:08.094 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 15:22:08.094 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-05 15:22:08.096 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-05 15:22:08.097 +07:00 [DBG] Executing DbCommand [Parameters=[@p2='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [users] SET [PasswordResetToken] = @p0, [ResetTokenExpires] = @p1
OUTPUT 1
WHERE [userId] = @p2;
2025-05-05 15:22:08.108 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [users] SET [PasswordResetToken] = @p0, [ResetTokenExpires] = @p1
OUTPUT 1
WHERE [userId] = @p2;
2025-05-05 15:22:08.111 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:22:08.111 +07:00 [DBG] A data reader for 'exchangedocument' on server 'MINHKHAI' is being disposed after spending 0ms reading results.
2025-05-05 15:22:08.112 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:22:08.113 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'MINHKHAI' (0ms).
2025-05-05 15:22:08.115 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:22:08.117 +07:00 [DBG] SaveChanges completed for 'ExchangeDocumentContext' with 1 entities written to the database.
2025-05-05 15:22:08.118 +07:00 [INF] Generated password reset token for khaile.03042005@gmail.com
2025-05-05 15:22:11.082 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-05 15:22:11.090 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-05 15:22:11.092 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-05 15:22:11.094 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-05 15:22:11.095 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-05 15:22:11.098 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-05 15:22:11.102 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.ForgotPassword (ExchangeDocument) in 3057.1447ms
2025-05-05 15:22:11.106 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.ForgotPassword (ExchangeDocument)'
2025-05-05 15:22:11.106 +07:00 [INF] HTTP POST /api/Auth/forgot-password responded 200 in 3078.8544 ms
2025-05-05 15:22:11.108 +07:00 [DBG] Connection id "0HNCBLJIL0HP4" completed keep alive response.
2025-05-05 15:22:11.110 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-05 15:22:11.111 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:22:11.113 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-05 15:22:11.114 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5041/api/Auth/forgot-password - 200 null application/json; charset=utf-8 3091.7018ms
2025-05-05 15:23:02.376 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5041/api/Auth/reset-password - application/json 116
2025-05-05 15:23:02.379 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/reset-password'
2025-05-05 15:23:02.380 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.ResetPassword (ExchangeDocument)' with route pattern 'api/Auth/reset-password' is valid for the request path '/api/Auth/reset-password'
2025-05-05 15:23:02.383 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.ResetPassword (ExchangeDocument)'
2025-05-05 15:23:02.384 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 15:23:02.385 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-05 15:23:02.386 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.ResetPassword (ExchangeDocument)'
2025-05-05 15:23:02.391 +07:00 [INF] Route matched with {action = "ResetPassword", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ResetPassword(ExchangeDocument.BusinessLayer.DTOs.Auth.ResetPasswordRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-05 15:23:02.395 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-05 15:23:02.396 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-05 15:23:02.397 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-05 15:23:02.401 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-05 15:23:02.403 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-05 15:23:02.404 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-05 15:23:02.405 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-05 15:23:02.405 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.ResetPasswordRequestDTO' ...
2025-05-05 15:23:02.406 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.ResetPasswordRequestDTO' using the name '' in request data ...
2025-05-05 15:23:02.408 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-05 15:23:02.409 +07:00 [DBG] Connection id "0HNCBLJIL0HP4", Request id "0HNCBLJIL0HP4:00000003": started reading request body.
2025-05-05 15:23:02.410 +07:00 [DBG] Connection id "0HNCBLJIL0HP4", Request id "0HNCBLJIL0HP4:00000003": done reading request body.
2025-05-05 15:23:02.412 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.ResetPasswordRequestDTO'
2025-05-05 15:23:02.413 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.ResetPasswordRequestDTO'.
2025-05-05 15:23:02.413 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.ResetPasswordRequestDTO'.
2025-05-05 15:23:02.414 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.ResetPasswordRequestDTO' ...
2025-05-05 15:23:02.416 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.ResetPasswordRequestDTO'.
2025-05-05 15:23:02.419 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-05 15:23:02.421 +07:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Include(u => u.Role)
    .FirstOrDefault(u => u.PasswordResetToken == __token_0)'
2025-05-05 15:23:02.423 +07:00 [DBG] Including navigation: 'User.Role'.
2025-05-05 15:23:02.429 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.DeletedAt (DateTime?), 2], [Property: User.Email (string) Required Index MaxLength(255), 3], [Property: User.FullName (string) Required MaxLength(255), 4], [Property: User.IsDeleted (bool) Required, 5], [Property: User.IsEmailVerified (bool) Required, 6], [Property: User.IsLocked (bool) Required, 7], [Property: User.Password (string) Required MaxLength(255), 8], [Property: User.PasswordResetToken (string), 9], [Property: User.Phone (string) MaxLength(20), 10], [Property: User.ResetTokenExpires (DateTime?), 11], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 12], [Property: User.UpdatedAt (DateTime?), 13] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 14], [Property: Role.RoleName (string) Required Index MaxLength(50), 15] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.DeletedAt, u.email, u.fullName, u.IsDeleted, u.IsEmailVerified, u.IsLocked, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE Not(u.IsDeleted) && (u.PasswordResetToken == @__token_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.DeletedAt (DateTime?), 2], [Property: User.Email (string) Required Index MaxLength(255), 3], [Property: User.FullName (string) Required MaxLength(255), 4], [Property: User.IsDeleted (bool) Required, 5], [Property: User.IsEmailVerified (bool) Required, 6], [Property: User.IsLocked (bool) Required, 7], [Property: User.Password (string) Required MaxLength(255), 8], [Property: User.PasswordResetToken (string), 9], [Property: User.Phone (string) MaxLength(20), 10], [Property: User.ResetTokenExpires (DateTime?), 11], [Property: User.RoleId (int) Required FK Index ValueGenerated.OnAdd, 12], [Property: User.UpdatedAt (DateTime?), 13] }
                1 -> Dictionary<IProperty, int> { [Property: Role.RoleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 14], [Property: Role.RoleName (string) Required Index MaxLength(50), 15] }
            SELECT TOP(1) u.userId, u.CreatedAt, u.DeletedAt, u.email, u.fullName, u.IsDeleted, u.IsEmailVerified, u.IsLocked, u.password, u.PasswordResetToken, u.phone, u.ResetTokenExpires, u.roleId, u.UpdatedAt, r.roleId, r.roleName
            FROM users AS u
            INNER JOIN roles AS r ON u.roleId == r.roleId
            WHERE Not(u.IsDeleted) && (u.PasswordResetToken == @__token_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            Role entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.UserId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<DeletedAt>k__BackingField = dataReader.IsDBNull(2) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(2);
                                    instance.<Email>k__BackingField = dataReader.GetString(3);
                                    instance.<FullName>k__BackingField = dataReader.GetString(4);
                                    instance.<IsDeleted>k__BackingField = dataReader.GetBoolean(5);
                                    instance.<IsEmailVerified>k__BackingField = dataReader.GetBoolean(6);
                                    instance.<IsLocked>k__BackingField = dataReader.GetBoolean(7);
                                    instance.<Password>k__BackingField = dataReader.GetString(8);
                                    instance.<PasswordResetToken>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                    instance.<Phone>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                    instance.<ResetTokenExpires>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(11);
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(12);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(13) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(13);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                Role instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(Role);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Role.RoleId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(14) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (Role)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]: 
                            {
                                return 
                                {
                                    Role instance;
                                    instance = new Role();
                                    instance.<RoleId>k__BackingField = dataReader.GetInt32(14);
                                    instance.<RoleName>k__BackingField = dataReader.GetString(15);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Role | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Role)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<User, User, Role>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: User.Role (Role) ToPrincipal Role Inverse: Users | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.User").FindNavigation("Role")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: Role.Users (ICollection<User>) Collection ToDependent User Inverse: Role | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users")], 
                fixup: (namelessParameter{8}, namelessParameter{9}) => 
                {
                    namelessParameter{8}.<Role>k__BackingField = namelessParameter{9};
                    return [LIFTABLE Constant: ClrICollectionAccessor<Role, ICollection<User>, User> | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Role").FindNavigation("Users").GetCollectionAccessor()].Add(
                        entity: namelessParameter{9}, 
                        value: namelessParameter{8}, 
                        forMaterialization: True);
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-05 15:23:02.440 +07:00 [DBG] Creating DbConnection.
2025-05-05 15:23:02.441 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-05 15:23:02.442 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:23:02.443 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:23:02.444 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 15:23:02.445 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-05 15:23:02.446 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-05 15:23:02.446 +07:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[PasswordResetToken] = @__token_0
2025-05-05 15:23:02.471 +07:00 [INF] Executed DbCommand (25ms) [Parameters=[@__token_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[PasswordResetToken] = @__token_0
2025-05-05 15:23:02.474 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:23:02.475 +07:00 [DBG] A data reader for 'exchangedocument' on server 'MINHKHAI' is being disposed after spending 1ms reading results.
2025-05-05 15:23:02.476 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:23:02.477 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'MINHKHAI' (0ms).
2025-05-05 15:23:02.479 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-05 15:23:02.480 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-05 15:23:02.481 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-05 15:23:02.481 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-05 15:23:02.482 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-05 15:23:02.482 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType4`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-05 15:23:02.484 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.ResetPassword (ExchangeDocument) in 80.8039ms
2025-05-05 15:23:02.485 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.ResetPassword (ExchangeDocument)'
2025-05-05 15:23:02.486 +07:00 [INF] HTTP POST /api/Auth/reset-password responded 400 in 102.0183 ms
2025-05-05 15:23:02.487 +07:00 [DBG] Connection id "0HNCBLJIL0HP4" completed keep alive response.
2025-05-05 15:23:02.488 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-05 15:23:02.489 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:23:02.490 +07:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-05-05 15:23:02.491 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5041/api/Auth/reset-password - 400 null application/json; charset=utf-8 114.5984ms
2025-05-05 15:23:32.003 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5041/api/Auth/reset-password - application/json 115
2025-05-05 15:23:32.005 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/reset-password'
2025-05-05 15:23:32.012 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.ResetPassword (ExchangeDocument)' with route pattern 'api/Auth/reset-password' is valid for the request path '/api/Auth/reset-password'
2025-05-05 15:23:32.016 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.ResetPassword (ExchangeDocument)'
2025-05-05 15:23:32.018 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 15:23:32.021 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-05 15:23:32.022 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.ResetPassword (ExchangeDocument)'
2025-05-05 15:23:32.023 +07:00 [INF] Route matched with {action = "ResetPassword", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ResetPassword(ExchangeDocument.BusinessLayer.DTOs.Auth.ResetPasswordRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-05 15:23:32.026 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-05 15:23:32.027 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-05 15:23:32.028 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-05 15:23:32.030 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-05 15:23:32.031 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-05 15:23:32.033 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-05 15:23:32.034 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-05 15:23:32.035 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.ResetPasswordRequestDTO' ...
2025-05-05 15:23:32.036 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.ResetPasswordRequestDTO' using the name '' in request data ...
2025-05-05 15:23:32.037 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-05 15:23:32.038 +07:00 [DBG] Connection id "0HNCBLJIL0HP4", Request id "0HNCBLJIL0HP4:00000004": started reading request body.
2025-05-05 15:23:32.040 +07:00 [DBG] Connection id "0HNCBLJIL0HP4", Request id "0HNCBLJIL0HP4:00000004": done reading request body.
2025-05-05 15:23:32.041 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.ResetPasswordRequestDTO'
2025-05-05 15:23:32.042 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.ResetPasswordRequestDTO'.
2025-05-05 15:23:32.043 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.ResetPasswordRequestDTO'.
2025-05-05 15:23:32.044 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.ResetPasswordRequestDTO' ...
2025-05-05 15:23:32.045 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.ResetPasswordRequestDTO'.
2025-05-05 15:23:32.047 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-05 15:23:32.048 +07:00 [DBG] Creating DbConnection.
2025-05-05 15:23:32.049 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-05 15:23:32.050 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:23:32.051 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:23:32.052 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 15:23:32.052 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-05 15:23:32.053 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-05 15:23:32.055 +07:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[PasswordResetToken] = @__token_0
2025-05-05 15:23:32.060 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__token_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[PasswordResetToken] = @__token_0
2025-05-05 15:23:32.062 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:23:32.063 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:23:32.064 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:23:32.065 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:23:32.066 +07:00 [DBG] A data reader for 'exchangedocument' on server 'MINHKHAI' is being disposed after spending 4ms reading results.
2025-05-05 15:23:32.068 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:23:32.069 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'MINHKHAI' (0ms).
2025-05-05 15:23:32.289 +07:00 [DBG] SaveChanges starting for 'ExchangeDocumentContext'.
2025-05-05 15:23:32.290 +07:00 [DBG] DetectChanges starting for 'ExchangeDocumentContext'.
2025-05-05 15:23:32.291 +07:00 [DBG] The unchanged property 'User.Password' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-05 15:23:32.292 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:23:32.294 +07:00 [DBG] The unchanged property 'User.PasswordResetToken' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-05 15:23:32.294 +07:00 [DBG] The unchanged property 'User.ResetTokenExpires' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-05 15:23:32.295 +07:00 [DBG] The unchanged property 'User.UpdatedAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-05 15:23:32.297 +07:00 [DBG] DetectChanges completed for 'ExchangeDocumentContext'.
2025-05-05 15:23:32.298 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:23:32.300 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:23:32.301 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 15:23:32.302 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-05 15:23:32.302 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-05 15:23:32.306 +07:00 [DBG] Executing DbCommand [Parameters=[@p4='?' (DbType = Int32), @p0='?' (Size = 255), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [users] SET [password] = @p0, [PasswordResetToken] = @p1, [ResetTokenExpires] = @p2, [UpdatedAt] = @p3
OUTPUT 1
WHERE [userId] = @p4;
2025-05-05 15:23:32.311 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@p4='?' (DbType = Int32), @p0='?' (Size = 255), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [users] SET [password] = @p0, [PasswordResetToken] = @p1, [ResetTokenExpires] = @p2, [UpdatedAt] = @p3
OUTPUT 1
WHERE [userId] = @p4;
2025-05-05 15:23:32.313 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:23:32.314 +07:00 [DBG] A data reader for 'exchangedocument' on server 'MINHKHAI' is being disposed after spending 1ms reading results.
2025-05-05 15:23:32.315 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:23:32.315 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'MINHKHAI' (0ms).
2025-05-05 15:23:32.316 +07:00 [DBG] An entity of type 'User' tracked by 'ExchangeDocumentContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:23:32.318 +07:00 [DBG] SaveChanges completed for 'ExchangeDocumentContext' with 1 entities written to the database.
2025-05-05 15:23:32.319 +07:00 [INF] Password reset successfully for khaile.03042005@gmail.com
2025-05-05 15:23:32.320 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-05 15:23:32.322 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-05 15:23:32.323 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-05 15:23:32.323 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-05 15:23:32.324 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-05 15:23:32.326 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-05 15:23:32.327 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.ResetPassword (ExchangeDocument) in 293.9002ms
2025-05-05 15:23:32.328 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.ResetPassword (ExchangeDocument)'
2025-05-05 15:23:32.329 +07:00 [INF] HTTP POST /api/Auth/reset-password responded 200 in 311.2128 ms
2025-05-05 15:23:32.330 +07:00 [DBG] Connection id "0HNCBLJIL0HP4" completed keep alive response.
2025-05-05 15:23:32.331 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-05 15:23:32.332 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:23:32.333 +07:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-05-05 15:23:32.335 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5041/api/Auth/reset-password - 200 null application/json; charset=utf-8 331.2189ms
2025-05-05 15:24:07.830 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5041/api/Auth/login - application/json 68
2025-05-05 15:24:07.835 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-05 15:24:07.836 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-05 15:24:07.837 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-05 15:24:07.838 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 15:24:07.839 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-05 15:24:07.840 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-05 15:24:07.841 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-05 15:24:07.842 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-05 15:24:07.843 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-05 15:24:07.844 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-05 15:24:07.845 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-05 15:24:07.846 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-05 15:24:07.847 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-05 15:24:07.848 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-05 15:24:07.849 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-05 15:24:07.849 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-05 15:24:07.850 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-05 15:24:07.851 +07:00 [DBG] Connection id "0HNCBLJIL0HP4", Request id "0HNCBLJIL0HP4:00000005": started reading request body.
2025-05-05 15:24:07.852 +07:00 [DBG] Connection id "0HNCBLJIL0HP4", Request id "0HNCBLJIL0HP4:00000005": done reading request body.
2025-05-05 15:24:07.853 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-05 15:24:07.854 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-05 15:24:07.855 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-05 15:24:07.856 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-05 15:24:07.857 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-05 15:24:07.858 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-05 15:24:07.860 +07:00 [DBG] Creating DbConnection.
2025-05-05 15:24:07.861 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-05 15:24:07.861 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:24:07.862 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:24:07.863 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 15:24:07.863 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-05 15:24:07.864 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-05 15:24:07.865 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-05 15:24:07.870 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-05 15:24:07.872 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:24:07.873 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:24:07.874 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:24:07.875 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:24:07.876 +07:00 [DBG] A data reader for 'exchangedocument' on server 'MINHKHAI' is being disposed after spending 3ms reading results.
2025-05-05 15:24:07.877 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:24:07.878 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'MINHKHAI' (0ms).
2025-05-05 15:24:08.035 +07:00 [INF] User khaile.03042005@gmail.com logged in successfully
2025-05-05 15:24:08.036 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-05 15:24:08.037 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-05 15:24:08.038 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-05 15:24:08.038 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-05 15:24:08.039 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-05 15:24:08.041 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType6`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-05 15:24:08.045 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 198.6294ms
2025-05-05 15:24:08.048 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-05 15:24:08.049 +07:00 [INF] HTTP POST /api/Auth/login responded 200 in 210.6740 ms
2025-05-05 15:24:08.050 +07:00 [DBG] Connection id "0HNCBLJIL0HP4" completed keep alive response.
2025-05-05 15:24:08.051 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-05 15:24:08.052 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:24:08.053 +07:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-05-05 15:24:08.054 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5041/api/Auth/login - 200 null application/json; charset=utf-8 223.5068ms
2025-05-05 15:24:26.703 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5041/api/Auth/login - application/json 69
2025-05-05 15:24:26.705 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-05 15:24:26.708 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-05 15:24:26.709 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-05 15:24:26.710 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 15:24:26.711 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-05 15:24:26.711 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-05 15:24:26.712 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-05 15:24:26.714 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-05 15:24:26.715 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-05 15:24:26.716 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-05 15:24:26.718 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-05 15:24:26.719 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-05 15:24:26.720 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-05 15:24:26.721 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-05 15:24:26.722 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-05 15:24:26.723 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-05 15:24:26.724 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-05 15:24:26.725 +07:00 [DBG] Connection id "0HNCBLJIL0HP4", Request id "0HNCBLJIL0HP4:00000006": started reading request body.
2025-05-05 15:24:26.726 +07:00 [DBG] Connection id "0HNCBLJIL0HP4", Request id "0HNCBLJIL0HP4:00000006": done reading request body.
2025-05-05 15:24:26.727 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-05 15:24:26.728 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-05 15:24:26.729 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-05 15:24:26.730 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-05 15:24:26.731 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-05 15:24:26.733 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-05 15:24:26.734 +07:00 [DBG] Creating DbConnection.
2025-05-05 15:24:26.735 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-05 15:24:26.736 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:24:26.737 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:24:26.738 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 15:24:26.739 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-05 15:24:26.740 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-05 15:24:26.741 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-05 15:24:26.747 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-05 15:24:26.749 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:24:26.751 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:24:26.752 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:24:26.753 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:24:26.754 +07:00 [DBG] A data reader for 'exchangedocument' on server 'MINHKHAI' is being disposed after spending 4ms reading results.
2025-05-05 15:24:26.755 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:24:26.756 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'MINHKHAI' (0ms).
2025-05-05 15:24:26.901 +07:00 [WRN] Login failed: invalid password for khaile.03042005@gmail.com
2025-05-05 15:24:26.903 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-05 15:24:26.904 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-05 15:24:26.905 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-05 15:24:26.905 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-05 15:24:26.906 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-05 15:24:26.907 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType4`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-05 15:24:26.908 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 187.9595ms
2025-05-05 15:24:26.910 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-05 15:24:26.911 +07:00 [INF] HTTP POST /api/Auth/login responded 400 in 201.1478 ms
2025-05-05 15:24:26.913 +07:00 [DBG] Connection id "0HNCBLJIL0HP4" completed keep alive response.
2025-05-05 15:24:26.913 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-05 15:24:26.914 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:24:26.915 +07:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-05-05 15:24:26.917 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5041/api/Auth/login - 400 null application/json; charset=utf-8 213.3907ms
2025-05-05 15:24:52.444 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5041/api/Auth/login - application/json 68
2025-05-05 15:24:52.447 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-05-05 15:24:52.448 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-05-05 15:24:52.455 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-05 15:24:52.457 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 15:24:52.458 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-05 15:24:52.459 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-05 15:24:52.461 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO) on controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument).
2025-05-05 15:24:52.472 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-05 15:24:52.475 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-05 15:24:52.477 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-05 15:24:52.479 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-05 15:24:52.480 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-05 15:24:52.482 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-05 15:24:52.483 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AuthController (ExchangeDocument)
2025-05-05 15:24:52.490 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-05 15:24:52.493 +07:00 [DBG] Attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' using the name '' in request data ...
2025-05-05 15:24:52.495 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-05 15:24:52.496 +07:00 [DBG] Connection id "0HNCBLJIL0HP4", Request id "0HNCBLJIL0HP4:00000007": started reading request body.
2025-05-05 15:24:52.497 +07:00 [DBG] Connection id "0HNCBLJIL0HP4", Request id "0HNCBLJIL0HP4:00000007": done reading request body.
2025-05-05 15:24:52.499 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'
2025-05-05 15:24:52.500 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-05 15:24:52.501 +07:00 [DBG] Done attempting to bind parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-05 15:24:52.503 +07:00 [DBG] Attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO' ...
2025-05-05 15:24:52.504 +07:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'ExchangeDocument.BusinessLayer.DTOs.Auth.LoginRequestDTO'.
2025-05-05 15:24:52.506 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-05 15:24:52.508 +07:00 [DBG] Creating DbConnection.
2025-05-05 15:24:52.509 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-05 15:24:52.510 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:24:52.512 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:24:52.512 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 15:24:52.513 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-05 15:24:52.514 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-05 15:24:52.516 +07:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-05 15:24:52.521 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[userId], [u].[CreatedAt], [u].[DeletedAt], [u].[email], [u].[fullName], [u].[IsDeleted], [u].[IsEmailVerified], [u].[IsLocked], [u].[password], [u].[PasswordResetToken], [u].[phone], [u].[ResetTokenExpires], [u].[roleId], [u].[UpdatedAt], [r].[roleId], [r].[roleName]
FROM [users] AS [u]
INNER JOIN [roles] AS [r] ON [u].[roleId] = [r].[roleId]
WHERE [u].[IsDeleted] = CAST(0 AS bit) AND [u].[email] = @__email_0
2025-05-05 15:24:52.523 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:24:52.524 +07:00 [DBG] The navigation 'User.Role' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:24:52.525 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Role' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:24:52.526 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:24:52.527 +07:00 [DBG] A data reader for 'exchangedocument' on server 'MINHKHAI' is being disposed after spending 3ms reading results.
2025-05-05 15:24:52.528 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:24:52.529 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'MINHKHAI' (1ms).
2025-05-05 15:24:52.675 +07:00 [INF] User khaile.03042005@gmail.com logged in successfully
2025-05-05 15:24:52.678 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-05 15:24:52.683 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-05 15:24:52.684 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-05 15:24:52.686 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-05 15:24:52.689 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-05 15:24:52.691 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType6`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-05 15:24:52.692 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument) in 210.39ms
2025-05-05 15:24:52.694 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AuthController.Login (ExchangeDocument)'
2025-05-05 15:24:52.695 +07:00 [INF] HTTP POST /api/Auth/login responded 200 in 238.2822 ms
2025-05-05 15:24:52.697 +07:00 [DBG] Connection id "0HNCBLJIL0HP4" completed keep alive response.
2025-05-05 15:24:52.699 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-05 15:24:52.701 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:24:52.707 +07:00 [DBG] Disposed connection to database '' on server '' (5ms).
2025-05-05 15:24:52.709 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5041/api/Auth/login - 200 null application/json; charset=utf-8 265.1537ms
2025-05-05 15:26:07.058 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5041/api/Categories - null null
2025-05-05 15:26:07.061 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Categories'
2025-05-05 15:26:07.062 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.CategoriesController.GetAll (ExchangeDocument)' with route pattern 'api/Categories' is valid for the request path '/api/Categories'
2025-05-05 15:26:07.063 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.CategoriesController.GetAll (ExchangeDocument)'
2025-05-05 15:26:07.063 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 15:26:07.092 +07:00 [DBG] Successfully validated the token.
2025-05-05 15:26:07.102 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-05 15:26:07.103 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.CategoriesController.GetAll (ExchangeDocument)'
2025-05-05 15:26:07.106 +07:00 [INF] Route matched with {action = "GetAll", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[ExchangeDocument.BusinessLayer.DTOs.CategoryDto]]] GetAll() on controller ExchangeDocument.PresentationLayer.Controllers.CategoriesController (ExchangeDocument).
2025-05-05 15:26:07.108 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-05 15:26:07.109 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-05 15:26:07.110 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-05 15:26:07.111 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-05 15:26:07.112 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-05 15:26:07.113 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.CategoriesController (ExchangeDocument)
2025-05-05 15:26:07.114 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.CategoriesController (ExchangeDocument)
2025-05-05 15:26:07.119 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-05 15:26:07.120 +07:00 [DBG] Compiling query expression: 
'DbSet<Category>()'
2025-05-05 15:26:07.125 +07:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Category>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.CategoryId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.CategoryName (string) Required Index MaxLength(255), 1] }
        SELECT c.categoryId, c.categoryName
        FROM categories AS c) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.CategoryId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.CategoryName (string) Required Index MaxLength(255), 1] }
        SELECT c.categoryId, c.categoryName
        FROM categories AS c, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Category entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Category instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Category);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Category.CategoryId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Category").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Category)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Category")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Category")]: 
                        {
                            return 
                            {
                                Category instance;
                                instance = new Category();
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(0);
                                instance.<CategoryName>k__BackingField = dataReader.GetString(1);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Category")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Category)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-05-05 15:26:07.129 +07:00 [DBG] Creating DbConnection.
2025-05-05 15:26:07.129 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-05 15:26:07.130 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:26:07.131 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:26:07.132 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 15:26:07.133 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-05 15:26:07.134 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-05 15:26:07.138 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[categoryId], [c].[categoryName]
FROM [categories] AS [c]
2025-05-05 15:26:07.143 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[categoryId], [c].[categoryName]
FROM [categories] AS [c]
2025-05-05 15:26:07.145 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:26:07.146 +07:00 [DBG] A data reader for 'exchangedocument' on server 'MINHKHAI' is being disposed after spending 1ms reading results.
2025-05-05 15:26:07.147 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:26:07.147 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'MINHKHAI' (0ms).
2025-05-05 15:26:07.149 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-05 15:26:07.152 +07:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-05-05 15:26:07.153 +07:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-05-05 15:26:07.154 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-05 15:26:07.154 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-05 15:26:07.155 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-05 15:26:07.156 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[ExchangeDocument.DataAccessLayer.Entities.Category, ExchangeDocument, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[ExchangeDocument.BusinessLayer.DTOs.CategoryDto, ExchangeDocument, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-05 15:26:07.159 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.CategoriesController.GetAll (ExchangeDocument) in 46.1748ms
2025-05-05 15:26:07.160 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.CategoriesController.GetAll (ExchangeDocument)'
2025-05-05 15:26:07.161 +07:00 [INF] HTTP GET /api/Categories responded 200 in 97.8693 ms
2025-05-05 15:26:07.162 +07:00 [DBG] Connection id "0HNCBLJIL0HP4" completed keep alive response.
2025-05-05 15:26:07.163 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-05 15:26:07.164 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:26:07.165 +07:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-05-05 15:26:07.166 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5041/api/Categories - 200 null application/json; charset=utf-8 107.9814ms
2025-05-05 15:28:17.738 +07:00 [DBG] Connection id "0HNCBLJIL0HP4" disconnecting.
2025-05-05 15:28:17.742 +07:00 [DBG] Connection id "0HNCBLJIL0HP4" stopped.
2025-05-05 15:28:17.744 +07:00 [DBG] Connection id "0HNCBLJIL0HP4" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-05 15:29:50.946 +07:00 [DBG] Connection id "0HNCBLJIL0HP5" accepted.
2025-05-05 15:29:50.947 +07:00 [DBG] Connection id "0HNCBLJIL0HP5" started.
2025-05-05 15:29:50.948 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5041/api/Documents - application/json 328
2025-05-05 15:29:50.950 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Documents'
2025-05-05 15:29:50.951 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.DocumentsController.AddDocument (ExchangeDocument)' with route pattern 'api/Documents' is valid for the request path '/api/Documents'
2025-05-05 15:29:50.953 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.DocumentsController.AddDocument (ExchangeDocument)'
2025-05-05 15:29:50.954 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 15:29:50.955 +07:00 [DBG] Successfully validated the token.
2025-05-05 15:29:50.956 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-05 15:29:50.957 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.DocumentsController.AddDocument (ExchangeDocument)'
2025-05-05 15:29:50.960 +07:00 [INF] Route matched with {action = "AddDocument", controller = "Documents"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddDocument(ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto) on controller ExchangeDocument.PresentationLayer.Controllers.DocumentsController (ExchangeDocument).
2025-05-05 15:29:50.962 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-05 15:29:50.963 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-05 15:29:50.964 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-05 15:29:50.965 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-05 15:29:50.966 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-05 15:29:50.968 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.DocumentsController (ExchangeDocument)
2025-05-05 15:29:50.970 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.DocumentsController (ExchangeDocument)
2025-05-05 15:29:50.971 +07:00 [DBG] Attempting to bind parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto' ...
2025-05-05 15:29:50.971 +07:00 [DBG] Attempting to bind parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto' using the name '' in request data ...
2025-05-05 15:29:50.972 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-05 15:29:50.977 +07:00 [DBG] Connection id "0HNCBLJIL0HP5", Request id "0HNCBLJIL0HP5:00000001": started reading request body.
2025-05-05 15:29:50.978 +07:00 [DBG] Connection id "0HNCBLJIL0HP5", Request id "0HNCBLJIL0HP5:00000001": done reading request body.
2025-05-05 15:29:50.982 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto'
2025-05-05 15:29:50.983 +07:00 [DBG] Done attempting to bind parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto'.
2025-05-05 15:29:50.984 +07:00 [DBG] Done attempting to bind parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto'.
2025-05-05 15:29:50.985 +07:00 [DBG] Attempting to validate the bound parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto' ...
2025-05-05 15:29:50.988 +07:00 [DBG] Done attempting to validate the bound parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto'.
2025-05-05 15:29:50.995 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-05 15:29:51.007 +07:00 [DBG] Compiling query expression: 
'DbSet<Category>()
    .FirstOrDefault(e => EF.Property<int>(e, "CategoryId") == __p_0)'
2025-05-05 15:29:51.012 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Category>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Category>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.CategoryId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.CategoryName (string) Required Index MaxLength(255), 1] }
            SELECT TOP(1) c.categoryId, c.categoryName
            FROM categories AS c
            WHERE c.categoryId == @__p_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.CategoryId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.CategoryName (string) Required Index MaxLength(255), 1] }
            SELECT TOP(1) c.categoryId, c.categoryName
            FROM categories AS c
            WHERE c.categoryId == @__p_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Category entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Category instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Category);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Category.CategoryId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Category").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Category)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Category")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Category")]: 
                            {
                                return 
                                {
                                    Category instance;
                                    instance = new Category();
                                    instance.<CategoryId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CategoryName>k__BackingField = dataReader.GetString(1);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Category")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Category)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-05 15:29:51.015 +07:00 [DBG] Creating DbConnection.
2025-05-05 15:29:51.016 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-05 15:29:51.017 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:29:51.018 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:29:51.018 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 15:29:51.019 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-05 15:29:51.020 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-05 15:29:51.020 +07:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[categoryId], [c].[categoryName]
FROM [categories] AS [c]
WHERE [c].[categoryId] = @__p_0
2025-05-05 15:29:51.025 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[categoryId], [c].[categoryName]
FROM [categories] AS [c]
WHERE [c].[categoryId] = @__p_0
2025-05-05 15:29:51.026 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:29:51.028 +07:00 [DBG] A data reader for 'exchangedocument' on server 'MINHKHAI' is being disposed after spending 1ms reading results.
2025-05-05 15:29:51.028 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:29:51.030 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'MINHKHAI' (1ms).
2025-05-05 15:29:51.032 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-05 15:29:51.033 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-05 15:29:51.034 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-05 15:29:51.034 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-05 15:29:51.035 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-05 15:29:51.035 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType7`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-05 15:29:51.037 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.DocumentsController.AddDocument (ExchangeDocument) in 69.1449ms
2025-05-05 15:29:51.038 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.DocumentsController.AddDocument (ExchangeDocument)'
2025-05-05 15:29:51.039 +07:00 [INF] HTTP POST /api/Documents responded 400 in 84.9873 ms
2025-05-05 15:29:51.040 +07:00 [DBG] Connection id "0HNCBLJIL0HP5" completed keep alive response.
2025-05-05 15:29:51.040 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-05 15:29:51.041 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:29:51.042 +07:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-05-05 15:29:51.043 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5041/api/Documents - 400 null application/json; charset=utf-8 94.6437ms
2025-05-05 15:30:13.772 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5041/api/admin/categories - application/json 36
2025-05-05 15:30:13.781 +07:00 [DBG] 1 candidate(s) found for the request path '/api/admin/categories'
2025-05-05 15:30:13.781 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument)' with route pattern 'api/admin/categories' is valid for the request path '/api/admin/categories'
2025-05-05 15:30:13.784 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument)'
2025-05-05 15:30:13.785 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 15:30:13.788 +07:00 [DBG] Successfully validated the token.
2025-05-05 15:30:13.789 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-05 15:30:13.794 +07:00 [DBG] Authorization was successful.
2025-05-05 15:30:13.795 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument)'
2025-05-05 15:30:13.798 +07:00 [INF] Route matched with {action = "Create", controller = "AdminCategories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ExchangeDocument.BusinessLayer.DTOs.CategoryDto]] Create(ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto) on controller ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController (ExchangeDocument).
2025-05-05 15:30:13.800 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-05 15:30:13.801 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-05 15:30:13.802 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-05 15:30:13.803 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-05 15:30:13.804 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-05 15:30:13.805 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController (ExchangeDocument)
2025-05-05 15:30:13.806 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController (ExchangeDocument)
2025-05-05 15:30:13.808 +07:00 [DBG] Attempting to bind parameter 'createDto' of type 'ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto' ...
2025-05-05 15:30:13.810 +07:00 [DBG] Attempting to bind parameter 'createDto' of type 'ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto' using the name '' in request data ...
2025-05-05 15:30:13.811 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-05 15:30:13.812 +07:00 [DBG] Connection id "0HNCBLJIL0HP5", Request id "0HNCBLJIL0HP5:00000002": started reading request body.
2025-05-05 15:30:13.813 +07:00 [DBG] Connection id "0HNCBLJIL0HP5", Request id "0HNCBLJIL0HP5:00000002": done reading request body.
2025-05-05 15:30:13.814 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto'
2025-05-05 15:30:13.815 +07:00 [DBG] Done attempting to bind parameter 'createDto' of type 'ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto'.
2025-05-05 15:30:13.816 +07:00 [DBG] Done attempting to bind parameter 'createDto' of type 'ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto'.
2025-05-05 15:30:13.817 +07:00 [DBG] Attempting to validate the bound parameter 'createDto' of type 'ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto' ...
2025-05-05 15:30:13.818 +07:00 [DBG] Done attempting to validate the bound parameter 'createDto' of type 'ExchangeDocument.BusinessLayer.DTOs.CategoryCreateDto'.
2025-05-05 15:30:13.821 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-05 15:30:13.823 +07:00 [DBG] Creating DbConnection.
2025-05-05 15:30:13.823 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-05 15:30:13.824 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:30:13.825 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:30:13.825 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 15:30:13.826 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-05 15:30:13.827 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-05 15:30:13.828 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[categoryId], [c].[categoryName]
FROM [categories] AS [c]
2025-05-05 15:30:13.831 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[categoryId], [c].[categoryName]
FROM [categories] AS [c]
2025-05-05 15:30:13.832 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:30:13.833 +07:00 [DBG] A data reader for 'exchangedocument' on server 'MINHKHAI' is being disposed after spending 0ms reading results.
2025-05-05 15:30:13.834 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:30:13.835 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'MINHKHAI' (1ms).
2025-05-05 15:30:13.854 +07:00 [DBG] 'ExchangeDocumentContext' generated a temporary value for the property 'Category.CategoryId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:30:13.861 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:30:13.863 +07:00 [DBG] SaveChanges starting for 'ExchangeDocumentContext'.
2025-05-05 15:30:13.864 +07:00 [DBG] DetectChanges starting for 'ExchangeDocumentContext'.
2025-05-05 15:30:13.865 +07:00 [DBG] DetectChanges completed for 'ExchangeDocumentContext'.
2025-05-05 15:30:13.875 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:30:13.876 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:30:13.878 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 15:30:13.879 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-05 15:30:13.880 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-05 15:30:13.881 +07:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [categories] ([categoryName])
OUTPUT INSERTED.[categoryId]
VALUES (@p0);
2025-05-05 15:30:13.896 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[@p0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [categories] ([categoryName])
OUTPUT INSERTED.[categoryId]
VALUES (@p0);
2025-05-05 15:30:13.905 +07:00 [DBG] The foreign key property 'Category.CategoryId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-05 15:30:13.908 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:30:13.909 +07:00 [DBG] A data reader for 'exchangedocument' on server 'MINHKHAI' is being disposed after spending 10ms reading results.
2025-05-05 15:30:13.910 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:30:13.911 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'MINHKHAI' (0ms).
2025-05-05 15:30:13.914 +07:00 [DBG] An entity of type 'Category' tracked by 'ExchangeDocumentContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:30:13.916 +07:00 [DBG] SaveChanges completed for 'ExchangeDocumentContext' with 1 entities written to the database.
2025-05-05 15:30:13.917 +07:00 [INF] Danh mục tạo: Lập trình (ID=1) bởi CategoryService
2025-05-05 15:30:13.922 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-05 15:30:13.924 +07:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-05-05 15:30:13.925 +07:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-05-05 15:30:13.926 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-05 15:30:13.927 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-05 15:30:13.927 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-05 15:30:13.928 +07:00 [INF] Executing CreatedAtActionResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.CategoryDto'.
2025-05-05 15:30:13.939 +07:00 [DBG] Found the endpoints ["ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument)"] for address (id=[1],action=[Create],controller=[AdminCategories])
2025-05-05 15:30:13.942 +07:00 [DBG] Successfully processed template api/admin/categories for ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument) resulting in /api/admin/categories and ?id=1
2025-05-05 15:30:13.943 +07:00 [DBG] Link generation succeeded for endpoints ["ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument)"] with result /api/admin/categories?id=1
2025-05-05 15:30:13.945 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument) in 140.3693ms
2025-05-05 15:30:13.947 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.AdminCategoriesController.Create (ExchangeDocument)'
2025-05-05 15:30:13.949 +07:00 [INF] HTTP POST /api/admin/categories responded 201 in 163.1870 ms
2025-05-05 15:30:13.951 +07:00 [DBG] Connection id "0HNCBLJIL0HP5" completed keep alive response.
2025-05-05 15:30:13.952 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-05 15:30:13.953 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:30:13.954 +07:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-05-05 15:30:13.954 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5041/api/admin/categories - 201 null application/json; charset=utf-8 182.1563ms
2025-05-05 15:30:19.128 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5041/api/Documents - application/json 328
2025-05-05 15:30:19.131 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Documents'
2025-05-05 15:30:19.132 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.DocumentsController.AddDocument (ExchangeDocument)' with route pattern 'api/Documents' is valid for the request path '/api/Documents'
2025-05-05 15:30:19.133 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.DocumentsController.AddDocument (ExchangeDocument)'
2025-05-05 15:30:19.134 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 15:30:19.135 +07:00 [DBG] Successfully validated the token.
2025-05-05 15:30:19.135 +07:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-05-05 15:30:19.136 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.DocumentsController.AddDocument (ExchangeDocument)'
2025-05-05 15:30:19.137 +07:00 [INF] Route matched with {action = "AddDocument", controller = "Documents"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddDocument(ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto) on controller ExchangeDocument.PresentationLayer.Controllers.DocumentsController (ExchangeDocument).
2025-05-05 15:30:19.138 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-05 15:30:19.140 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-05 15:30:19.141 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-05 15:30:19.143 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-05 15:30:19.144 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-05 15:30:19.145 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.DocumentsController (ExchangeDocument)
2025-05-05 15:30:19.147 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.DocumentsController (ExchangeDocument)
2025-05-05 15:30:19.148 +07:00 [DBG] Attempting to bind parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto' ...
2025-05-05 15:30:19.149 +07:00 [DBG] Attempting to bind parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto' using the name '' in request data ...
2025-05-05 15:30:19.150 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-05 15:30:19.152 +07:00 [DBG] Connection id "0HNCBLJIL0HP5", Request id "0HNCBLJIL0HP5:00000003": started reading request body.
2025-05-05 15:30:19.153 +07:00 [DBG] Connection id "0HNCBLJIL0HP5", Request id "0HNCBLJIL0HP5:00000003": done reading request body.
2025-05-05 15:30:19.153 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto'
2025-05-05 15:30:19.154 +07:00 [DBG] Done attempting to bind parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto'.
2025-05-05 15:30:19.155 +07:00 [DBG] Done attempting to bind parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto'.
2025-05-05 15:30:19.156 +07:00 [DBG] Attempting to validate the bound parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto' ...
2025-05-05 15:30:19.157 +07:00 [DBG] Done attempting to validate the bound parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto'.
2025-05-05 15:30:19.159 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-05 15:30:19.161 +07:00 [DBG] Creating DbConnection.
2025-05-05 15:30:19.162 +07:00 [DBG] Created DbConnection. (0ms).
2025-05-05 15:30:19.162 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:30:19.163 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:30:19.164 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 15:30:19.164 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-05 15:30:19.165 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-05-05 15:30:19.166 +07:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[categoryId], [c].[categoryName]
FROM [categories] AS [c]
WHERE [c].[categoryId] = @__p_0
2025-05-05 15:30:19.172 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[categoryId], [c].[categoryName]
FROM [categories] AS [c]
WHERE [c].[categoryId] = @__p_0
2025-05-05 15:30:19.173 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:30:19.174 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:30:19.175 +07:00 [DBG] A data reader for 'exchangedocument' on server 'MINHKHAI' is being disposed after spending 1ms reading results.
2025-05-05 15:30:19.176 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:30:19.177 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'MINHKHAI' (0ms).
2025-05-05 15:30:19.183 +07:00 [DBG] 'ExchangeDocumentContext' generated a temporary value for the property 'Document.DocumentId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:30:19.206 +07:00 [DBG] The navigation 'Document.Category' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:30:19.210 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Document' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:30:19.212 +07:00 [DBG] SaveChanges starting for 'ExchangeDocumentContext'.
2025-05-05 15:30:19.212 +07:00 [DBG] DetectChanges starting for 'ExchangeDocumentContext'.
2025-05-05 15:30:19.223 +07:00 [DBG] DetectChanges completed for 'ExchangeDocumentContext'.
2025-05-05 15:30:19.226 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:30:19.227 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:30:19.228 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 15:30:19.229 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-05 15:30:19.230 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-05 15:30:19.231 +07:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32), @p2='?' (Size = 255), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 100), @p7='?' (Size = 500), @p8='?' (DbType = Boolean), @p9='?' (Size = 20), @p10='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p11='?' (DbType = Int32), @p12='?' (Size = 255), @p13='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [document] ([author], [categoryId], [condition], [DeletedAt], [description], [statusId], [edition], [imageUrl], [IsDeleted], [ISBN], [price], [publicationYear], [title], [userId])
OUTPUT INSERTED.[documentId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-05-05 15:30:19.243 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32), @p2='?' (Size = 255), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 100), @p7='?' (Size = 500), @p8='?' (DbType = Boolean), @p9='?' (Size = 20), @p10='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p11='?' (DbType = Int32), @p12='?' (Size = 255), @p13='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [document] ([author], [categoryId], [condition], [DeletedAt], [description], [statusId], [edition], [imageUrl], [IsDeleted], [ISBN], [price], [publicationYear], [title], [userId])
OUTPUT INSERTED.[documentId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-05-05 15:30:19.247 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:30:19.248 +07:00 [DBG] A data reader for 'exchangedocument' on server 'MINHKHAI' is being disposed after spending 3ms reading results.
2025-05-05 15:30:19.252 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:30:19.255 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'MINHKHAI' (2ms).
2025-05-05 15:30:19.261 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK__document__userId__47DBAE45". The conflict occurred in database "exchangedocument", table "dbo.users", column 'userId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4e7c8a89-e3cb-4b92-8786-755be40f2421
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK__document__userId__47DBAE45". The conflict occurred in database "exchangedocument", table "dbo.users", column 'userId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4e7c8a89-e3cb-4b92-8786-755be40f2421
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-05 15:30:19.269 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.DocumentsController.AddDocument (ExchangeDocument) in 123.4417ms
2025-05-05 15:30:19.270 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.DocumentsController.AddDocument (ExchangeDocument)'
2025-05-05 15:30:19.271 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK__document__userId__47DBAE45". The conflict occurred in database "exchangedocument", table "dbo.users", column 'userId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4e7c8a89-e3cb-4b92-8786-755be40f2421
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at ExchangeDocument.DataAccessLayer.Repositories.DocumentRepository.AddAsync(Document document) in D:\Dowload\ExchangeDocument(Tự làm Auth_User)\ExchangeDocument(Tự làm Auth_User) - Đã xong API của Module Auth_User(13)\ExchangeDocument\DataAccessLayer\Repositories\DocumentRepository.cs:line 26
   at ExchangeDocument.BusinessLayer.Services.DocumentService.AddDocumentAsync(DocumentCreateDto documentDto, Int32 userId) in D:\Dowload\ExchangeDocument(Tự làm Auth_User)\ExchangeDocument(Tự làm Auth_User) - Đã xong API của Module Auth_User(13)\ExchangeDocument\BusinessLayer\Services\DocumentService.cs:line 58
   at ExchangeDocument.PresentationLayer.Controllers.DocumentsController.AddDocument(DocumentCreateDto documentDto) in D:\Dowload\ExchangeDocument(Tự làm Auth_User)\ExchangeDocument(Tự làm Auth_User) - Đã xong API của Module Auth_User(13)\ExchangeDocument\PresentationLayer\Controllers\DocumentsController.cs:line 45
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-05 15:30:19.284 +07:00 [ERR] HTTP POST /api/Documents responded 500 in 149.4957 ms
2025-05-05 15:30:19.287 +07:00 [DBG] Connection id "0HNCBLJIL0HP5" completed keep alive response.
2025-05-05 15:30:19.291 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-05 15:30:19.291 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:30:19.292 +07:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-05-05 15:30:19.293 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5041/api/Documents - 500 null text/plain; charset=utf-8 165.0644ms
2025-05-05 15:32:30.122 +07:00 [DBG] Connection id "0HNCBLJIL0HP5" disconnecting.
2025-05-05 15:32:30.123 +07:00 [DBG] Connection id "0HNCBLJIL0HP5" stopped.
2025-05-05 15:32:30.124 +07:00 [DBG] Connection id "0HNCBLJIL0HP5" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-05 15:38:29.421 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-05-05 15:38:29.500 +07:00 [DBG] Hosting starting
2025-05-05 15:38:29.511 +07:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-05 15:38:29.520 +07:00 [DBG] Reading data from file 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys\key-8e54759c-7598-473f-bbce-4776bafbcb5b.xml'.
2025-05-05 15:38:29.527 +07:00 [DBG] Found key {8e54759c-7598-473f-bbce-4776bafbcb5b}.
2025-05-05 15:38:29.536 +07:00 [DBG] Considering key {8e54759c-7598-473f-bbce-4776bafbcb5b} with expiration date 2025-05-30 02:50:26Z as default key.
2025-05-05 15:38:29.541 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-05 15:38:29.544 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-05-05 15:38:29.547 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-05-05 15:38:29.552 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-05-05 15:38:29.554 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-05-05 15:38:29.556 +07:00 [DBG] Using key {8e54759c-7598-473f-bbce-4776bafbcb5b} as the default key.
2025-05-05 15:38:29.558 +07:00 [DBG] Key ring with default key {8e54759c-7598-473f-bbce-4776bafbcb5b} was loaded during application startup.
2025-05-05 15:38:29.590 +07:00 [INF] Now listening on: http://localhost:5041
2025-05-05 15:38:29.592 +07:00 [DBG] Loaded hosting startup assembly ExchangeDocument
2025-05-05 15:38:29.593 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-05 15:38:29.595 +07:00 [INF] Hosting environment: Development
2025-05-05 15:38:29.596 +07:00 [INF] Content root path: D:\Dowload\ExchangeDocument(Tự làm Auth_User)\ExchangeDocument(Tự làm Auth_User) - Đã xong API của Module Auth_User(13)\ExchangeDocument
2025-05-05 15:38:29.597 +07:00 [DBG] Hosting started
2025-05-05 15:38:38.481 +07:00 [DBG] Connection id "0HNCBM0TNJ86G" accepted.
2025-05-05 15:38:38.483 +07:00 [DBG] Connection id "0HNCBM0TNJ86G" started.
2025-05-05 15:38:38.484 +07:00 [DBG] Connection id "0HNCBM0TNJ86H" accepted.
2025-05-05 15:38:38.487 +07:00 [DBG] Connection id "0HNCBM0TNJ86H" started.
2025-05-05 15:38:38.508 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5041/swagger/index.html - null null
2025-05-05 15:38:38.513 +07:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-05-05 15:38:38.526 +07:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-05-05 15:38:38.528 +07:00 [DBG] Request did not match any endpoints
2025-05-05 15:38:38.606 +07:00 [INF] HTTP GET /swagger/index.html responded 200 in 73.9545 ms
2025-05-05 15:38:38.609 +07:00 [DBG] Connection id "0HNCBM0TNJ86G" completed keep alive response.
2025-05-05 15:38:38.614 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5041/swagger/index.html - 200 null text/html;charset=utf-8 106.352ms
2025-05-05 15:38:38.918 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5041/swagger/v1/swagger.json - null null
2025-05-05 15:38:38.920 +07:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-05-05 15:38:38.921 +07:00 [DBG] Request did not match any endpoints
2025-05-05 15:38:39.025 +07:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 104.1279 ms
2025-05-05 15:38:39.027 +07:00 [DBG] Connection id "0HNCBM0TNJ86G" completed keep alive response.
2025-05-05 15:38:39.028 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5041/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 110.7749ms
2025-05-05 15:39:24.746 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5041/api/Documents - application/json 224
2025-05-05 15:39:24.751 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Documents'
2025-05-05 15:39:24.754 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.DocumentsController.AddDocument (ExchangeDocument)' with route pattern 'api/Documents' is valid for the request path '/api/Documents'
2025-05-05 15:39:24.756 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.DocumentsController.AddDocument (ExchangeDocument)'
2025-05-05 15:39:24.762 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 15:39:24.763 +07:00 [WRN] Failed to determine the https port for redirect.
2025-05-05 15:39:24.783 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-05 15:39:24.785 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.DocumentsController.AddDocument (ExchangeDocument)'
2025-05-05 15:39:24.804 +07:00 [INF] Route matched with {action = "AddDocument", controller = "Documents"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddDocument(ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto) on controller ExchangeDocument.PresentationLayer.Controllers.DocumentsController (ExchangeDocument).
2025-05-05 15:39:24.807 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-05 15:39:24.809 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-05 15:39:24.810 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-05 15:39:24.811 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-05 15:39:24.813 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-05 15:39:24.815 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.DocumentsController (ExchangeDocument)
2025-05-05 15:39:24.879 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-05-05 15:39:24.892 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.DocumentsController (ExchangeDocument)
2025-05-05 15:39:24.898 +07:00 [DBG] Attempting to bind parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto' ...
2025-05-05 15:39:24.900 +07:00 [DBG] Attempting to bind parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto' using the name '' in request data ...
2025-05-05 15:39:24.902 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-05 15:39:24.919 +07:00 [DBG] Connection id "0HNCBM0TNJ86G", Request id "0HNCBM0TNJ86G:00000003": started reading request body.
2025-05-05 15:39:24.920 +07:00 [DBG] Connection id "0HNCBM0TNJ86G", Request id "0HNCBM0TNJ86G:00000003": done reading request body.
2025-05-05 15:39:24.933 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto'
2025-05-05 15:39:24.935 +07:00 [DBG] Done attempting to bind parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto'.
2025-05-05 15:39:24.936 +07:00 [DBG] Done attempting to bind parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto'.
2025-05-05 15:39:24.936 +07:00 [DBG] Attempting to validate the bound parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto' ...
2025-05-05 15:39:24.945 +07:00 [DBG] Done attempting to validate the bound parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto'.
2025-05-05 15:39:24.947 +07:00 [DBG] The request has model state errors, returning an error response.
2025-05-05 15:39:24.948 +07:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2025-05-05 15:39:24.950 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-05 15:39:24.952 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-05 15:39:24.953 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-05-05 15:39:24.955 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-05-05 15:39:24.956 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-05 15:39:24.980 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.DocumentsController.AddDocument (ExchangeDocument) in 163.4143ms
2025-05-05 15:39:24.982 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.DocumentsController.AddDocument (ExchangeDocument)'
2025-05-05 15:39:24.983 +07:00 [INF] HTTP POST /api/Documents responded 400 in 221.9200 ms
2025-05-05 15:39:24.984 +07:00 [DBG] Connection id "0HNCBM0TNJ86G" completed keep alive response.
2025-05-05 15:39:24.986 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5041/api/Documents - 400 null application/problem+json; charset=utf-8 239.2649ms
2025-05-05 15:39:43.103 +07:00 [DBG] Connection id "0HNCBM0TNJ86H" received FIN.
2025-05-05 15:39:43.110 +07:00 [DBG] Connection id "0HNCBM0TNJ86H" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-05 15:39:43.114 +07:00 [DBG] Connection id "0HNCBM0TNJ86H" disconnecting.
2025-05-05 15:39:43.118 +07:00 [DBG] Connection id "0HNCBM0TNJ86H" stopped.
2025-05-05 15:39:49.648 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5041/api/Documents - application/json 305
2025-05-05 15:39:49.652 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Documents'
2025-05-05 15:39:49.654 +07:00 [DBG] Endpoint 'ExchangeDocument.PresentationLayer.Controllers.DocumentsController.AddDocument (ExchangeDocument)' with route pattern 'api/Documents' is valid for the request path '/api/Documents'
2025-05-05 15:39:49.658 +07:00 [DBG] Request matched endpoint 'ExchangeDocument.PresentationLayer.Controllers.DocumentsController.AddDocument (ExchangeDocument)'
2025-05-05 15:39:49.659 +07:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-05-05 15:39:49.662 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-05 15:39:49.663 +07:00 [INF] Executing endpoint 'ExchangeDocument.PresentationLayer.Controllers.DocumentsController.AddDocument (ExchangeDocument)'
2025-05-05 15:39:49.665 +07:00 [INF] Route matched with {action = "AddDocument", controller = "Documents"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddDocument(ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto) on controller ExchangeDocument.PresentationLayer.Controllers.DocumentsController (ExchangeDocument).
2025-05-05 15:39:49.669 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-05 15:39:49.670 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-05 15:39:49.672 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-05-05 15:39:49.674 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-05 15:39:49.675 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-05 15:39:49.676 +07:00 [DBG] Executing controller factory for controller ExchangeDocument.PresentationLayer.Controllers.DocumentsController (ExchangeDocument)
2025-05-05 15:39:49.682 +07:00 [DBG] Executed controller factory for controller ExchangeDocument.PresentationLayer.Controllers.DocumentsController (ExchangeDocument)
2025-05-05 15:39:49.683 +07:00 [DBG] Attempting to bind parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto' ...
2025-05-05 15:39:49.684 +07:00 [DBG] Attempting to bind parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto' using the name '' in request data ...
2025-05-05 15:39:49.685 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-05 15:39:49.686 +07:00 [DBG] Connection id "0HNCBM0TNJ86G", Request id "0HNCBM0TNJ86G:00000004": started reading request body.
2025-05-05 15:39:49.687 +07:00 [DBG] Connection id "0HNCBM0TNJ86G", Request id "0HNCBM0TNJ86G:00000004": done reading request body.
2025-05-05 15:39:49.688 +07:00 [DBG] JSON input formatter succeeded, deserializing to type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto'
2025-05-05 15:39:49.689 +07:00 [DBG] Done attempting to bind parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto'.
2025-05-05 15:39:49.690 +07:00 [DBG] Done attempting to bind parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto'.
2025-05-05 15:39:49.691 +07:00 [DBG] Attempting to validate the bound parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto' ...
2025-05-05 15:39:49.692 +07:00 [DBG] Done attempting to validate the bound parameter 'documentDto' of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentCreateDto'.
2025-05-05 15:39:50.031 +07:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'Order'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 15:39:50.033 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'OrderDetail'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 15:39:50.034 +07:00 [WRN] Entity 'Document' has a global query filter defined and is the required end of a relationship with the entity 'Review'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 15:39:50.035 +07:00 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'Userprofile'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-05-05 15:39:50.154 +07:00 [DBG] Entity Framework Core 9.0.4 initialized 'ExchangeDocumentContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-05 15:39:50.203 +07:00 [DBG] Compiling query expression: 
'DbSet<Category>()
    .FirstOrDefault(e => EF.Property<int>(e, "CategoryId") == __p_0)'
2025-05-05 15:39:50.362 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Category>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Category>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.CategoryId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.CategoryName (string) Required Index MaxLength(255), 1] }
            SELECT TOP(1) c.categoryId, c.categoryName
            FROM categories AS c
            WHERE c.categoryId == @__p_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.CategoryId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.CategoryName (string) Required Index MaxLength(255), 1] }
            SELECT TOP(1) c.categoryId, c.categoryName
            FROM categories AS c
            WHERE c.categoryId == @__p_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Category entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Category instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Category);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Category.CategoryId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Category").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Category)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Category")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Category")]: 
                            {
                                return 
                                {
                                    Category instance;
                                    instance = new Category();
                                    instance.<CategoryId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CategoryName>k__BackingField = dataReader.GetString(1);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.Category")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Category)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-05 15:39:50.394 +07:00 [DBG] Creating DbConnection.
2025-05-05 15:39:50.405 +07:00 [DBG] Created DbConnection. (10ms).
2025-05-05 15:39:50.408 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:39:50.494 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:39:50.497 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 15:39:50.502 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-05-05 15:39:50.506 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (9ms).
2025-05-05 15:39:50.512 +07:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[categoryId], [c].[categoryName]
FROM [categories] AS [c]
WHERE [c].[categoryId] = @__p_0
2025-05-05 15:39:50.539 +07:00 [INF] Executed DbCommand (29ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[categoryId], [c].[categoryName]
FROM [categories] AS [c]
WHERE [c].[categoryId] = @__p_0
2025-05-05 15:39:50.559 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:39:50.571 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:39:50.576 +07:00 [DBG] A data reader for 'exchangedocument' on server 'MINHKHAI' is being disposed after spending 31ms reading results.
2025-05-05 15:39:50.579 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:39:50.583 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'MINHKHAI' (3ms).
2025-05-05 15:39:50.601 +07:00 [DBG] 'ExchangeDocumentContext' generated a temporary value for the property 'Document.DocumentId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:39:50.636 +07:00 [DBG] The navigation 'Document.Category' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:39:50.644 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'Document' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:39:50.647 +07:00 [DBG] SaveChanges starting for 'ExchangeDocumentContext'.
2025-05-05 15:39:50.649 +07:00 [DBG] DetectChanges starting for 'ExchangeDocumentContext'.
2025-05-05 15:39:50.664 +07:00 [DBG] DetectChanges completed for 'ExchangeDocumentContext'.
2025-05-05 15:39:50.704 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:39:50.706 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:39:50.708 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 15:39:50.709 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-05 15:39:50.710 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-05 15:39:50.711 +07:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32), @p2='?' (Size = 255), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 100), @p7='?' (Size = 500), @p8='?' (DbType = Boolean), @p9='?' (Size = 20), @p10='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p11='?' (DbType = Int32), @p12='?' (Size = 255), @p13='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [document] ([author], [categoryId], [condition], [DeletedAt], [description], [statusId], [edition], [imageUrl], [IsDeleted], [ISBN], [price], [publicationYear], [title], [userId])
OUTPUT INSERTED.[documentId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-05-05 15:39:50.719 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32), @p2='?' (Size = 255), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 100), @p7='?' (Size = 500), @p8='?' (DbType = Boolean), @p9='?' (Size = 20), @p10='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p11='?' (DbType = Int32), @p12='?' (Size = 255), @p13='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [document] ([author], [categoryId], [condition], [DeletedAt], [description], [statusId], [edition], [imageUrl], [IsDeleted], [ISBN], [price], [publicationYear], [title], [userId])
OUTPUT INSERTED.[documentId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-05-05 15:39:50.728 +07:00 [DBG] The foreign key property 'Document.DocumentId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-05 15:39:50.733 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:39:50.733 +07:00 [DBG] A data reader for 'exchangedocument' on server 'MINHKHAI' is being disposed after spending 12ms reading results.
2025-05-05 15:39:50.735 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:39:50.736 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'MINHKHAI' (0ms).
2025-05-05 15:39:50.744 +07:00 [DBG] An entity of type 'Document' tracked by 'ExchangeDocumentContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:39:50.746 +07:00 [DBG] SaveChanges completed for 'ExchangeDocumentContext' with 1 entities written to the database.
2025-05-05 15:39:50.748 +07:00 [DBG] Compiling query expression: 
'DbSet<DocumentStatus>()
    .FirstOrDefault(e => EF.Property<int>(e, "DocumentStatusId") == __p_0)'
2025-05-05 15:39:50.754 +07:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<DocumentStatus>(
    asyncEnumerable: SingleQueryingEnumerable.Create<DocumentStatus>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: DocumentStatus.DocumentStatusId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: DocumentStatus.Code (string) Required MaxLength(50), 1], [Property: DocumentStatus.Name (string) Required MaxLength(50), 2] }
            SELECT TOP(1) d.documentStatusId, d.statusCode, d.statusName
            FROM documentStatus AS d
            WHERE d.documentStatusId == @__p_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: DocumentStatus.DocumentStatusId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: DocumentStatus.Code (string) Required MaxLength(50), 1], [Property: DocumentStatus.Name (string) Required MaxLength(50), 2] }
            SELECT TOP(1) d.documentStatusId, d.statusCode, d.statusName
            FROM documentStatus AS d
            WHERE d.documentStatusId == @__p_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            DocumentStatus entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                DocumentStatus instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(DocumentStatus);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: DocumentStatus.DocumentStatusId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.DocumentStatus").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (DocumentStatus)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: DocumentStatus | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.DocumentStatus")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: DocumentStatus | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.DocumentStatus")]: 
                            {
                                return 
                                {
                                    DocumentStatus instance;
                                    instance = new DocumentStatus();
                                    instance.<DocumentStatusId>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Code>k__BackingField = dataReader.GetString(1);
                                    instance.<Name>k__BackingField = dataReader.GetString(2);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: DocumentStatus | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ExchangeDocument.DataAccessLayer.Entities.DocumentStatus")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(DocumentStatus)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: ExchangeDocument.DataAccessLayer.Data.ExchangeDocumentContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-05 15:39:50.758 +07:00 [DBG] Opening connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:39:50.758 +07:00 [DBG] Opened connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:39:50.759 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-05 15:39:50.760 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-05-05 15:39:50.762 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-05 15:39:50.763 +07:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[documentStatusId], [d].[statusCode], [d].[statusName]
FROM [documentStatus] AS [d]
WHERE [d].[documentStatusId] = @__p_0
2025-05-05 15:39:50.768 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[documentStatusId], [d].[statusCode], [d].[statusName]
FROM [documentStatus] AS [d]
WHERE [d].[documentStatusId] = @__p_0
2025-05-05 15:39:50.772 +07:00 [DBG] The navigation 'Document.DocumentStatus' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:39:50.774 +07:00 [DBG] Context 'ExchangeDocumentContext' started tracking 'DocumentStatus' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-05 15:39:50.777 +07:00 [DBG] Closing data reader to 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:39:50.778 +07:00 [DBG] A data reader for 'exchangedocument' on server 'MINHKHAI' is being disposed after spending 9ms reading results.
2025-05-05 15:39:50.779 +07:00 [DBG] Closing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:39:50.780 +07:00 [DBG] Closed connection to database 'exchangedocument' on server 'MINHKHAI' (0ms).
2025-05-05 15:39:50.783 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-05 15:39:50.785 +07:00 [DBG] No information found on request to perform content negotiation.
2025-05-05 15:39:50.786 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-05 15:39:50.786 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-05 15:39:50.787 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-05 15:39:50.788 +07:00 [INF] Executing CreatedAtActionResult, writing value of type 'ExchangeDocument.BusinessLayer.DTOs.DocumentDto'.
2025-05-05 15:39:50.798 +07:00 [DBG] Found the endpoints ["ExchangeDocument.PresentationLayer.Controllers.DocumentsController.GetDocumentById (ExchangeDocument)"] for address (id=[2],action=[GetDocumentById],controller=[Documents])
2025-05-05 15:39:50.800 +07:00 [DBG] Successfully processed template api/Documents/{id} for ExchangeDocument.PresentationLayer.Controllers.DocumentsController.GetDocumentById (ExchangeDocument) resulting in /api/Documents/2 and 
2025-05-05 15:39:50.802 +07:00 [DBG] Link generation succeeded for endpoints ["ExchangeDocument.PresentationLayer.Controllers.DocumentsController.GetDocumentById (ExchangeDocument)"] with result /api/Documents/2
2025-05-05 15:39:50.810 +07:00 [INF] Executed action ExchangeDocument.PresentationLayer.Controllers.DocumentsController.AddDocument (ExchangeDocument) in 1133.931ms
2025-05-05 15:39:50.812 +07:00 [INF] Executed endpoint 'ExchangeDocument.PresentationLayer.Controllers.DocumentsController.AddDocument (ExchangeDocument)'
2025-05-05 15:39:50.813 +07:00 [INF] HTTP POST /api/Documents responded 201 in 1154.3593 ms
2025-05-05 15:39:50.814 +07:00 [DBG] Connection id "0HNCBM0TNJ86G" completed keep alive response.
2025-05-05 15:39:50.816 +07:00 [DBG] 'ExchangeDocumentContext' disposed.
2025-05-05 15:39:50.819 +07:00 [DBG] Disposing connection to database 'exchangedocument' on server 'MINHKHAI'.
2025-05-05 15:39:50.820 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-05 15:39:50.821 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5041/api/Documents - 201 null application/json; charset=utf-8 1173.2705ms
2025-05-05 15:42:01.690 +07:00 [DBG] Connection id "0HNCBM0TNJ86G" disconnecting.
2025-05-05 15:42:01.694 +07:00 [DBG] Connection id "0HNCBM0TNJ86G" stopped.
2025-05-05 15:42:01.695 +07:00 [DBG] Connection id "0HNCBM0TNJ86G" sending FIN because: "The Socket transport's send loop completed gracefully."
